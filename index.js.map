{"version":3,"sources":["webpack:///webpack/universalModuleDefinition","webpack:///webpack/bootstrap 5abb8f15292351fa542b","webpack:///./src/index.ts","webpack:///./src/objectplus/tools.ts","webpack:///./src/record/index.ts","webpack:///./src/record/transaction.ts","webpack:///./src/objectplus/index.ts","webpack:///./src/objectplus/mixins.ts","webpack:///./src/objectplus/events.ts","webpack:///./src/objectplus/eventmaps.ts","webpack:///./src/objectplus/traversable.ts","webpack:///./src/transactions.ts","webpack:///./src/validation.ts","webpack:///./src/record/define.ts","webpack:///./src/record/attribute.ts","webpack:///./src/record/typespec.ts","webpack:///./src/record/nestedTypes.ts","webpack:///./src/record/basicTypes.ts","webpack:///./src/collection/index.ts","webpack:///./src/collection/commons.ts","webpack:///./src/collection/add.ts","webpack:///./src/collection/set.ts","webpack:///./src/collection/remove.ts"],"names":[],"mappings":"AAAA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,CAAC;AACD,O;ACVA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA,uBAAe;AACf;AACA;AACA;;AAEA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;;;AAGA;AACA;;AAEA;AACA;;AAEA;AACA;;AAEA;AACA;;;;;;;;;;;AClCA,KAAY,KAAK,uBAAM,CACvB,CAAC,CAD6C;AAe1C,cAAK;AAdT,sCAAuC,CACvC,CAAC,CADyD;AAC1D,sCAAgC,CAEhC,CAAC,CAFkD;AAc/C,cAAK;AAZT,uCAAuB,CACvB,CAAC,CAAc;mCAAE,EAAE,oCAAG,EAAE,4CAAO,EAAE,sCAAI,EAAE,8CAAQ,EAAE,wDAAa,EAAE,sDAAY,CAAY;AAExF,sCAA2B,EAE3B,CAAC,CAFiD;AAU9C,mBAAU;AARd,8BAAc,CACd,CAAC,EADqC;AACtC,8BAAc,CAEd,CAAC,EAFqC;AAEtC,uCAAiC,CAEjC,CAAC,CAFwD;AAMrD,cAAK;AAKT,gBAAgB,CAAC;KACb,MAAM,CAAC,IAAI,iCAAsB,CAAC,EAAE,KAAK,EAAG,CAAC,EAAE,CAAC,CAAC;AACrD,EAAC;AALG,cAAK,SAKR;AAED,sBAAsB,MAAM;KACxB,MAAM,CAAC;SAAA,iBAQN;SARgB,cAAO;cAAP,WAAO,CAAP,sBAAO,CAAP,IAAO;aAAP,6BAAO;;SACpB,IAAI,MAAM,CAAC;SAEX,IAAI,CAAC,WAAW,CAAE;aACd,MAAM,GAAG,MAAM,CAAC,KAAK,CAAE,KAAI,EAAE,IAAI,CAAE,CAAC;SACxC,CAAC,CAAC,CAAC;SAEH,MAAM,CAAC,MAAM,CAAC;KAClB,CAAC;AACL,EAAC;AAlBG,oBAAW,eAkBd;;;;;;;;ACpCD;KAAA;SACI,UAAK,GAAY,CAAC;KAiBtB,CAAC;KAfG,mBAAK,GAAL;SAAO,cAAe;cAAf,WAAe,CAAf,sBAAe,CAAf,IAAe;aAAf,6BAAe;;SAClB,OAAO,CAAC,KAAK,CAAC,KAAK,CAAE,OAAO,EAAE,IAAI,CAAE,CAAC;KACzC,CAAC;KAED,kBAAI,GAAJ;SAAM,cAAe;cAAf,WAAe,CAAf,sBAAe,CAAf,IAAe;aAAf,6BAAe;;SACjB,EAAE,EAAE,IAAI,CAAC,KAAK,GAAG,CAAE,CAAC;aAAC,OAAO,CAAC,IAAI,CAAC,KAAK,CAAE,OAAO,EAAE,IAAI,CAAE,CAAC;KAC7D,CAAC;KAED,kBAAI,GAAJ;SACI,EAAE,EAAE,IAAI,CAAC,KAAK,GAAG,CAAE,CAAC;aAAC,OAAO,CAAC,IAAI,CAAC,KAAK,CAAE,OAAO,EAAE,SAAS,CAAE,CAAC;KAClE,CAAC;KAED,mBAAK,GAAL;SACI,EAAE,EAAE,IAAI,CAAC,KAAK,GAAG,CAAE,CAAC;aAAC,OAAO,CAAC,GAAG,CAAC,KAAK,CAAE,OAAO,EAAE,SAAS,CAAE,CAAC;KACjE,CAAC;KACL,UAAC;AAAD,EAAC;AAEU,YAAG,GAAG,IAAI,GAAG,EAAE,CAAC;AAG3B,sBAA6B,KAAW;KACpC,EAAE,EAAE,KAAK,KAAK,IAAK,CAAC,EAAC;SACjB,MAAM,CAAC,IAAI,CAAC;KAChB,CAAC;KAED,MAAM,EAAE,OAAO,KAAM,CAAC,EAAC;SACvB,KAAK,QAAQ,CAAE;SACf,KAAK,QAAQ,CAAE;SACf,KAAK,SAAS;aACV,MAAM,CAAC,IAAI,CAAC;SAEhB,KAAK,QAAQ;aACT,IAAI,KAAK,GAAG,MAAM,CAAC,cAAc,CAAE,KAAK,CAAE,CAAC;aAE3C,EAAE,EAAE,KAAK,KAAK,MAAM,CAAC,SAAS,IAAI,KAAK,KAAK,KAAK,CAAC,SAAU,CAAC,EAAC;iBAC1D,MAAM,CAAC,KAAK,CAAE,KAAK,EAAE,WAAW,CAAE,CAAC;aACvC,CAAC;KACL,CAAC;KAED,MAAM,CAAC,KAAK,CAAC;AACjB,EAAC;AApBe,oBAAW,cAoB1B;AAMD,uBAA8B,KAAgB;KAC1C,MAAM,CAAC,MAAM,CAAC,cAAc,CAAE,KAAK,CAAC,SAAS,CAAE,CAAC,WAAW;AAC/D,EAAC;AAFe,qBAAY,eAE3B;AAED,kBAAyB,GAAQ;KAC7B,EAAE,EAAE,GAAI,CAAC,EAAC;SACN,GAAG,EAAE,IAAI,GAAG,IAAI,GAAI,CAAC,EAAC;aAClB,EAAE,EAAE,GAAG,CAAC,cAAc,CAAE,GAAG,CAAG,CAAC,EAAC;iBAC5B,MAAM,CAAC,KAAK,CAAC;aACjB,CAAC;SACL,CAAC;KACL,CAAC;KAED,MAAM,CAAC,IAAI,CAAC;AAChB,EAAC;AAVe,gBAAO,UAUtB;AAID,oBAAoB,GAAW,EAAE,GAAc;KAC3C,IAAI,MAAM,CAAC;KAEX,GAAG,EAAE,IAAI,CAAC,GAAG,CAAC,EAAE,CAAC,GAAG,GAAG,CAAC,MAAM,EAAE,CAAC,EAAE,EAAE,CAAC;SAClC,EAAE,EAAE,MAAM,GAAG,GAAG,CAAE,GAAG,CAAE,CAAC,CAAE,EAAE,CAAC,CAAG,CAAC,EAAC;aAC9B,MAAM,CAAC,MAAM,CAAC;SAClB,CAAC;KACL,CAAC;AACL,EAAC;AAED,qBAAqB,GAAQ,EAAE,GAAc;KACzC,IAAI,MAAM,CAAC;KAEX,GAAG,EAAE,IAAI,GAAG,IAAI,GAAI,CAAC,EAAC;SAClB,EAAE,EAAE,GAAG,CAAC,cAAc,CAAE,GAAG,CAAG,CAAC,EAAC;aAC5B,EAAE,EAAE,MAAM,GAAG,GAAG,CAAE,GAAG,CAAE,GAAG,CAAE,EAAE,GAAG,CAAG,CAAC,EAAC;iBAClC,MAAM,CAAC,MAAM,CAAC;aAClB,CAAC;SACL,CAAC;KACL,CAAC;AACL,EAAC;AAED,eAAsB,GAAG,EAAE,GAAc;KACrC,EAAE,EAAE,MAAM,CAAC,cAAc,CAAE,GAAG,CAAE,KAAK,UAAW,CAAC,EAAC;SAC9C,MAAM,CAAC,SAAS,CAAE,GAAG,EAAE,GAAG,CAAE,CAAC;KACjC,CAAC;KACD,IAAI,EAAC;SACD,MAAM,CAAC,UAAU,CAAE,GAAG,EAAE,GAAG,CAAE,CAAC;KAClC,CAAC;AACL,EAAC;AAPe,aAAI,OAOnB;AAED,gBAAuB,GAAS,EAAE,SAAoB;KAClD,MAAM,CAAC,CAAC,IAAI,CAAE,GAAG,EAAE,WAAC,IAAI,QAAC,SAAS,CAAE,CAAC,CAAE,EAAf,CAAe,CAAE,CAAC;AAC9C,EAAC;AAFe,cAAK,QAEpB;AAED,gCAAuC,GAAQ,EAAE,IAAa;KAC1D,IAAI,IAAyB,CAAC;KAE9B,GAAG,EAAE,IAAI,KAAK,GAAG,GAAG,EAAE,CAAC,IAAI,IAAI,KAAK,EAAE,KAAK,GAAG,MAAM,CAAC,cAAc,CAAE,KAAK,CAAE,EAAG,CAAC;SAC5E,IAAI,GAAG,MAAM,CAAC,wBAAwB,CAAE,GAAG,EAAE,IAAI,CAAE,CAAC;KACxD,CAAC;KAED,MAAM,CAAC,IAAI,CAAC;AAChB,EAAC;AARe,8BAAqB,wBAQpC;AAGD,eAAsB,MAAM;KACxB,IAAM,IAAI,GAAG,EAAE,EAAE,OAAO,GAAG,EAAE,CAAC;KAE9B,GAAG,EAAE,IAAI,CAAC,GAAG,CAAC,EAAE,CAAC,GAAG,SAAS,CAAC,MAAM,EAAE,CAAC,EAAG,EAAE,CAAC;SACzC,OAAO,CAAE,SAAS,CAAE,CAAC,CAAE,CAAE,GAAG,IAAI,CAAC;KACrC,CAAC;KAED,GAAG,EAAE,IAAI,IAAI,IAAI,MAAO,CAAC,CAAC,CAAC;SACvB,EAAE,EAAE,CAAC,OAAO,CAAE,IAAI,CAAE,IAAI,MAAM,CAAC,cAAc,CAAE,IAAI,CAAG,CAAC,CAAC,CAAC;aACrD,IAAI,CAAE,IAAI,CAAE,GAAG,MAAM,CAAE,IAAI,CAAE,CAAC;SAClC,CAAC;KACL,CAAC;KAED,MAAM,CAAC,IAAI,CAAC;AAChB,EAAC;AAde,aAAI,OAcnB;AAED,oBAAmC,IAA+B,EAAE,MAAiC,EAAE,GAA6C;KAChJ,GAAG,EAAE,IAAI,IAAI,IAAI,MAAO,CAAC,CAAC,CAAC;SACvB,EAAE,EAAE,MAAM,CAAC,cAAc,CAAE,IAAI,CAAG,CAAC,CAAC,CAAC;aACjC,IAAI,KAAK,GAAG,GAAG,CAAE,MAAM,CAAE,IAAI,CAAE,EAAE,IAAI,CAAE,CAAC;aACxC,KAAK,KAAK,KAAK,CAAC,IAAI,CAAE,IAAI,CAAE,IAAI,CAAE,GAAQ,KAAK,CAAE,CAAC;SACtD,CAAC;KACL,CAAC;KAED,MAAM,CAAC,IAAI,CAAC;AAChB,EAAC;AATe,kBAAS,YASxB;AAED,qBAA4B,IAAS,EAAE,MAAW;KAC9C,GAAG,EAAE,IAAI,IAAI,IAAI,MAAO,CAAC,CAAC,CAAC;SACvB,IAAI,CAAE,IAAI,CAAE,GAAG,MAAM,CAAE,IAAI,CAAE,CAAC;KAClC,CAAC;AACL,EAAC;AAJe,mBAAU,aAIzB;AAED,uBAA8B,IAAS,EAAE,MAAW;KAChD,GAAG,EAAE,IAAI,IAAI,IAAI,MAAO,CAAC,CAAC,CAAC;SACvB,EAAE,EAAE,IAAI,CAAE,IAAI,CAAE,KAAK,KAAK,CAAE,CAAC,EAAC;aAC1B,IAAI,CAAE,IAAI,CAAE,GAAG,MAAM,CAAE,IAAI,CAAE,CAAC;SAClC,CAAC;KACL,CAAC;AACL,EAAC;AANe,qBAAY,eAM3B;AAED,qBAAqB,GAAG;KACpB,MAAM,CAAC,UAAe,IAAQ;SAAE,iBAAU;cAAV,WAAU,CAAV,sBAAU,CAAV,IAAU;aAAV,gCAAU;;SACtC,GAAG,EAAE,IAAI,CAAC,GAAG,CAAC,EAAE,CAAC,GAAG,OAAO,CAAC,MAAM,EAAE,CAAC,EAAE,EAAG,CAAC;aACvC,IAAM,MAAM,GAAG,OAAO,CAAE,CAAC,CAAE,CAAC;aAC5B,MAAM,IAAI,GAAG,CAAE,IAAI,EAAE,MAAM,CAAE,CAAC;SAClC,CAAC;SAED,MAAM,CAAC,IAAI,CAAC;KAChB,CAAC;AACL,EAAC;AAEY,eAAM,GAAG,UAAU,CAAE,UAAE,IAAI,EAAE,MAAM;KAC5C,GAAG,EAAE,IAAI,IAAI,IAAI,MAAO,CAAC,CAAC,CAAC;SACvB,EAAE,EAAE,MAAM,CAAC,cAAc,CAAE,IAAI,CAAG,CAAC,CAAC,CAAC;aACjC,IAAI,CAAE,IAAI,CAAE,GAAG,MAAM,CAAE,IAAI,CAAE,CAAC;SAClC,CAAC;KACL,CAAC;AACL,EAAC,CAAE,CAAC;AAES,iBAAQ,GAAG,UAAU,CAAE,UAAE,IAAI,EAAE,MAAM;KAC9C,GAAG,EAAE,IAAI,IAAI,IAAI,MAAO,CAAC,CAAC,CAAC;SACvB,EAAE,EAAE,MAAM,CAAC,cAAc,CAAE,IAAI,CAAE,IAAI,IAAI,CAAE,IAAI,CAAE,KAAK,KAAK,CAAE,CAAC,CAAC,CAAC;aAC3D,IAAI,CAAE,IAAI,CAAE,GAAG,MAAM,CAAE,IAAI,CAAE,CAAC;SACnC,CAAC;KACL,CAAC;AACL,EAAC,CAAE,CAAC;AAEJ,eAAsB,CAAO;KACzB,MAAM,CAAC,CAAC,GAAG,MAAM,CAAC,IAAI,CAAE,CAAC,CAAE,GAAG,EAAE,CAAC;AACrC,EAAC;AAFe,aAAI,OAEnB;AAED,eAAsB,IAAe;KACjC,IAAI,IAAI,EAAE,KAAK,GAAG,IAAI,CAAC;KACvB,MAAM,CAAC;SACH,EAAE,CAAC,CAAE,KAAM,CAAC,CAAC,CAAC;aACV,KAAK,GAAG,KAAK,CAAC;aACd,IAAI,GAAG,IAAI,CAAC,KAAK,CAAC,IAAI,EAAE,SAAS,CAAC,CAAC;aACnC,IAAI,GAAG,IAAI,CAAC;SAChB,CAAC;SACD,MAAM,CAAC,IAAI,CAAC;KAChB,CAAC,CAAC;AACN,EAAC;AAVe,aAAI,OAUnB;AAOD,KAAM,UAAU,GAAG,KAAK,CAAC,SAAS,EAC5B,SAAS,GAAG,IAAI,CAAC,SAAS,EAC1B,WAAW,GAAG,MAAM,CAAC,SAAS,CAAC;AAErC,mBAA0B,CAAO,EAAE,CAAO;KACtC,EAAE,EAAE,CAAC,KAAK,CAAE,CAAC;SAAC,MAAM,CAAC,KAAK,CAAC;KAE3B,EAAE,EAAE,CAAC,IAAI,CAAC,IAAI,OAAO,CAAC,IAAI,QAAQ,IAAI,OAAO,CAAC,IAAI,QAAS,CAAC,CAAC,CAAC;SAC1D,IAAM,MAAM,GAAG,MAAM,CAAC,cAAc,CAAE,CAAC,CAAE,CAAC;SAE1C,EAAE,EAAE,MAAM,KAAK,MAAM,CAAC,cAAc,CAAE,CAAC,CAAG,CAAC;aAAC,MAAM,CAAC,IAAI,CAAC;SAExD,MAAM,EAAE,MAAO,CAAC,EAAC;aACb,KAAK,SAAS,EAAK,MAAM,CAAC,CAAC,CAAC,KAAK,CAAC,CAAC,CAAC;aACpC,KAAK,UAAU,EAAI,MAAM,CAAC,cAAc,CAAE,CAAC,EAAE,CAAC,CAAE,CAAC;aACjD,KAAK,WAAW,CAAE;aAClB,KAAK,IAAI;iBACL,MAAM,CAAC,eAAe,CAAE,CAAC,EAAE,CAAC,CAAE,CAAC;SACvC,CAAC;KACL,CAAC;KAED,MAAM,CAAC,IAAI,CAAC;AAChB,EAAC;AAlBe,iBAAQ,WAkBvB;AAED,0BAA0B,CAAC,EAAE,CAAC;KAC1B,IAAM,KAAK,GAAG,MAAM,CAAC,IAAI,CAAE,CAAC,CAAE,CAAC;KAE/B,EAAE,EAAE,KAAK,CAAC,MAAM,KAAK,MAAM,CAAC,IAAI,CAAE,CAAC,CAAE,CAAC,MAAO,CAAC;SAAC,MAAM,CAAC,IAAI,CAAC;KAE3D,GAAG,EAAE,IAAI,CAAC,GAAG,CAAC,EAAE,CAAC,GAAG,KAAK,CAAC,MAAM,EAAE,CAAC,EAAE,EAAG,CAAC;SACrC,IAAM,GAAG,GAAG,KAAK,CAAE,CAAC,CAAE,CAAC;SAEvB,EAAE,EAAE,CAAC,CAAC,CAAC,cAAc,CAAE,GAAG,CAAE,IAAI,QAAQ,CAAE,CAAC,CAAE,GAAG,CAAE,EAAE,CAAC,CAAE,GAAG,CAAE,CAAG,CAAC,CAAC,CAAC;aAC9D,MAAM,CAAC,IAAI,CAAC;SAChB,CAAC;KACL,CAAC;KAED,MAAM,CAAC,KAAK,CAAC;AACjB,EAAC;AAED,yBAAyB,CAAC,EAAE,CAAC;KACzB,EAAE,EAAE,CAAC,CAAC,MAAM,KAAK,CAAC,CAAC,MAAO,CAAC;SAAC,MAAM,CAAC,IAAI,CAAC;KAExC,GAAG,EAAE,IAAI,CAAC,GAAG,CAAC,EAAE,CAAC,GAAG,CAAC,CAAC,MAAM,EAAE,CAAC,EAAE,EAAG,CAAC;SACjC,EAAE,EAAE,QAAQ,CAAE,CAAC,CAAE,CAAC,CAAE,EAAE,CAAC,CAAE,CAAC,CAAE,CAAG,CAAC;aAAC,MAAM,CAAC,IAAI,CAAC;KACjD,CAAC;KAED,MAAM,CAAC,KAAK,CAAC;AACjB,EAAC;AAGD,KAAI,WAAW,GAAM,CAAE,CAAC,EAAE,CAAC,EAAE,CAAC,EAAE,CAAC,EAAE,CAAC,EAAE,EAAE,EAAE,EAAE,CAAE,EAC1C,aAAa,GAAI,sBAAsB,EACvC,cAAc,GAAG,oIAAoI,CAAC;AAE1J,oBAA2B,IAAI;KAC3B,IAAI,MAAM,EAAE,SAAS,EAAE,MAAM,EAAE,aAAa,GAAG,CAAC,CAAC;KAEjD,EAAE,EAAE,MAAM,GAAG,aAAa,CAAC,IAAI,CAAE,IAAI,CAAG,CAAC,CAAC,CAAC;SACvC,SAAS,GAAG,MAAM,CAAE,MAAM,CAAE,CAAC,CAAE,CAAE,CAAC;KACtC,CAAC;KACD,IAAI,CAAC,EAAE,EAAE,CAAE,MAAM,GAAG,cAAc,CAAC,IAAI,CAAE,IAAI,CAAE,CAAE,CAAC,CAAC,CAAC;SAEhD,GAAG,EAAE,IAAI,CAAC,GAAG,CAAC,EAAE,CAAC,EAAE,CAAE,CAAC,GAAG,WAAW,CAAE,CAAC,CAAE,CAAE,EAAE,EAAE,CAAC,EAAG,CAAC;aAChD,MAAM,CAAE,CAAC,CAAE,GAAG,CAAC,MAAM,CAAE,CAAC,CAAE,IAAI,CAAC,CAAC;SACpC,CAAC;SAGD,MAAM,CAAE,CAAC,CAAE,GAAG,CAAC,CAAC,MAAM,CAAE,CAAC,CAAE,IAAI,CAAC,CAAC,GAAG,CAAC,CAAC;SACtC,MAAM,CAAE,CAAC,CAAE,GAAG,CAAC,MAAM,CAAE,CAAC,CAAE,IAAI,CAAC,CAAC;SAEhC,EAAE,EAAE,MAAM,CAAE,CAAC,CAAE,KAAK,GAAG,IAAI,MAAM,CAAE,CAAC,CAAE,KAAK,SAAU,CAAC,CAAC,CAAC;aACpD,aAAa,GAAG,MAAM,CAAE,EAAE,CAAE,GAAG,EAAE,GAAG,MAAM,CAAE,EAAE,CAAE,CAAC;aAEjD,EAAE,EAAE,MAAM,CAAE,CAAC,CAAE,KAAK,GAAI,CAAC,CAAC,CAAC;iBACvB,aAAa,GAAG,CAAC,GAAG,aAAa,CAAC;aACtC,CAAC;SACL,CAAC;SAED,SAAS;aACL,IAAI,CAAC,GAAG,CAAE,MAAM,CAAE,CAAC,CAAE,EAAE,MAAM,CAAE,CAAC,CAAE,EAAE,MAAM,CAAE,CAAC,CAAE,EAAE,MAAM,CAAE,CAAC,CAAE,EAAE,MAAM,CAAE,CAAC,CAAE,GAAG,aAAa,EAAE,MAAM,CAAE,CAAC,CAAE,EAC5F,MAAM,CAAE,CAAC,CAAE,CAAE,CAAC;KAChC,CAAC;KACD,IAAI,CAAC,CAAC;SACF,SAAS,GAAG,IAAI,CAAC,KAAK,CAAE,IAAI,CAAE,CAAC;KACnC,CAAC;KAED,MAAM,CAAC,SAAS,CAAC;AACrB,EAAC;AAjCe,kBAAS,YAiCxB;;;;;;;;ACvSD,4CAAiE,CACjE,CAAC,CADkF;AAsD1E,eAAM;AArDf,sCAA+E,CAC/E,CAAC,CADsG;AACvG,uCAAwC,EACxC,CAAC,CADoD;AACrD,yCAAuC,EAEvC,CAAC,CAFqD;AAmDrC,+BAAsB;AAjDvC,4CAAkC,EAClC,CAAC,CADmD;AAiDX,0BAAiB;AAhD1D,qBAAO,EAEP,CAAC,CAFuB;AAExB,wBAAM,CAAC,MAAM,GAAG,UAAU,UAA6B,EAAE,WAAW;KAChE,IAAM,eAAe,GAAmB,uBAAY,CAAE,IAAI,CAAE,EACtD,SAAS,GAAY,eAAe,CAAC,SAAS,CAAC;KAErD,EAAE,EAAE,UAAW,CAAC,CAAC,CAAC;SAEd,IAAM,UAAU,GAAG,mBAAO,CAAE,aAAa,CAAE,UAAU,CAAE,EAAmB,SAAS,CAAC,WAAW,CAAE,CAAC;SAGlG,EAAE,EAAE,UAAU,CAAC,UAAU,KAAK,KAAM,CAAC,EAAC;aAClC,UAAU,CAAC,UAAU,GAAG,EAAE,CAAC;SAC/B,CAAC;SAED,iBAAM,CAAE,UAAU,CAAC,UAAU,EAAE,UAAU,CAAC,UAAU,IAAI,EAAE,CAAE,CAAC;SAG7D,mBAAQ,CAAE,UAAU,EAAE,eAAI,CAAE,UAAU,EAAE,YAAY,EAAE,YAAY,CAAE,CAAE,CAAC;SACvE,kBAAO,CAAC,MAAM,CAAC,IAAI,CAAE,IAAI,EAAE,UAAU,EAAE,WAAW,CAAE,CAAC;SACrD,gBAAgB,CAAC,IAAI,CAAE,IAAI,EAAE,UAAU,IAAI,UAAU,CAAC,UAAU,CAAE,CAAC;KACvE,CAAC;KAED,MAAM,CAAC,IAAI,CAAC;AAChB,EAAC;AAED,wBAAM,CAAC,SAAS,GAAG;KACf,kBAAO,CAAC,SAAS,CAAC,IAAI,CAAE,IAAI,CAAE,CAAC;KAE/B,IAAI,CAAC,UAAU,GAAG,uBAAY,CAAE,IAAI,CAAE,CAAC,UAAU,CAAC,MAAM,EAAE,CAAC;KAC3D,IAAI,CAAC,UAAU,CAAC,SAAS,CAAC,KAAK,GAAG,IAAI,CAAC;KAEvC,MAAM,CAAC,IAAI,CAAC;AAChB,EAAC;AAED,wBAAM,CAAC,UAAU,GAAG,kCAAiB,CAAC;AAEtC,wBAAuB,EAAwD;SAAtD,sBAAQ,EAAE,0BAAU,EAAE,4BAAW;KACtD,IAAM,UAAU,GAAG,OAAO,QAAQ,KAAK,UAAU,GAAS,QAAS,EAAE,GAAG,UAAU,IAAI,QAAQ,IAAI,EAAE,CAAC;KAGrG,EAAE,EAAE,WAAW,IAAI,CAAC,CAAE,WAAW,IAAI,UAAU,CAAG,CAAC,EAAC;SAChD,UAAU,CAAE,WAAW,CAAE,GAAG,KAAK,CAAC,CAAC;KACvC,CAAC;KAED,MAAM,CAAC,UAAU,CAAC;AACtB,EAAC;AAID,2BAA2B,UAAe;KACtC,IAAM,cAAc,GAAG,uBAAY,CAAE,IAAI,CAAE,CAAC,UAAU,CAAC;KAEvD,IAAI,qBAAqB,CAAC;KAG1B,EAAE,EAAE,OAAO,UAAU,KAAK,UAAW,CAAC,CAAC,CAAC;SACpC,qBAAqB,GAAG,UAAU,CAAC;KACvC,CAAC;KAED,IAAI,EAAC;SACD,qBAAqB,GAAG,IAAI,CAAC,UAAU,CAAC;SACxC,EAAE,EAAE,UAAW,CAAC;aAAO,qBAAsB,CAAC,MAAM,CAAE,UAAU,CAAE,CAAC;KACvE,CAAC;KAGD,qBAAqB,CAAC,SAAS,CAAC,KAAK,GAAG,IAAI,CAAC;KAC7C,IAAI,CAAC,UAAU,GAAG,qBAAqB,CAAC;AAC5C,EAAC;;;;;;;;;;;;;;;;;;;ACrED,sCAAoF,CAEpF,CAAC,CAF2G;AAE5G,6CAA4H,CAC5H,CAAC,CAD+I;AAGxI,wDAAQ,CAAmB;AAgFnC,KAAI,WAAW,GAAY,CAAC,CAAC;AAU7B;KAA4B,0BAAa;KA2LrC,gBAAa,QAAc,EAAE,SAA+B,EAAE,KAAc;SA3LhF,iBAoXC;SAxLO,kBAAO,WAAW,EAAE,EAAE,KAAK,CAAE,CAAC;SAE9B,IAAM,OAAO,GAAG,SAAS,IAAI,EAAE,EACzB,MAAM,GAAG,CAAE,OAAO,CAAC,KAAK,GAAG,IAAI,CAAC,KAAK,CAAE,QAAQ,CAAE,GAAI,QAAQ,CAAE,IAAI,EAAE,CAAC;SAI5E,IAAM,UAAU,GAAG,OAAO,CAAC,KAAK,GAAG,eAAe,CAAE,IAAI,EAAE,MAAM,CAAE,GAAG,IAAI,CAAC,QAAQ,CAAE,MAAM,CAAE,CAAC;SAE7F,IAAI,CAAC,WAAW,CAAE,UAAU,EAAE,UAAE,KAAW,EAAE,GAAY,EAAE,IAA8B;aACrF,IAAM,IAAI,GAAG,UAAU,CAAE,GAAG,CAAE,GAAG,IAAI,CAAC,SAAS,CAAE,KAAK,EAAE,OAAO,EAAE,KAAK,CAAC,EAAE,KAAI,CAAE,CAAC;aAC1E,IAAI,CAAC,YAAY,CAAE,IAAI,EAAE,KAAK,CAAC,EAAE,KAAI,CAAE,CAAC;SAClD,CAAC,CAAC,CAAC;SAEH,IAAI,CAAC,UAAU,GAAG,IAAI,CAAC,mBAAmB,GAAG,UAAU,CAAC;SAExD,IAAI,CAAC,UAAU,CAAE,QAAQ,EAAE,SAAS,CAAE,CAAC;SAEvC,EAAE,EAAE,IAAI,CAAC,YAAa,CAAC;aAAC,IAAI,CAAC,YAAY,CAAC,SAAS,CAAE,IAAI,EAAE,IAAI,CAAE,CAAC;KACtE,CAAC;KA7MM,aAAM,GAAb,UAAe,UAA6B,EAAE,WAAY;SACtD,MAAM,CAAM,+BAAa,CAAC,MAAM,CAAE,UAAU,EAAE,WAAW,CAAE,CAAC;KAChE,CAAC;KAKM,eAAQ,GAAf,UAAiB,KAA8B;SAC3C,MAAM,CAAC,IAAI,CAAC,MAAM,CAAC,EAAE,UAAU,EAAG,KAAK,EAAE,CAAC,CAAC;KAC/C,CAAC;KAQD,mCAAkB,GAAlB,cAAsB,MAAM,CAAC,IAAI,IAAI,CAAC,UAAU,CAAE,IAAI,CAAC,mBAAmB,CAAE,CAAC,CAAC,CAAC;KAQ/E,sBAAI,2BAAO;cAAX;aACI,IAAI,OAAO,GAAG,IAAI,CAAC,kBAAkB,CAAC;aAEtC,EAAE,EAAE,CAAC,OAAQ,CAAC,EAAC;iBACX,IAAM,IAAI,GAAG,IAAI,CAAC,mBAAmB,CAAC;iBACtC,OAAO,GAAG,EAAE,CAAC;iBAEb,aAAwC,EAAhC,4BAAW,EAAE,0BAAU,CAAU;iBAEzC,GAAG,EAAa,UAAU,EAAV,SAAI,CAAC,KAAK,EAAV,cAAU,EAAV,IAAW,CAAC;qBAAvB,IAAI,GAAG;qBACR,IAAM,KAAK,GAAG,UAAU,CAAE,GAAG,CAAE,CAAC;qBAEhC,EAAE,EAAE,WAAW,CAAE,GAAG,CAAE,CAAC,SAAS,CAAE,KAAK,EAAE,IAAI,CAAE,GAAG,CAAE,CAAG,CAAC,EAAC;yBACrD,OAAO,CAAE,GAAG,CAAE,GAAG,KAAK,CAAC;qBAC3B,CAAC;kBACJ;iBAED,IAAI,CAAC,kBAAkB,GAAG,OAAO,CAAC;aACtC,CAAC;aAED,MAAM,CAAC,OAAO,CAAC;SACnB,CAAC;;;QAAA;KAED,kCAAiB,GAAjB,UAAmB,IAAU;SACzB,EAAE,EAAE,CAAC,IAAK,CAAC;aAAC,MAAM,CAAC,IAAI,CAAC,UAAU,EAAE,GAAG,iBAAM,CAAE,EAAE,EAAE,IAAI,CAAC,OAAO,CAAE,GAAG,KAAK,CAAC;SAE1E,IAAI,GAAG,EAAE,OAAO,GAAkB,KAAK,EACnC,GAAG,GAAY,IAAI,CAAC,YAAY,GAAG,IAAI,CAAC,mBAAmB,GAAG,IAAI,CAAC,UAAU,EAC7E,SAAS,GAAM,IAAI,CAAC,WAAW,CAAC;SAEpC,GAAG,EAAE,IAAI,IAAI,IAAI,IAAK,CAAC,EAAC;aACpB,EAAE,EAAE,CAAC,SAAS,CAAE,IAAI,CAAE,CAAC,SAAS,CAAE,GAAG,CAAE,IAAI,CAAE,EAAE,CAAE,GAAG,GAAG,IAAI,CAAE,IAAI,CAAE,CAAE,CAAG,CAAC;iBAAC,QAAQ,CAAC;aACnF,CAAC,OAAO,IAAI,CAAC,OAAO,GAAG,EAAE,CAAC,CAAC,CAAE,IAAI,CAAE,GAAG,GAAG,CAAC;SAC9C,CAAC;SAED,MAAM,CAAC,OAAO,CAAC;KACnB,CAAC;KAED,2BAAU,GAAV,UAAY,GAAa;SACb,kDAAmB,CAAU;SACrC,EAAE,EAAE,CAAC,mBAAoB,CAAC;aAAC,MAAM,CAAC,KAAK,CAAC;SAExC,MAAM,CAAC,GAAG;aACF,IAAI,CAAC,WAAW,CAAE,GAAG,CAAE,CAAC,SAAS,CAAE,IAAI,CAAC,UAAU,CAAE,GAAG,CAAE,EAAE,mBAAmB,CAAE,GAAG,CAAE,CAAE;aACvF,CAAC,kBAAO,CAAE,IAAI,CAAC,OAAO,CAAE,CAAC;KACrC,CAAC;KAED,yBAAQ,GAAR,UAAU,GAAY;SAClB,EAAE,EAAE,GAAI,CAAC,EAAC;aACE,kDAAmB,CAAU;aACrC,EAAE,EAAE,mBAAoB,CAAC;iBAAC,MAAM,CAAC,mBAAmB,CAAE,GAAG,CAAE,CAAC;SAChE,CAAC;SAED,MAAM,CAAC,IAAI,CAAC;KAChB,CAAC;KAED,sBAAK,GAAL;SACI,MAAM,CAAC,IAAI,CAAC,EAAE,KAAK,KAAK,CAAC,CAAC;KAC9B,CAAC;KAED,oBAAG,GAAH,UAAK,GAAY;SACb,MAAM,CAAC,IAAI,CAAE,GAAG,CAAE,IAAI,KAAK,CAAC,CAAC;KACjC,CAAC;KAED,sBAAK,GAAL,UAAO,GAAG,EAAE,OAAQ;SAChB,IAAI,CAAC,GAAG,CAAE,GAAG,EAAE,KAAK,CAAC,EAAE,OAAO,CAAE,CAAC;SACjC,MAAM,CAAC,IAAI,CAAC;KAChB,CAAC;KAED,sBAAK,GAAL,UAAO,OAAO;SAAd,iBAIC;SAHG,IAAI,CAAC,WAAW,CAAE;aACd,KAAI,CAAC,WAAW,CAAE,KAAI,CAAC,UAAU,EAAE,UAAE,KAAK,EAAE,GAAG,IAAM,YAAI,CAAE,GAAG,CAAE,GAAG,KAAK,CAAC,EAApB,CAAoB,CAAE,CAAC;SAChF,CAAC,EAAE,OAAO,CAAE,CAAC;KACjB,CAAC;KAGD,yBAAQ,GAAR;SACI,IAAM,KAAK,GAAS,IAAI,CAAC,MAAM,CAAC;SAIhC,MAAM,CAAC,IAAI,CAAC,SAAS,GAAG,KAAK,GAAG,KAAK,IAAI,KAAK,CAAC,MAAM,CAAC;KAC1D,CAAC;KAUD,sBAAI,sBAAE;cAAN,cAA6B,MAAM,CAAC,IAAI,CAAC,UAAU,CAAE,IAAI,CAAC,WAAW,CAAE,CAAC,CAAC,CAAC;cAC1E,UAAQ,CAAmB,IAAI,YAAY,CAAE,IAAI,EAAE,IAAI,CAAC,WAAW,EAAE,CAAC,CAAE,CAAC,CAAC,CAAC;;;QADD;KAe1E,2BAAU,GAAV,UAAY,CAAoB,IAAY,IAAI,CAAC,EAAE,GAAG,CAAC,CAAC,EAAE,CAAC,CAAC,CAAC;KAI7D,4BAAW,GAAX,UAAa,KAAU,EAAE,QAAoE;SACjF,kCAAW,CAAU;SAE7B,GAAG,EAAE,IAAI,MAAI,IAAI,KAAM,CAAC,EAAC;aACrB,IAAM,IAAI,GAAG,WAAW,CAAE,MAAI,CAAE,CAAC;aAEjC,EAAE,EAAE,IAAK,CAAC,EAAC;iBACP,QAAQ,CAAE,KAAK,CAAE,MAAI,CAAE,EAAE,MAAI,EAAE,IAAI,CAAE,CAAC;aAC1C,CAAC;aACD,IAAI,EAAC;iBACD,cAAG,CAAC,IAAI,CAAE,qBAAqB,EAAE,IAAI,EAAE,4BAA4B,GAAG,MAAI,GAAG,eAAe,EAAE,KAAK,CAAE,CAAC;aAC1G,CAAC;SACL,CAAC;KAYL,CAAC;KAED,qBAAI,GAAJ,UAAM,QAAkD,EAAE,OAAc;SACpE,IAAM,GAAG,GAAG,SAAS,CAAC,MAAM,KAAK,CAAC,GAAG,UAAE,CAAC,EAAE,CAAC,IAAM,eAAQ,CAAC,IAAI,CAAE,OAAO,EAAE,CAAC,EAAE,CAAC,CAAE,EAA9B,CAA8B,GAAG,QAAQ,EACtF,SAA4B,EAA1B,0BAAU,EAAE,gBAAK,CAAU;SAEjC,GAAG,EAAe,UAAK,EAAL,eAAK,EAAL,mBAAK,EAAL,IAAM,CAAC;aAApB,IAAM,GAAG;aACV,IAAM,KAAK,GAAG,UAAU,CAAE,GAAG,CAAE,CAAC;aAChC,EAAE,EAAE,KAAK,KAAK,KAAK,CAAE,CAAC;iBAAC,GAAG,CAAE,KAAK,EAAE,GAAG,CAAE,CAAC;UAC5C;KACL,CAAC;KAGD,wBAAO,GAAP,cAAW,MAAM,CAAC,EAAE,CAAC,CAAC,CAAC;KAGvB,uBAAM,GAAN,UAAQ,IAAI,IAAI,MAAM,CAAC,IAAI,CAAC,CAAC,CAAC;KAG9B,yBAAQ,GAAR,UAAU,MAAY,IAAI,MAAM,CAAC,EAAE,CAAC,CAAC,CAAC;KA6BtC,2BAAU,GAAV,UAAY,MAAO,EAAE,OAAQ,IAAG,CAAC;KAGjC,sBAAK,GAAL,UAAO,KAAY;SACf,MAAM,CAAC,IAAU,IAAI,CAAC,WAAY,CAAE,IAAI,CAAC,UAAU,EAAE,EAAE,KAAK,EAAG,IAAI,EAAE,EAAE,KAAK,CAAE,CAAC;KACnF,CAAC;KAGD,gCAAe,GAAf,UAAiB,MAAuB;SAAxC,iBAaC;SAZG,IAAI,MAAM,GAAM,CAAC,CAAC;SAElB,IAAI,CAAC,WAAW,CAAE,IAAI,CAAC,UAAU,EAAE,UAAE,KAAK,EAAE,IAAI,EAAE,SAAS;aACvD,IAAM,KAAK,GAAG,SAAS,CAAC,QAAQ,CAAE,KAAI,EAAE,KAAK,EAAE,IAAI,CAAE,CAAC;aAEtD,EAAE,EAAE,KAAM,CAAC,EAAC;iBACR,MAAM,CAAE,IAAI,CAAE,GAAG,KAAK,CAAC;iBACvB,MAAM,EAAE,CAAC;aACb,CAAC;SACL,CAAC,CAAE,CAAC;SAEJ,MAAM,CAAC,MAAM,CAAC;KAClB,CAAC;KAGD,oBAAG,GAAH,UAAK,GAAY;SACb,MAAM,CAAC,IAAI,CAAE,GAAG,CAAE,CAAC;KACvB,CAAC;KAOD,uBAAM,GAAN;SAAA,iBAYC;SAXG,IAAM,IAAI,GAAG,EAAE,CAAC;SAEhB,IAAI,CAAC,WAAW,CAAE,IAAI,CAAC,UAAU,EAAE,UAAE,KAAK,EAAE,GAAY,EAAE,EAAmC;iBAAjC,kBAAM;aAE9D,EAAE,EAAE,MAAM,IAAI,KAAK,KAAK,KAAK,CAAE,CAAC,EAAC;iBAE7B,IAAI,CAAE,GAAG,CAAE,GAAG,MAAM,CAAC,IAAI,CAAE,KAAI,EAAE,KAAK,EAAE,GAAG,CAAE,CAAC;aAClD,CAAC;SACL,CAAC,CAAC,CAAC;SAEH,MAAM,CAAC,IAAI,CAAC;KAChB,CAAC;KAGD,sBAAK,GAAL,UAAO,IAAI;SAEP,MAAM,CAAC,IAAI,CAAC,MAAM,CAAE,IAAI,CAAE,CAAC;KAC/B,CAAC;KASD,oBAAG,GAAH,UAAK,CAAC,EAAE,CAAE,EAAE,CAAE;SACV,EAAE,EAAE,OAAO,CAAC,KAAK,QAAS,CAAC,EAAC;aACxB,EAAE,EAAE,CAAE,CAAC,EAAC;iBACJ,MAAM,CAAQ,gBAAK,CAAC,GAAG,YAAC,UAAE,GAAE,CAAC,CAAE,GAAG,CAAC,KAAE,EAAE,CAAC,CAAE,CAAC;aAC/C,CAAC;aACD,IAAI,EAAC;iBACD,YAAY,CAAE,IAAI,EAAE,CAAC,EAAE,CAAC,CAAE,CAAC;iBAC3B,MAAM,CAAC,IAAI,CAAC;aAChB,CAAC;SACL,CAAC;SACD,IAAI,EAAC;aACD,MAAM,CAAQ,gBAAK,CAAC,GAAG,YAAE,CAAC,EAAE,CAAC,CAAE,CAAC;SACpC,CAAC;;KACL,CAAC;KAGD,4BAAW,GAAX,UAAa,GAA6B,EAAE,OAAiC;SAAjC,uBAAiC,GAAjC,YAAiC;SACzE,IAAM,MAAM,GAAG,KAAK,CAAE,IAAI,CAAE,CAAC;SAC7B,GAAG,CAAC,IAAI,CAAE,IAAI,EAAE,IAAI,CAAE,CAAC;SACvB,MAAM,IAAI,wBAAM,CAAE,IAAI,CAAE,CAAC;KAC7B,CAAC;KAGD,mCAAkB,GAAlB,UAAoB,QAAa,EAAE,OAAiC;SAApE,iBA6CC;SA7CkC,uBAAiC,GAAjC,YAAiC;SAChE,IAAM,MAAM,GAAG,KAAK,CAAE,IAAI,CAAE,EACtB,OAAO,GAAc,EAAE,EACvB,MAAM,GAAwB,EAAE,EAC9B,4BAAU,EACZ,MAAM,GAAG,OAAO,CAAC,KAAK,GAAG,IAAI,CAAC,KAAK,CAAE,QAAQ,CAAE,GAAG,QAAQ,EAC1D,KAAK,GAAG,CAAC,OAAO,CAAC,KAAK,CAAC;SAE7B,EAAE,EAAE,MAAM,CAAC,cAAc,CAAE,MAAM,CAAE,KAAK,MAAM,CAAC,SAAU,CAAC,EAAC;aACvD,IAAI,CAAC,WAAW,CAAE,MAAM,EAAE,UAAE,KAAK,EAAE,GAAY,EAAE,IAA8B;iBAC3E,IAAM,IAAI,GAAG,UAAU,CAAE,GAAG,CAAE,CAAC;iBAG/B,EAAE,EAAE,KAAK,IAAI,IAAI,CAAC,YAAY,CAAE,IAAI,EAAE,KAAK,CAAG,CAAC,CAAC,CAAC;qBAC7C,IAAM,iBAAiB,GAAG,IAAI,CAAC,kBAAkB,CAAE,KAAK,EAAE,OAAO,CAAE,CAAC;qBACpE,EAAE,EAAE,iBAAkB,CAAC,EAAC;yBACpB,MAAM,CAAC,IAAI,CAAE,iBAAiB,CAAE,CAAC;yBACjC,OAAO,CAAC,IAAI,CAAE,GAAG,CAAE,CAAC;qBACxB,CAAC;qBAED,MAAM,CAAC;iBACX,CAAC;iBAGD,IAAM,IAAI,GAAG,IAAI,CAAC,SAAS,CAAE,KAAK,EAAE,OAAO,EAAE,IAAI,EAAE,KAAI,CAAE,CAAC;iBAC1D,UAAU,CAAE,GAAG,CAAE,GAAG,IAAI,CAAC;iBAEzB,EAAE,EAAE,IAAI,CAAC,SAAS,CAAE,IAAI,EAAE,IAAI,CAAG,CAAC,CAAC,CAAC;qBAChC,OAAO,CAAC,IAAI,CAAE,GAAG,CAAE,CAAC;qBAGpB,IAAI,CAAC,YAAY,CAAE,IAAI,EAAE,IAAI,EAAE,KAAI,CAAE,CAAC;iBAC1C,CAAC;aACL,CAAC,CAAE,CAAC;SACR,CAAC;SACD,IAAI,EAAC;aACD,cAAG,CAAC,KAAK,CAAE,cAAc,EAAE,IAAI,EAAE,0BAA0B,EAAE,MAAM,EAAE,uBAAuB,CAAE,CAAC;SACnG,CAAC;SAED,EAAE,EAAE,CAAE,MAAM,CAAC,MAAM,IAAI,OAAO,CAAC,MAAM,CAAE,IAAI,WAAW,CAAE,IAAI,EAAE,OAAO,CAAG,CAAC,EAAC;aACtE,MAAM,CAAC,IAAI,iBAAiB,CAAE,IAAI,EAAE,MAAM,EAAE,MAAM,EAAE,OAAO,CAAE,CAAC;SAClE,CAAC;SAGD,MAAM,IAAI,wBAAM,CAAE,IAAI,CAAE,CAAC;KAC7B,CAAC;KAGD,kCAAiB,GAAjB,UAAmB,KAAqB,EAAE,OAA4B;SAClE,IAAI,CAAC,oBAAoB,CAAE,KAAK,CAAC,SAAS,EAAE,OAAO,CAAE,CAAC;KAC1D,CAAC;KAGD,qCAAoB,GAApB,UAAsB,GAAY,EAAE,OAAiC;SAAjC,uBAAiC,GAAjC,YAAiC;SAEjE,IAAM,MAAM,GAAG,KAAK,CAAE,IAAI,CAAE,CAAC;SAE7B,EAAE,EAAE,WAAW,CAAE,IAAI,EAAE,OAAO,CAAG,CAAC,EAAC;aAC/B,QAAQ,CAAE,IAAI,EAAE,SAAS,GAAG,GAAG,EAAE,IAAI,EAAE,IAAI,CAAC,UAAU,CAAE,GAAG,CAAE,EAAE,OAAO,CAAE,CAAC;SAC7E,CAAC;SAED,MAAM,IAAI,wBAAM,CAAE,IAAI,CAAE,CAAC;KAC7B,CAAC;KAGD,sBAAI,8BAAU;cAAd;aACI,MAAM,CAAC,IAAI,CAAC,SAAS,GAAG,IAAI,GAAG,IAAI,CAAC,MAAM,CAAC;SAC/C,CAAC;;;QAAA;KAGD,wBAAO,GAAP;SAAA,iBAQC;SAPG,IAAI,CAAC,WAAW,CAAE,IAAI,CAAC,UAAU,EAAE,UAAE,KAAK,EAAE,GAAG;aAC3C,EAAE,EAAE,KAAK,IAAI,KAAI,KAAK,KAAK,CAAC,MAAO,CAAC,EAAC;iBACjC,KAAK,CAAC,OAAO,EAAE,CAAC;aACpB,CAAC;SACL,CAAC,CAAC,CAAC;SAEH,gBAAK,CAAC,OAAO,WAAE,CAAC;KACpB,CAAC;KA3XL;SAAC,iBAAM,CAAC;aAEJ,SAAS,EAAG,GAAG;aAGf,WAAW,EAAG,IAAI;aAClB,KAAK,EAAG,CAAE,IAAI,CAAE;UACnB,CAAC;eAAA;KAqXF,aAAC;AAAD,EAAC,CApX2B,+BAAa,GAoXxC;AApXY,eAAM,SAoXlB;AAAA,EAAC;AAMF,gBAAgB,MAAe;KAC3B,EAAE,EAAE,uBAAM,CAAE,MAAM,CAAG,CAAC,EAAC;SACnB,MAAM,CAAC,mBAAmB,GAAG,IAAI,MAAM,CAAC,UAAU,CAAE,MAAM,CAAC,UAAU,CAAE,CAAC;SACxE,MAAM,CAAC,kBAAkB,GAAG,IAAI,CAAC;SACjC,MAAM,CAAC,IAAI,CAAC;KAChB,CAAC;KAED,MAAM,CAAC,KAAK,CAAC;AACjB,EAAC;AAED,sBAAsB,MAAe,EAAE,OAA4B;KAE/D,EAAE,EAAE,MAAM,CAAC,kBAAmB,CAAC,EAAC;SAC5B,MAAM,CAAC,kBAAkB,GAAG,IAAI,CAAC;KACrC,CAAC;KAED,MAAM,CAAC,6BAAY,CAAE,MAAM,EAAE,OAAO,CAAE,CAAC;AAC3C,EAAC;AAGD,0BAA0B,MAAe,EAAE,YAA+B;KACtE,IAAM,UAAU,GAAG,IAAI,MAAM,CAAC,UAAU,CAAE,YAAY,CAAE,CAAC;KAEzD,MAAM,CAAC,WAAW,CAAE,UAAU,EAAE,UAAU,KAAK,EAAE,IAAI,EAAE,IAAgB;SACnE,UAAU,CAAE,IAAI,CAAE,GAAG,IAAI,CAAC,KAAK,CAAE,KAAK,CAAE,CAAC;KAC7C,CAAC,CAAE,CAAC;KAEJ,MAAM,CAAC,UAAU,CAAC;AACtB,EAAC;AAID,uBAA8B,MAAe,EAAE,IAAa,EAAE,KAAW;KACrE,IAAM,MAAM,GAAI,KAAK,CAAE,MAAM,CAAE,EACzB,OAAO,GAAG,EAAE,EACZ,8BAAU,EACV,IAAI,GAAG,MAAM,CAAC,WAAW,CAAE,IAAI,CAAE,EACjC,IAAI,GAAG,UAAU,CAAE,IAAI,CAAE,CAAC;KAGhC,EAAE,EAAE,IAAI,CAAC,YAAY,CAAE,IAAI,EAAE,KAAK,CAAG,CAAC,CAAC,CAAC;SACpC,IAAM,iBAAiB,GAAqB,IAAM,CAAC,kBAAkB,CAAE,KAAK,EAAE,OAAO,CAAE,CAAC;SACxF,EAAE,EAAE,iBAAkB,CAAC,EAAC;aACpB,iBAAiB,CAAC,MAAM,CAAE,IAAI,CAAE,CAAC;aACjC,WAAW,CAAE,MAAM,EAAE,OAAO,CAAE,CAAC;aAC/B,QAAQ,CAAE,MAAM,EAAE,SAAS,GAAG,IAAI,EAAE,MAAM,EAAE,IAAI,EAAE,OAAO,CAAE,CAAC;SAChE,CAAC;KACL,CAAC;KACD,IAAI,CAAC,CAAC;SAEF,IAAM,IAAI,GAAG,IAAI,CAAC,SAAS,CAAE,KAAK,EAAE,OAAO,EAAE,IAAI,EAAE,MAAM,CAAE,CAAC;SAE5D,UAAU,CAAE,IAAI,CAAE,GAAG,IAAI,CAAC;SAE1B,EAAE,EAAE,IAAI,CAAC,SAAS,CAAE,IAAI,EAAE,IAAI,CAAG,CAAC,CAAC,CAAC;aAEhC,IAAI,CAAC,YAAY,CAAE,IAAI,EAAE,IAAI,EAAE,MAAM,CAAE,CAAC;aAExC,WAAW,CAAE,MAAM,EAAE,OAAO,CAAE,CAAC;aAC/B,QAAQ,CAAE,MAAM,EAAE,SAAS,GAAG,IAAI,EAAE,MAAM,EAAE,IAAI,EAAE,OAAO,CAAE,CAAC;SAChE,CAAC;KACL,CAAC;KAED,MAAM,IAAI,wBAAM,CAAE,MAAM,CAAE,CAAC;AAC/B,EAAC;AAhCe,qBAAY,eAgC3B;AAID;KAEI,2BAAoB,MAAe,EACf,MAAgB,EAChB,MAAsB,EACtB,OAAkB;SAHlB,WAAM,GAAN,MAAM,CAAS;SACf,WAAM,GAAN,MAAM,CAAU;SAChB,WAAM,GAAN,MAAM,CAAgB;SACtB,YAAO,GAAP,OAAO,CAAW;KAAG,CAAC;KAG1C,kCAAM,GAAN,UAAQ,QAAmB;SACvB,aAAwC,EAAhC,kBAAM,EAAE,kBAAM,EAAE,oBAAO,CAAU;SAGzC,GAAG,EAAqB,UAAM,EAAN,iBAAM,EAAN,oBAAM,EAAN,IAAO,CAAC;aAA3B,IAAI,WAAW;aAChB,WAAW,CAAC,MAAM,CAAE,IAAI,CAAE,CAAC;UAC9B;SAIO,kCAAU,EAAE,0BAAQ,CAAY;SACxC,GAAG,EAAa,UAAO,EAAP,mBAAO,EAAP,qBAAO,EAAP,IAAQ,CAAC;aAApB,IAAI,GAAG;aACR,QAAQ,CAAE,MAAM,EAAE,SAAS,GAAG,GAAG,EAAE,MAAM,EAAE,UAAU,CAAE,GAAG,CAAE,EAAE,QAAQ,CAAE,CAAC;UAC5E;SAED,IAAI,CAAC,MAAM,IAAI,wBAAM,CAAE,MAAM,EAAE,QAAQ,CAAE,CAAC;KAC9C,CAAC;KACL,wBAAC;AAAD,EAAC;;;;;;;;;;;AC3jBD,8BAAc,CACd,CAAC,EADyB;AAC1B,8BAAc,CACd,CAAC,EAD0B;AAC3B,8BAAc,CAAa,CAAC,EAAD;;;;;;;;;;;;;ACG3B,sCAA4F,CAK5F,CAAC,CALuG;AAuDxG;KAAA;KAwIA,CAAC;KArIU,cAAM,GAAb,UAAe,CAAO,EAAE,CAAQ,EAAE,CAAQ;SACtC,MAAM,CAAC,IAAU,IAAK,CAAE,CAAC,EAAE,CAAC,EAAE,CAAC,CAAE,CAAC;KACtC,CAAC;KAYM,cAAM,GAAb;SAAe,gBAAiC;cAAjC,WAAiC,CAAjC,sBAAiC,CAAjC,IAAiC;aAAjC,+BAAiC;;SAC5C,IAAM,KAAK,GAAQ,IAAI,CAAC,SAAS,EAC3B,UAAU,GAAgB,IAAI,CAAC,WAAW,IAAI,EAAE,CAAC;SAGvD,GAAG,EAAe,UAAM,EAAN,iBAAM,EAAN,oBAAM,EAAN,IAAO,CAAC;aAArB,IAAI,KAAK;aAEV,EAAE,EAAE,KAAK,YAAY,KAAM,CAAC,CAAC,CAAC;iBAC1B,OAAO,CAAC,MAAM,CAAC,KAAK,CAAE,IAAI,EAAE,KAAK,CAAE,CAAC;aACxC,CAAC;aAED,IAAI,CAAC,EAAE,EAAE,OAAO,KAAK,KAAK,UAAW,CAAC,EAAC;iBAEnC,mBAAQ,CAAE,IAAI,EAAE,KAAK,CAAE,CAAC;iBAGxB,UAAU,CAAE,KAAK,EAAqB,KAAM,CAAC,SAAS,EAAE,UAAU,CAAE,CAAC;aACzE,CAAC;aAED,IAAI,CAAC,CAAC;iBACF,UAAU,CAAE,KAAK,EAAE,KAAK,EAAE,UAAU,CAAE,CAAC;aAC3C,CAAC;UACJ;SAED,MAAM,CAAC,IAAI,CAAC;KAChB,CAAC;KAGM,aAAK,GAAZ;SAAmB,cAAoB;cAApB,WAAoB,CAApB,sBAAoB,CAApB,IAAoB;aAApB,6BAAoB;;SACnC,GAAG,EAAc,UAAI,EAAJ,aAAI,EAAJ,kBAAI,EAAJ,IAAK,CAAC;aAAlB,IAAI,IAAI;aACT,OAAO,CAAC,MAAM,CAAC,IAAI,CAAE,IAAI,EAAE,IAAI,CAAE,CAAC;UACrC;SAED,MAAM,CAAC,IAAI,CAAC;KAChB,CAAC;KAIM,kBAAU,GAAjB,UAAmB,UAAuB;SACtC,IAAM,IAAI,GAAG,MAAM,CAAC,cAAc,CAAE,IAAI,CAAC,SAAS,CAAE,CAAC,WAAW,CAAC;SAEjE,EAAE,EAAE,IAAI,CAAC,WAAY,CAAC,CAAC,CAAC;aACpB,UAAU,CAAE,UAAU,EAAE,IAAI,CAAC,WAAW,CAAE,CAAC;SAC/C,CAAC;SAED,IAAI,CAAC,WAAW,GAAG,UAAU,CAAC;SAC9B,MAAM,CAAC,IAAI,CAAC;KAChB,CAAC;KAUM,cAAM,GAAb,UAAe,UAAiC,EAAE,WAAiB;SAApD,0BAAiC,GAAjC,eAAiC;SAE5C,EAAE,EAAE,CAAC,IAAI,CAAC,MAAO,CAAC,EAAC;aACf,cAAG,CAAC,KAAK,CAAE,6JAA6J,EAAE,UAAU,CAAE,CAAC;aACvL,MAAM,CAAC,IAAI,CAAC;SAChB,CAAC;SAED,IAAI,CAAC,SAAS,EAAE,CAAC;SAGjB,IAAM,KAAK,GAAG,IAAI,CAAC,SAAS,CAAC;SAG7B,IAAM,UAAU,GAAG,eAAI,CAAE,UAAU,EAAE,YAAY,EAAE,QAAQ,EAAE,YAAY,CAAE,EACrE,0BAA6B,EAA7B,oCAA6B,EAAE,0BAAM,EAAE,kCAAU,CAAgB;SAGvE,iBAAM,CAAE,KAAK,EAAE,UAAU,CAAE,CAAC;SAC5B,iBAAM,CAAE,IAAI,EAAE,WAAW,CAAE,CAAC;SAG5B,UAAU,IAAI,MAAM,CAAC,gBAAgB,CAAE,KAAK,EAAE,oBAAS,CAAE,EAAE,EAAe,UAAU,EAAE,oBAAoB,CAAE,CAAE,CAAC;SAG/G,UAAU,IAAI,IAAI,CAAC,UAAU,CAAE,UAAU,CAAE,CAAC;SAC5C,MAAM,IAAI,IAAI,CAAC,MAAM,CAAE,MAAM,CAAE,CAAC;SAEhC,MAAM,CAAC,IAAI,CAAC;KAChB,CAAC;KAGM,cAAM,GAAb,UAAc,IAAuB,EAAE,OAAa;SAChD,IAAI,QAAyB,CAAC;SAI9B,EAAE,EAAE,IAAI,IAAI,IAAI,CAAC,cAAc,CAAE,aAAa,CAAG,CAAC,EAAC;aAE/C,QAAQ,GAAQ,IAAI,CAAC,WAAW,CAAC;aACjC,SAAS,CAAE,QAAQ,EAAE,IAAI,CAAE,CAAC;SAChC,CAAC;SAED,IAAI,EAAC;aACD,QAAQ,GAAG;iBAAuB,4BAAI;iBAA3B;qBAAuB,8BAAI;iBAAE,CAAC;iBAAD,eAAC;aAAD,CAAC,CAAP,IAAI,EAAG,CAAC;SAC9C,CAAC;SAGD,MAAM,CAAC,IAAI,GAAG,QAAQ,CAAC,MAAM,CAAE,IAAI,EAAE,OAAO,CAAE,GAAG,QAAQ,CAAC,SAAS,EAAE,CAAC;KAC1E,CAAC;KAIM,iBAAS,GAAhB;SACI,IAAM,SAAS,GAAoB,uBAAY,CAAE,IAAI,CAAE,CAAC;SAGxD,EAAE,EAAE,SAAS,CAAC,MAAM,KAAK,IAAI,CAAC,MAAO,CAAC,CAAC,CAAC;aACpC,IAAI,CAAC,MAAM,GAAG,OAAO,CAAC,MAAM,CAAC;SACjC,CAAC;SAED,MAAM,CAAC,IAAI,CAAC;KAChB,CAAC;KAhIgB,mBAAW,GAAgB,EAAE,UAAU,EAAG,OAAO,EAAE,CAAC;KAiIzE,cAAC;AAAD,EAAC;AAxIY,gBAAO,UAwInB;AAED,+BAA+B,CAAY;KACvC,EAAE,EAAE,CAAE,CAAC,EAAC;SACJ,MAAM,CAAC,OAAO,CAAC,KAAK,UAAU,GAAG,EAAE,GAAG,EAAgB,CAAC,EAAE,GAAwB,CAAC,CAAC;KACvF,CAAC;AACL,EAAC;AAGD,qBAA4B,KAAkB;KAC1C,MAAM,CAAC,eAAe,CAAE,YAAY,EAAE,KAAK,CAAE,CAAC;AAClD,EAAC;AAFe,mBAAU,aAEzB;AAGD;KAAwB,cAAc;UAAd,WAAc,CAAd,sBAAc,CAAd,IAAc;SAAd,6BAAc;;KAClC,MAAM,CAAC,eAAe,CAAE,QAAQ,EAAE,IAAI,CAAE,CAAC;AAC7C,EAAC;AAFe,eAAM,SAErB;AAGD,qBAA4B,IAAe;KACvC,OAAO,CAAC,KAAK,CAAE,IAAI,CAAE,CAAC;AAC1B,EAAC;AAFe,mBAAU,aAEzB;AAGD,oBAA2B,WAAuC;KAC9D,WAAW,CAAC,SAAS,EAAE,CAAC;AAC5B,EAAC;AAFe,kBAAS,YAExB;AAGD,iBAAwB,IAAsB;KAC1C,MAAM,CAAC,eAAe,CAAE,QAAQ,EAAE,IAAI,CAAE,CAAC;AAC7C,EAAC;AAFe,eAAM,SAErB;AAID,0BAA0B,IAAa,EAAE,IAAS;KAC9C,MAAM,CAAC,UAAU,IAAe;SAC5B,EAAE,EAAE,IAAI,CAAE,IAAI,CAAG,CAAC,CAAC,CAAC;aAChB,IAAI,CAAE,IAAI,CAAE,CAAE,IAAI,CAAE,CAAC;SACzB,CAAC;SACD,IAAI,CAAC,CAAC;aACF,OAAO,CAAE,IAAI,CAAE,CAAC,IAAI,CAAE,IAAI,EAAE,IAAI,CAAE,CAAC;SACvC,CAAC;KACL,CAAC;AACL,EAAC;AAKD,uBAAuB,CAAM,EAAE,CAAM,EAAE,KAAmB;KACtD,IAAM,CAAC,GAAG,iBAAM,CAAE,EAAE,EAAE,CAAC,CAAE,CAAC;KAC1B,MAAM,CAAC,UAAU,CAAE,CAAC,EAAG,CAAC,EAAE,KAAK,CAAE,CAAC;AACtC,EAAC;AAMD,KAAM,cAAc,GAAqB;KACrC,IAAI,YAAa,CAAiB,EAAE,CAAkB;SAClD,MAAM,CAAC,UAAU,CAAK;aAClB,MAAM,CAAC,CAAC,CAAC,IAAI,CAAE,IAAI,EAAE,CAAC,CAAC,IAAI,CAAE,IAAI,EAAE,CAAC,CAAE,CAAE,CAAC;SAC7C,CAAC;KACL,CAAC;KAED,QAAQ,YAAE,CAAY,EAAE,CAAY;SAChC,MAAM,CAAC;aACH,CAAC,CAAC,KAAK,CAAE,IAAI,EAAE,SAAS,CAAE,CAAC;aAC3B,CAAC,CAAC,KAAK,CAAE,IAAI,EAAE,SAAS,CAAE,CAAC;SAC/B,CAAC;KACL,CAAC;KAED,OAAO,YAAE,CAAY,EAAE,CAAY;SAC/B,MAAM,CAAC;aACH,CAAC,CAAC,KAAK,CAAE,IAAI,EAAE,SAAS,CAAE,CAAC;aAC3B,CAAC,CAAC,KAAK,CAAE,IAAI,EAAE,SAAS,CAAE,CAAC;SAC/B,CAAC;KACL,CAAC;KAED,KAAK,YAAE,CAAY,EAAE,CAAY;SAC7B,MAAM,CAAC;aACH,MAAM,CAAC,CAAC,CAAC,KAAK,CAAE,IAAI,EAAE,SAAS,CAAE,IAAI,CAAC,CAAC,KAAK,CAAE,IAAI,EAAE,SAAS,CAAE,CAAC;SACpE,CAAC;KACL,CAAC;KAED,IAAI,YAAE,CAAY,EAAE,CAAY;SAC5B,MAAM,CAAC;aACH,MAAM,CAAC,CAAC,CAAC,KAAK,CAAE,IAAI,EAAE,SAAS,CAAE,IAAI,CAAC,CAAC,KAAK,CAAE,IAAI,EAAE,SAAS,CAAE,CAAC;SACpE,CAAC;KACL,CAAC;EACJ,CAAC;AAEF,qBAAqC,MAAU,EAAE,MAAW,EAAE,KAAuB;KAAvB,qBAAuB,GAAvB,UAAuB;KACjF,GAAG,EAAc,UAAqB,EAArB,WAAM,CAAC,IAAI,CAAE,MAAM,CAAE,EAArB,cAAqB,EAArB,IAAsB,CAAC;SAAnC,IAAI,MAAI;SACT,IAAM,UAAU,GAAG,MAAM,CAAC,wBAAwB,CAAE,MAAM,EAAE,MAAI,CAAE,EAC5D,QAAQ,GAAK,gCAAqB,CAAE,MAAM,EAAE,MAAI,CAAE,CAAC;SAEzD,EAAE,EAAE,QAAS,CAAC,CAAC,CAAC;aACZ,IAAM,IAAI,GAAI,KAAK,CAAE,MAAI,CAAE,EACrB,KAAK,GAAG,QAAQ,CAAC,KAAK,CAAC;aAE7B,EAAE,EAAE,IAAI,IAAI,KAAM,CAAC,CAAC,CAAC;iBACjB,MAAM,CAAE,MAAI,CAAE,GAAG,OAAO,IAAI,KAAK,QAAQ;qBACrC,YAAY,CAAE,KAAK,EAAE,UAAU,CAAC,KAAK,EAAE,IAAI,CAAE,GAAE,CAC3C,IAAI,KAAK,OAAO;qBACZ,YAAY,CAAE,KAAK,EAAE,UAAU,CAAC,KAAK,CAAE;qBACvC,cAAc,CAAE,IAAI,CAAE,CAAE,KAAK,EAAE,UAAU,CAAC,KAAK,CAAE,CACxD,CAAC;aACV,CAAC;SACL,CAAC;SACD,IAAI,CAAC,CAAC;aACF,MAAM,CAAC,cAAc,CAAE,MAAM,EAAE,MAAI,EAAE,UAAU,CAAE,CAAC;SACtD,CAAC;MACJ;KAED,MAAM,CAAC,MAAM,CAAC;AAClB,EAAC;;;;;;;;;;;;;;ACxTD,KAAO,MAAM,uBAAY,CAAc,CAAC;AACxC,KAAO,KAAK,uBAAY,CAAa,CAAC,CAAC;AACvC,KAAO,SAAS,uBAAY,CAAiB,CAAC,CAAC;AAC/C,0CAA2C,CAE3C,CAAC,CAF0D;AAmBlD,iBAAQ;AAjBT,2BAAM,EAAE,sBAAM,EAAE,8BAAU,CAAY;AACtC,sBAAI,EAAE,iBAAI,EAAE,uBAAO,EAAE,iBAAI,CAAW;AACpC,0CAAY,EAAE,6BAAQ,EAAE,6BAAQ,EAAE,6BAAQ,EAAE,6BAAQ,CAAe;AAG3E,KAAM,aAAa,GAAG,KAAK,CAAC;AAE5B,KAAI,QAAQ,GAAG,CAAC,CAAC;AAEjB;KACI,MAAM,CAAC,GAAG,GAAG,QAAQ,EAAE,CAAC;AAC5B,EAAC;AAkBD;KAqCI,mBAAa,GAAqB;SA5BlC,YAAO,GAAgC,EAAE,CAAC;SA6BtC,IAAI,CAAC,GAAG,GAAG,IAAI,CAAC,SAAS,GAAG,GAAG,CAAC;KACpC,CAAC;KAlBM,gBAAM,GAAb,UAAe,UAAiC,EAAG,WAAY;SAC3D,IAAM,IAAI,GAAyB,IAAI,CAAE,UAAU,IAAI,EAAE,EAAE,aAAa,CAAE,CAAC;SAE3E,EAAE,EAAE,UAAW,CAAC,EAAC;aACL,wCAAW,EAAE,sCAAY,CAAgB;aACjD,EAAE,EAAE,WAAW,IAAI,YAAa,CAAC,EAAC;iBAC9B,IAAM,SAAS,GAAG,IAAI,uBAAQ,CAAE,IAAI,CAAC,SAAS,CAAC,YAAY,CAAE,CAAC;iBAC9D,WAAW,IAAI,SAAS,CAAC,YAAY,CAAE,WAAW,CAAE,CAAC;iBACrD,YAAY,IAAI,SAAS,CAAC,KAAK,CAAE,YAAY,CAAE,CAAC;iBAChD,IAAI,CAAC,YAAY,GAAG,SAAS,CAAC;aAClC,CAAC;SACL,CAAC;SAED,MAAM,CAAC,MAAM,CAAC,OAAO,CAAC,MAAM,CAAC,IAAI,CAAE,IAAI,EAAE,IAAI,EAAE,WAAW,CAAE,CAAC;KACjE,CAAC;KAQD,sBAAE,GAAF,UAAG,IAAI,EAAE,QAAQ,EAAE,OAAO;SACtB,MAAM,CAAC,UAAU,CAAC,IAAI,EAAE,IAAI,EAAE,QAAQ,EAAE,OAAO,CAAC,CAAC;KACrD,CAAC;KAKD,uBAAG,GAAH,UAAI,IAAc,EAAE,QAAoB,EAAE,OAAQ;SAC9C,EAAE,CAAC,CAAC,CAAC,IAAI,CAAC,OAAO,CAAC;aAAC,MAAM,CAAC,IAAI,CAAC;SAC/B,IAAI,CAAC,OAAO,GAAG,SAAS,CAAC,MAAM,EAAE,IAAI,CAAC,OAAO,EAAE,IAAI,EAAE,QAAQ,EACrC,IAAI,UAAU,CACV,OAAO,EACP,IAAI,CAAC,UAAU,CAAE,CACpB,CAAC;SAC1B,MAAM,CAAC,IAAI,CAAC;KAChB,CAAC;KAID,iCAAa,GAAb,UAAe,GAAgB,EAAE,IAAc,EAAE,QAAoB;SACjE,IAAM,WAAW,GAAG,IAAI,CAAC,YAAY,CAAC;SACtC,EAAE,CAAC,CAAC,CAAC,WAAW,CAAC;aAAC,MAAM,CAAC,IAAI,CAAC;SAE9B,IAAM,GAAG,GAAG,GAAG,GAAG,CAAC,GAAG,CAAC,GAAG,CAAC,GAAG,IAAI,CAAC,WAAW,CAAC,CAAC;SAEhD,GAAG,CAAC,CAAC,IAAI,CAAC,GAAG,CAAC,EAAE,CAAC,GAAG,GAAG,CAAC,MAAM,EAAE,CAAC,EAAE,EAAE,CAAC;aAClC,IAAM,SAAS,GAAG,WAAW,CAAC,GAAG,CAAC,CAAC,CAAC,CAAC,CAAC;aAItC,EAAE,CAAC,CAAC,CAAC,SAAS,CAAC;iBAAC,KAAK,CAAC;aAEtB,SAAS,CAAC,GAAG,CAAC,GAAG,CAAC,IAAI,EAAE,QAAQ,EAAE,IAAI,CAAC,CAAC;SAC5C,CAAC;SACD,EAAE,CAAC,CAAC,OAAO,CAAC,WAAW,CAAC,CAAC;aAAC,IAAI,CAAC,YAAY,GAAG,KAAK,CAAC,CAAC;SAErD,MAAM,CAAC,IAAI,CAAC;KAChB,CAAC;KAKD,4BAAQ,GAAR,UAAS,GAAe,EAAE,IAAI,EAAE,QAAS;SACrC,EAAE,EAAE,CAAC,GAAI,CAAC;aAAC,MAAM,CAAC,IAAI,CAAC;SAEvB,IAAM,EAAE,GAAG,GAAG,CAAC,GAAG,IAAI,CAAC,GAAG,CAAC,GAAG,GAAG,QAAQ,EAAE,CAAC,EACtC,WAAW,GAAG,IAAI,CAAC,YAAY,IAAI,CAAC,IAAI,CAAC,YAAY,GAAG,EAAE,CAAC,CAAC;SAElE,IAAI,SAAS,GAAG,WAAW,CAAC,EAAE,CAAC,CAAC;SAIhC,EAAE,CAAC,CAAC,CAAC,SAAS,CAAC,CAAC,CAAC;aACb,IAAM,MAAM,GAAG,IAAI,CAAC,GAAG,IAAI,CAAC,IAAI,CAAC,GAAG,GAAG,QAAQ,EAAE,CAAC,CAAC;aACnD,SAAS,GAAG,WAAW,CAAC,EAAE,CAAC,GAAG,IAAI,WAAW,CAAE,GAAG,EAAE,EAAE,EAAE,MAAM,EAAE,WAAW,CAAE,CAAC;SAClF,CAAC;SAGD,UAAU,CAAE,GAAG,EAAE,IAAI,EAAE,QAAQ,EAAE,IAAI,EAAE,SAAS,CAAE,CAAC;SACnD,MAAM,CAAC,IAAI,CAAC;KAChB,CAAC;KAMD,wBAAI,GAAJ,UAAK,IAAI,EAAE,QAAQ,EAAE,OAAO;SAExB,IAAM,MAAM,GAAG,SAAS,CAAC,OAAO,EAAE,EAAE,EAAE,IAAI,EAAE,QAAQ,EAAE,IAAI,CAAC,GAAG,CAAC,IAAI,CAAE,IAAI,CAAE,CAAC,CAAC;SAC7E,MAAM,CAAC,IAAI,CAAC,EAAE,CAAC,MAAM,EAAE,KAAK,CAAC,EAAE,OAAO,CAAC,CAAC;KAC5C,CAAC;KAGD,gCAAY,GAAZ,UAAa,GAAe,EAAE,IAAI,EAAE,QAAQ;SAExC,IAAM,MAAM,GAAG,SAAS,CAAC,OAAO,EAAE,EAAE,EAAE,IAAI,EAAE,QAAQ,EAAE,IAAI,CAAC,aAAa,CAAC,IAAI,CAAE,IAAI,EAAE,GAAG,CAAE,CAAE,CAAC;SAC7F,MAAM,CAAC,IAAI,CAAC,QAAQ,CAAC,GAAG,EAAE,MAAM,CAAC,CAAC;KACtC,CAAC;KAMD,2BAAO,GAAP,UAAQ,IAAa,EAAE,CAAE,EAAE,CAAE,EAAE,CAAE;SAC7B,EAAE,EAAE,CAAC,IAAI,CAAC,OAAQ,CAAC;aAAC,MAAM,CAAC,IAAI,CAAC;SAEhC,MAAM,EAAE,SAAS,CAAC,MAAO,CAAC,EAAC;aAEvB,KAAK,CAAC;iBAAG,QAAQ,CAAE,IAAI,EAAE,IAAI,CAAE,CAAC;iBAAC,KAAK,CAAC;aACvC,KAAK,CAAC;iBAAG,QAAQ,CAAE,IAAI,EAAE,IAAI,EAAE,CAAC,CAAE,CAAC;iBAAC,KAAK,CAAC;aAC1C,KAAK,CAAC;iBAAG,QAAQ,CAAE,IAAI,EAAE,IAAI,EAAE,CAAC,EAAE,CAAC,CAAE,CAAC;iBAAC,KAAK,CAAC;aAC7C,KAAK,CAAC;iBAAG,QAAQ,CAAE,IAAI,EAAE,IAAI,EAAE,CAAC,EAAE,CAAC,EAAE,CAAC,CAAE,CAAC;iBAAC,KAAK,CAAC;aAGhD;iBAEI,IAAM,OAAO,GAAG,KAAK,CAAE,SAAS,CAAC,MAAM,CAAE,CAAC;iBAE1C,GAAG,EAAE,IAAI,CAAC,GAAG,CAAC,EAAE,CAAC,GAAG,OAAO,CAAC,MAAM,EAAE,CAAC,EAAE,EAAE,CAAC;qBACtC,OAAO,CAAE,CAAC,CAAE,GAAG,SAAS,CAAE,CAAC,CAAE,CAAC;iBAClC,CAAC;iBAGO,0BAAO,CAAU;iBACzB,IAAI,KAAK,GAAG,OAAO,CAAE,IAAI,CAAE,CAAC;iBAE5B,EAAE,EAAE,KAAM,CAAC;qBAAC,aAAa,CAAE,KAAK,EAAE,OAAO,CAAC,MAAM,CAAE,CAAC,EAAE,CAAC,CAAE,CAAE,CAAC;iBAC3D,EAAE,EAAE,KAAK,GAAG,OAAO,CAAC,GAAI,CAAC;qBAAC,aAAa,CAAE,KAAK,EAAE,OAAO,CAAE,CAAC;SAClE,CAAC;SAED,MAAM,CAAC,IAAI,CAAC;KAChB,CAAC;KAED,2BAAO,GAAP;SACI,IAAI,CAAC,aAAa,EAAE,CAAC;SACrB,IAAI,CAAC,GAAG,EAAE,CAAC;KACf,CAAC;KA7JM,kBAAQ,GAAG,SAAS,CAAC,QAAQ;KAC7B,kBAAQ,GAAG,SAAS,CAAC,QAAQ;KAC7B,kBAAQ,GAAG,SAAS,CAAC,QAAQ;KAC7B,kBAAQ,GAAG,SAAS,CAAC,QAAQ;KAC7B,YAAE,GAAG,SAAS,CAAC,EAAE;KACjB,aAAG,GAAG,SAAS,CAAC,GAAG;KAX9B;SAAC,MAAM,CAAC;aACJ,SAAS,EAAG,GAAG;UAClB,CAAC;SACD,UAAU;kBAAA;KAiKX,gBAAC;AAAD,EAAC;AAhKqB,kBAAS,YAgK9B;AAED,KAAM,KAAK,GAAG,KAAK,CAAC,SAAS,CAAC,KAAK,CAAC;AAEvB,eAAM,GAAG,SAAS,CAAC,SAAS,CAAC;AAK1C,oBAAmB,QAAQ,EAAE,MAAM,EAAE,IAAI,EAAE,QAAQ,EAAE,IAAI;KACrD,IAAI,CAAC,GAAG,CAAC,EAAE,KAAK,CAAC;KACjB,EAAE,CAAC,CAAC,IAAI,IAAI,OAAO,IAAI,KAAK,QAAQ,CAAC,CAAC,CAAC;SAEnC,EAAE,CAAC,CAAC,QAAQ,KAAK,KAAK,CAAC,IAAI,SAAS,IAAI,IAAI,IAAI,IAAI,CAAC,OAAO,KAAK,KAAK,CAAC,CAAC;aAAC,IAAI,CAAC,OAAO,GAAG,QAAQ,CAAC;SACjG,GAAG,CAAC,CAAC,KAAK,GAAG,IAAI,CAAC,IAAI,CAAC,EAAE,CAAC,GAAG,KAAK,CAAC,MAAM,EAAG,CAAC,EAAE,EAAE,CAAC;aAC9C,MAAM,GAAG,SAAS,CAAC,QAAQ,EAAE,MAAM,EAAE,KAAK,CAAC,CAAC,CAAC,EAAE,IAAI,CAAC,KAAK,CAAC,CAAC,CAAC,CAAC,EAAE,IAAI,CAAC,CAAC;SACzE,CAAC;KACL,CAAC;KAAC,IAAI,CAAC,EAAE,CAAC,CAAC,IAAI,IAAI,aAAa,CAAC,IAAI,CAAC,IAAI,CAAC,CAAC,CAAC,CAAC;SAE1C,GAAG,CAAC,CAAC,KAAK,GAAG,IAAI,CAAC,KAAK,CAAC,aAAa,CAAC,EAAE,CAAC,GAAG,KAAK,CAAC,MAAM,EAAE,CAAC,EAAE,EAAE,CAAC;aAC5D,MAAM,GAAG,QAAQ,CAAC,MAAM,EAAE,KAAK,CAAC,CAAC,CAAC,EAAE,QAAQ,EAAE,IAAI,CAAC,CAAC;SACxD,CAAC;KACL,CAAC;KAAC,IAAI,CAAC,CAAC;SAEJ,MAAM,GAAG,QAAQ,CAAC,MAAM,EAAE,IAAI,EAAE,QAAQ,EAAE,IAAI,CAAC,CAAC;KACpD,CAAC;KACD,MAAM,CAAC,MAAM,CAAC;AAClB,EAAC;AAAA,EAAC;AAEF;KAEI,qBAAoB,GAAG,EAAS,KAAK,EAAS,EAAE,EAAS,WAAW;SAAhD,QAAG,GAAH,GAAG;SAAS,UAAK,GAAL,KAAK;SAAS,OAAE,GAAF,EAAE;SAAS,gBAAW,GAAX,WAAW;SADpE,UAAK,GAAY,CAAC;KACqD,CAAC;KAC5E,kBAAC;AAAD,EAAC;AAWD,qBAAoB,GAAe,EAAE,IAAI,EAAE,QAAQ,EAAE,OAAO,EAAE,SAAU;KACpE,GAAG,CAAC,OAAO,GAAG,SAAS,CAAC,KAAK,EAAE,GAAG,CAAC,OAAO,IAAI,EAAE,EAAE,IAAI,EAC9B,QAAQ,EAAE,IAAI,YAAY,CAAE,OAAO,EAAE,GAAG,EAAE,SAAS,CAAC,CAAC,CAAC;KAE9E,EAAE,CAAC,CAAC,SAAS,CAAC,CAAC,CAAC;SACZ,IAAM,SAAS,GAAG,GAAG,CAAC,UAAU,IAAI,CAAC,GAAG,CAAC,UAAU,GAAG,EAAE,CAAC,CAAC;SAC1D,SAAS,CAAC,SAAS,CAAC,EAAE,CAAC,GAAG,SAAS,CAAC;KACxC,CAAC;KAED,MAAM,CAAC,GAAG,CAAC;AACf,EAAC;AAAA,EAAC;AAGF,gBAAe,MAAmC,EAAE,IAAa,EAAE,QAAmB,EAAE,OAAO;KAC3F,EAAE,CAAC,CAAC,QAAQ,CAAC,CAAC,CAAC;SACX,IAAM,QAAQ,GAAG,MAAM,CAAC,IAAI,CAAC,EACvB,KAAK,GAAG,CAAE,OAAO,CAAC,KAAK,CAAE,QAAQ,CAAE,CAAE,CAAC;SAE5C,MAAM,CAAC,IAAI,CAAC,GAAG,QAAQ,GAAG,QAAQ,CAAC,MAAM,CAAE,KAAK,CAAE,GAAG,KAAK,CAAC;KAC/D,CAAC;KAED,MAAM,CAAC,MAAM,CAAC;AAClB,EAAC;AAAA,EAAC;AAEF;KACI,oBAAoB,OAAO,EAAS,SAAqB;SAArC,YAAO,GAAP,OAAO;SAAS,cAAS,GAAT,SAAS,CAAY;KAAG,CAAC;KACjE,iBAAC;AAAD,EAAC;AAGD,iBAAgB,MAAmC,EAAE,IAAI,EAAE,QAAQ,EAAE,OAAoB;KACrF,EAAE,CAAC,CAAC,CAAC,MAAM,CAAC;SAAC,MAAM,CAAC;KAEpB,IAAI,CAAC,GAAG,CAAC,EAAE,SAAS,CAAC;KACrB,IAAM,OAAO,GAAG,OAAO,CAAC,OAAO,EAAE,SAAS,GAAG,OAAO,CAAC,SAAS,CAAC;KAG/D,EAAE,CAAC,CAAC,CAAC,IAAI,IAAI,CAAC,QAAQ,IAAI,CAAC,OAAO,CAAC,CAAC,CAAC;SACjC,IAAM,GAAG,GAAG,IAAI,CAAC,SAAS,CAAC,CAAC;SAC5B,GAAG,CAAC,CAAC,EAAE,CAAC,GAAG,GAAG,CAAC,MAAM,EAAE,CAAC,EAAE,EAAE,CAAC;aACzB,SAAS,GAAG,SAAS,CAAC,GAAG,CAAC,CAAC,CAAC,CAAC,CAAC;aAC9B,OAAO,SAAS,CAAC,SAAS,CAAC,EAAE,CAAC,CAAC;aAC/B,OAAO,SAAS,CAAC,WAAW,CAAC,SAAS,CAAC,KAAK,CAAC,CAAC;SAClD,CAAC;SACD,MAAM,CAAC,EAAE,CAAC;KACd,CAAC;KAED,IAAM,KAAK,GAAG,IAAI,GAAG,CAAC,IAAI,CAAC,GAAG,IAAI,CAAC,MAAM,CAAC,CAAC;KAC3C,GAAG,CAAC,CAAC,EAAE,CAAC,GAAG,KAAK,CAAC,MAAM,EAAE,CAAC,EAAE,EAAE,CAAC;SAC3B,IAAI,GAAG,KAAK,CAAC,CAAC,CAAC,CAAC;SAChB,IAAM,QAAQ,GAAG,MAAM,CAAC,IAAI,CAAC,CAAC;SAG9B,EAAE,CAAC,CAAC,CAAC,QAAQ,CAAC;aAAC,KAAK,CAAC;SAGrB,IAAM,SAAS,GAAG,EAAE,CAAC;SACrB,GAAG,CAAC,CAAC,IAAI,CAAC,GAAG,CAAC,EAAE,CAAC,GAAG,QAAQ,CAAC,MAAM,EAAE,CAAC,EAAE,EAAE,CAAC;aACvC,IAAM,OAAO,GAAG,QAAQ,CAAC,CAAC,CAAC,CAAC;aAC5B,EAAE,CAAC,CACC,QAAQ,IAAI,QAAQ,KAAK,OAAO,CAAC,QAAQ;iBACzC,QAAQ,KAAK,OAAO,CAAC,QAAQ,CAAC,SAAS;iBACvC,OAAO,IAAI,OAAO,KAAK,OAAO,CAAC,OACnC,CAAC,CAAC,CAAC;iBACC,SAAS,CAAC,IAAI,CAAC,OAAO,CAAC,CAAC;aAC5B,CAAC;aAAC,IAAI,CAAC,CAAC;iBACJ,SAAS,GAAG,OAAO,CAAC,SAAS,CAAC;iBAC9B,EAAE,CAAC,CAAC,SAAS,IAAI,EAAE,SAAS,CAAC,KAAK,KAAK,CAAC,CAAC,CAAC,CAAC;qBACvC,OAAO,SAAS,CAAC,SAAS,CAAC,EAAE,CAAC,CAAC;qBAC/B,OAAO,SAAS,CAAC,WAAW,CAAC,SAAS,CAAC,KAAK,CAAC,CAAC;iBAClD,CAAC;aACL,CAAC;SACL,CAAC;SAGD,EAAE,CAAC,CAAC,SAAS,CAAC,MAAM,CAAC,CAAC,CAAC;aACnB,MAAM,CAAC,IAAI,CAAC,GAAG,SAAS,CAAC;SAC7B,CAAC;SAAC,IAAI,CAAC,CAAC;aACJ,OAAO,MAAM,CAAC,IAAI,CAAC,CAAC;SACxB,CAAC;KACL,CAAC;KACD,MAAM,CAAC,MAAM,CAAC;AAClB,EAAC;AAAA,EAAC;AAIF,kBAAiB,GAAG,EAAE,IAAI,EAAE,QAAQ,EAAE,KAAK;KACvC,EAAE,CAAC,CAAC,QAAQ,CAAC,CAAC,CAAC;SACX,IAAM,OAAK,GAAwB,GAAG,CAAC,IAAI,CAAC,GAAG,IAAI,CAAC;aAChD,KAAK,CAAC,IAAI,EAAE,OAAK,CAAC,CAAC;aACnB,QAAQ,CAAC,KAAK,CAAC,IAAI,EAAE,SAAS,CAAC,CAAC;SACpC,CAAC,CAAC,CAAC;SACH,OAAK,CAAC,SAAS,GAAG,QAAQ,CAAC;KAC/B,CAAC;KACD,MAAM,CAAC,GAAG,CAAC;AACf,EAAC;AAAA,EAAC;AAEF,wBAAwB,MAAiC,EAAE,CAAC;KACxD,GAAG,EAAY,UAAM,EAAN,iBAAM,EAAN,oBAAM,EAAN,IAAO,CAAC;SAAlB,IAAI,EAAE;SACP,EAAE,CAAC,QAAQ,CAAC,IAAI,CAAE,EAAE,CAAC,GAAG,EAAE,CAAC,CAAE,CAAC;MAAA;AACtC,EAAC;;;;;;;;AChVD,4CAA+C,CAE/C,CAAC,CAFgE;AAEpD,sBAAa,GAAG,KAAK,CAAC;AAWnC;KACI,sBACW,OAAO,EACP,GAAG,EACH,SAAe,EACf,QAAoB;SAHpB,YAAO,GAAP,OAAO;SACP,QAAG,GAAH,GAAG;SACH,cAAS,GAAT,SAAS,CAAM;SACf,aAAQ,GAAR,QAAQ,CAAY;KAC7B,CAAC;KAEH,4BAAK,GAAL,UAAO,QAAQ;SACX,aAAmC,EAA3B,oBAAO,EAAE,wBAAS,CAAU;SACpC,EAAE,CAAC,CAAC,SAAS,CAAC;aAAC,SAAS,CAAC,KAAK,EAAE,CAAC;SACjC,MAAM,CAAC,IAAI,YAAY,CAAE,OAAO,EAAE,OAAO,IAAI,IAAI,CAAC,GAAG,EAAE,SAAS,EAAE,QAAQ,CAAE,CAAC;KACjF,CAAC;KACL,mBAAC;AAAD,EAAC;AAbY,qBAAY,eAaxB;AAoBD;KAGI,kBAAa,GAAkC;SAF/C,aAAQ,GAAuB,EAAE,CAAC;SAG9B,EAAE,EAAE,GAAI,CAAC,EAAC;aACN,EAAE,EAAE,GAAG,YAAY,QAAS,CAAC,EAAC;iBAC1B,IAAI,CAAC,QAAQ,GAAG,GAAG,CAAC,QAAQ,CAAC,KAAK,EAAE,CAAC;aACzC,CAAC;aACD,IAAI,EAAC;iBACD,GAAG,IAAI,IAAI,CAAC,YAAY,CAAE,GAAG,CAAE,CAAC;aACpC,CAAC;SACL,CAAC;KACL,CAAC;KAED,wBAAK,GAAL,UAAO,GAAc;SACjB,IAAI,CAAC,QAAQ,GAAG,IAAI,CAAC,QAAQ,CAAC,MAAM,CAAE,GAAG,CAAC,QAAQ,CAAE,CAAC;KACzD,CAAC;KAED,+BAAY,GAAZ,UAAc,GAAsB;SAChC,GAAG,EAAE,IAAI,KAAK,IAAI,GAAI,CAAC,EAAC;aACpB,IAAI,CAAC,QAAQ,CAAE,KAAK,EAAE,GAAG,CAAE,KAAK,CAAE,CAAE;SACxC,CAAC;KACL,CAAC;KAED,+BAAY,GAAZ,UAAc,KAAc;SACxB,GAAG,EAAc,UAA4B,EAA5B,UAAK,CAAC,KAAK,CAAE,qBAAa,CAAE,EAA5B,cAA4B,EAA5B,IAA6B,CAAC;aAA1C,IAAI,MAAI;aACT,IAAI,CAAC,QAAQ,CAAE,MAAI,EAAE,kBAAkB,CAAE,MAAI,CAAE,CAAE,CAAC;UACrD;KACL,CAAC;KAED,2BAAQ,GAAR,UAAU,KAAc,EAAE,QAAsC;SACpD,4BAAQ,CAAU;SAE1B,GAAG,EAAc,UAA4B,EAA5B,UAAK,CAAC,KAAK,CAAE,qBAAa,CAAE,EAA5B,cAA4B,EAA5B,IAA6B,CAAC;aAA1C,IAAI,MAAI;aACT,QAAQ,CAAC,IAAI,CAAE,IAAI,eAAe,CAAE,MAAI,EAAE,QAAQ,CAAE,CAAE,CAAC;UAC1D;KACL,CAAC;KAED,4BAAS,GAAT,UAAW,MAAoB,EAAE,MAAmB;SACxC,4BAAO,CAAY;SAC3B,GAAG,EAAe,UAAa,EAAb,SAAI,CAAC,QAAQ,EAAb,cAAa,EAAb,IAAc,CAAC;aAA5B,IAAI,OAAK;aACV,GAAG,CAAE,OAAO,EAAE,OAAK,CAAC,IAAI,EAAE,OAAK,CAAC,QAAQ,EAAE,MAAM,CAAE,CAAC;UACtD;KACL,CAAC;KAED,8BAAW,GAAX,UAAa,MAAoB,EAAE,MAAmB;SAC1C,4BAAO,CAAY;SAC3B,GAAG,EAAe,UAAa,EAAb,SAAI,CAAC,QAAQ,EAAb,cAAa,EAAb,IAAc,CAAC;aAA5B,IAAI,OAAK;aACV,IAAI,CAAE,OAAO,EAAE,OAAK,CAAC,IAAI,EAAE,OAAK,CAAC,QAAQ,EAAE,MAAM,CAAE,CAAC;UACvD;KACL,CAAC;KACL,eAAC;AAAD,EAAC;AAnDY,iBAAQ,WAmDpB;AAED;KAGI,yBACW,IAAa,EACpB,QAAsC;SAD/B,SAAI,GAAJ,IAAI,CAAS;SAGpB,EAAE,EAAE,QAAQ,KAAK,IAAK,CAAC,EAAC;aACpB,IAAI,CAAC,QAAQ,GAAG,kBAAkB,CAAE,IAAI,CAAE,CAAC;SAC/C,CAAC;SACD,IAAI,CAAC,EAAE,EAAE,OAAO,QAAQ,KAAK,QAAS,CAAC,EAAC;aACpC,+DAAwE,EAAhE,gBAAK,EAAE,sBAAO,EAAE,gBAAI,CAA6C;aACzE,IAAI,CAAC,QAAQ,GAAG,KAAK,GAAG,CACpB;iBACI,IAAM,OAAO,GAAG,IAAI,CAAE,MAAI,CAAE,CAAC;iBAC7B,OAAO,IAAI,OAAO,CAAC,KAAK,CAAE,IAAI,EAAE,SAAS,CAAE,CAAC;aAChD,CAAC,CACJ,GAAG,CACA;iBACI,IAAM,OAAO,GAAG,SAAO,CAAE,IAAI,CAAE,CAAC;iBAChC,EAAE,EAAE,OAAQ,CAAC,EAAC;qBACV,IAAM,OAAO,GAAG,OAAO,CAAE,MAAI,CAAE,CAAC;qBAChC,EAAE,EAAE,OAAQ,CAAC,EAAC;yBACV,OAAO,CAAC,KAAK,CAAE,OAAO,EAAE,SAAS,CAAE,CAAC;qBACxC,CAAC;iBACL,CAAC;aACL,CAAC,CACJ,CAAC;SACN,CAAC;SACD,IAAI,EAAC;aACD,IAAI,CAAC,QAAQ,GAAa,QAAQ,CAAC;SACvC,CAAC;KACL,CAAC;KACL,sBAAC;AAAD,EAAC;AAMD,aAAoB,IAAiB,EAAE,IAAa,EAAE,QAAmB,EAAE,OAAQ;KAC/E,GAAG,CAAE,IAAI,CAAC,OAAO,EAAE,IAAI,EAAE,QAAQ,EAAE,OAAO,CAAE,CAAC;AACjD,EAAC;AAFe,WAAE,KAEjB;AAED,cAAqB,IAAiB,EAAE,IAAa,EAAE,QAAmB,EAAE,OAAY;KACpF,IAAI,CAAE,IAAI,CAAC,OAAO,EAAE,IAAI,EAAE,QAAQ,EAAE,OAAO,CAAE,CAAC;AAClD,EAAC;AAFe,YAAG,MAElB;AAKD,mBAA0B,IAAiB,EAAE,IAAa;KAC9C,0BAAO,EACT,KAAK,GAAG,OAAO,CAAE,IAAI,CAAE,EACrB,iBAAG,CAAa;KAExB,EAAE,EAAE,KAAM,CAAC;SAAC,WAAW,CAAE,KAAK,CAAE,CAAC;KACjC,EAAE,EAAE,GAAI,CAAC;SAAC,WAAW,CAAE,GAAG,EAAE,IAAI,CAAE,CAAC;AACvC,EAAC;AAPe,iBAAQ,WAOvB;AAAA,EAAC;AAEF,mBAA0B,IAAiB,EAAE,IAAa,EAAE,CAAO;KACvD,0BAAO,EACP,KAAK,GAAG,OAAO,CAAE,IAAI,CAAE,EACvB,iBAAG,CAAa;KAExB,EAAE,EAAE,KAAM,CAAC;SAAC,WAAW,CAAE,KAAK,EAAE,CAAC,CAAE,CAAC;KACpC,EAAE,EAAE,GAAI,CAAC;SAAC,WAAW,CAAE,GAAG,EAAE,IAAI,EAAE,CAAC,CAAE,CAAC;AAC1C,EAAC;AAPe,iBAAQ,WAOvB;AAAA,EAAC;AAEF,mBAA0B,IAAiB,EAAE,IAAa,EAAE,CAAC,EAAE,CAAC;KACpD,0BAAO,EACP,KAAK,GAAG,OAAO,CAAE,IAAI,CAAE,EACvB,iBAAG,CAAa;KAExB,EAAE,EAAE,KAAM,CAAC;SAAC,WAAW,CAAE,KAAK,EAAE,CAAC,EAAE,CAAC,CAAE,CAAC;KACvC,EAAE,EAAE,GAAI,CAAC;SAAC,WAAW,CAAE,GAAG,EAAE,IAAI,EAAE,CAAC,EAAE,CAAC,CAAE,CAAC;AAC7C,EAAC;AAPe,iBAAQ,WAOvB;AAAA,EAAC;AAEF,mBAA0B,IAAiB,EAAE,IAAa,EAAE,CAAC,EAAE,CAAC,EAAE,CAAC;KACvD,0BAAO,EACP,KAAK,GAAG,OAAO,CAAE,IAAI,CAAE,EACvB,iBAAG,CAAa;KAExB,EAAE,EAAE,KAAM,CAAC;SAAC,WAAW,CAAE,KAAK,EAAE,CAAC,EAAE,CAAC,EAAE,CAAC,CAAE,CAAC;KAC1C,EAAE,EAAE,GAAI,CAAC;SAAC,WAAW,CAAE,GAAG,EAAE,IAAI,EAAE,CAAC,EAAE,CAAC,EAAE,CAAC,CAAE,CAAC;AAChD,EAAC;AAPe,iBAAQ,WAOvB;AAAA,EAAC;AAIF,sBAAsB,MAAuB;KACzC,GAAG,EAAY,UAAM,EAAN,iBAAM,EAAN,oBAAM,EAAN,IAAO,CAAC;SAAlB,IAAI,EAAE;SACP,EAAE,CAAC,QAAQ,CAAC,IAAI,CAAE,EAAE,CAAC,GAAG,CAAE,CAAC;MAAA;AACnC,EAAC;AAED,sBAAsB,MAAuB,EAAE,CAAC;KAC5C,GAAG,EAAY,UAAM,EAAN,iBAAM,EAAN,oBAAM,EAAN,IAAO,CAAC;SAAlB,IAAI,EAAE;SACP,EAAE,CAAC,QAAQ,CAAC,IAAI,CAAE,EAAE,CAAC,GAAG,EAAE,CAAC,CAAE,CAAC;MAAA;AACtC,EAAC;AAED,sBAAsB,MAAuB,EAAE,CAAC,EAAE,CAAC;KAC/C,GAAG,EAAY,UAAM,EAAN,iBAAM,EAAN,oBAAM,EAAN,IAAO,CAAC;SAAlB,IAAI,EAAE;SACP,EAAE,CAAC,QAAQ,CAAC,IAAI,CAAE,EAAE,CAAC,GAAG,EAAE,CAAC,EAAE,CAAC,CAAE,CAAC;MAAA;AACzC,EAAC;AAED,sBAAsB,MAAuB,EAAE,CAAC,EAAE,CAAC,EAAE,CAAC;KAClD,GAAG,EAAY,UAAM,EAAN,iBAAM,EAAN,oBAAM,EAAN,IAAO,CAAC;SAAlB,IAAI,EAAE;SACP,EAAE,CAAC,QAAQ,CAAC,IAAI,CAAE,EAAE,CAAC,GAAG,EAAE,CAAC,EAAE,CAAC,EAAE,CAAC,CAAE,CAAC;MAAA;AAC5C,EAAC;AAED,sBAAsB,MAAuB,EAAE,CAAC,EAAE,CAAC,EAAE,CAAC,EAAE,CAAC;KACrD,GAAG,EAAY,UAAM,EAAN,iBAAM,EAAN,oBAAM,EAAN,IAAO,CAAC;SAAlB,IAAI,EAAE;SACP,EAAE,CAAC,QAAQ,CAAC,IAAI,CAAE,EAAE,CAAC,GAAG,EAAE,CAAC,EAAE,CAAC,EAAE,CAAC,EAAE,CAAC,CAAE,CAAC;MAAA;AAC/C,EAAC;AAGD,cAAc,OAA0B,EAAE,IAAa,EAAE,QAAmB,EAAE,OAAgB,EAAE,GAAa;KACzG,IAAM,MAAM,GAAG,OAAO,CAAE,IAAI,CAAE,EACxB,OAAO,GAAG,IAAI,YAAY,CAAE,OAAO,EAAE,GAAG,IAAI,OAAO,EAAE,IAAI,EAAE,QAAQ,CAAE,CAAC;KAE5E,EAAE,EAAE,MAAO,CAAC,EAAC;SACT,MAAM,CAAC,IAAI,CAAE,OAAO,CAAE,CAAC;KAC3B,CAAC;KACD,IAAI,EAAC;SACD,OAAO,CAAE,IAAI,CAAE,GAAG,CAAE,OAAO,CAAE,CAAC;KAClC,CAAC;AACL,EAAC;AAAA,EAAC;AAGF,eAAe,OAA0B,EAAE,IAAa,EAAE,QAAmB,EAAE,OAAY;KACvF,IAAM,MAAM,GAAG,OAAO,CAAE,IAAI,CAAE,CAAC;KAE/B,EAAE,EAAE,MAAO,CAAC,CAAC,CAAC;SACV,IAAM,MAAM,GAAG,EAAE,CAAC;SAElB,GAAG,CAAC,CAAY,UAAM,EAAN,iBAAM,EAAN,oBAAM,EAAN,IAAO,CAAC;aAAlB,IAAI,EAAE;aACR,EAAE,EAAE,CAAE,QAAQ,IAAI,QAAQ,KAAK,EAAE,CAAC,QAAQ,CAAE,IAAI,OAAO,KAAK,EAAE,CAAC,OAAQ,CAAC,CAAC,CAAC;iBACtE,MAAM,CAAC,IAAI,CAAC,EAAE,CAAC,CAAC;aACpB,CAAC;UACJ;SAED,OAAO,CAAE,IAAI,CAAE,GAAG,MAAM,CAAC,MAAM,GAAG,MAAM,GAAG,KAAK,CAAC,CAAC;KACtD,CAAC;AACL,EAAC;AAAA,EAAC;AAEF,KAAM,iBAAiB,GAAG,EAAE,CAAC;AAE7B,6BAA6B,KAAc;KACvC,MAAM,CAAC,iBAAiB,CAAE,KAAK,CAAE,IAAI,CACjC,iBAAiB,CAAE,KAAK,CAAE,GAAG,UAAU,CAAC,EAAE,CAAC,EAAE,CAAC;SAC1C,MAAM,EAAE,SAAS,CAAC,MAAO,CAAC,EAAC;aAEvB,KAAK,CAAC;iBAAG,QAAQ,CAAE,IAAI,EAAE,KAAK,CAAE,CAAC;iBAAC,KAAK,CAAC;aACxC,KAAK,CAAC;iBAAG,QAAQ,CAAE,IAAI,EAAE,KAAK,EAAE,CAAC,CAAE,CAAC;iBAAC,KAAK,CAAC;aAC3C,KAAK,CAAC;iBAAG,QAAQ,CAAE,IAAI,EAAE,KAAK,EAAE,CAAC,EAAE,CAAC,CAAE,CAAC;iBAAC,KAAK,CAAC;aAC9C,KAAK,CAAC;iBAAG,QAAQ,CAAE,IAAI,EAAE,KAAK,EAAE,CAAC,EAAE,CAAC,EAAE,CAAC,CAAE,CAAC;iBAAC,KAAK,CAAC;aACjD;iBACI,IAAM,IAAI,GAAG,CAAE,KAAK,EAAE,CAAC,EAAE,CAAC,EAAE,CAAC,CAAE,CAAC;iBAEhC,GAAG,EAAE,IAAI,CAAC,GAAG,CAAC,EAAE,CAAC,GAAG,SAAS,CAAC,MAAM,EAAE,CAAC,EAAE,EAAE,CAAC;qBACxC,IAAI,CAAC,IAAI,CAAE,SAAS,CAAE,CAAC,CAAE,CAAE,CAAC;iBAChC,CAAC;iBAED,IAAI,CAAC,OAAO,CAAC,KAAK,CAAE,IAAI,EAAE,IAAI,CAAE,CAAC;SACzC,CAAC;KACL,CAAC,CACJ,CAAC;AACN,EAAC;;;;;;;;AC1PD,KAAM,aAAa,GAAI,gBAAgB,CAAC;AAIxC;KAKI,2BAAa,SAAkB,EAAE,SAA2B;SAA3B,yBAA2B,GAA3B,iBAA2B;SACxD,IAAM,IAAI,GAAG,SAAS;cACL,KAAK,CAAE,aAAa,CAAE;cACtB,GAAG,CAAE,aAAG,IAAI,UAAG,KAAK,GAAG,GAAG,YAAY,GAAG,CAAE,GAAG,KAAK,GAAG,GAAG,YAAY,GAAG,GAAG,CAAE,EAAjE,CAAiE,CAAE,CAAC;SAEjG,IAAI,CAAC,IAAI,GAAG,SAAS,IAAI,IAAI,CAAC,GAAG,EAAE,CAAC;SACpC,IAAI,CAAC,KAAK,GAAG,CAAC,IAAI,CAAC,MAAM,CAAC;SAE1B,IAAI,CAAC,OAAO,CAAE,MAAM,CAAE,CAAC;SAEvB,IAAI,CAAC,OAAO,GAAS,IAAI,QAAQ,CAAE,MAAM,EAAE,YAAW,IAAI,MAAI,CAAE,CAAC;KACrE,CAAC;KACL,wBAAC;AAAD,EAAC;AAjBY,0BAAiB,oBAiB7B;AAED,2BAAkC,IAAkB,EAAE,SAAkB,EAAE,MAAwC;KAC9G,IAAM,IAAI,GAAG,SAAS,CAAC,KAAK,CAAE,aAAa,CAAE,EACvC,IAAI,GAAG,IAAI,CAAC,MAAM,GAAG,CAAC,CAAC;KAE7B,IAAI,IAAI,GAAG,IAAI,CAAC;KAEhB,GAAG,EAAE,IAAI,CAAC,GAAG,CAAC,EAAE,CAAC,GAAG,IAAI,EAAE,CAAC,EAAE,EAAE,CAAC;SAC5B,IAAM,GAAG,GAAG,IAAI,CAAE,CAAC,CAAE,CAAC;SACtB,MAAM,EAAE,GAAI,CAAC,EAAC;aACV,KAAK,GAAG;iBAAG,IAAI,GAAG,IAAI,CAAC,QAAQ,EAAE,CAAC;iBAAC,KAAK,CAAC;aACzC,KAAK,GAAG;iBAAG,IAAI,GAAG,IAAI,CAAC,QAAQ,EAAE,CAAC;iBAAC,KAAK,CAAC;aACzC,SAAW,IAAI,GAAG,IAAI,CAAC,GAAG,CAAE,GAAG,CAAE,CAAC;SACtC,CAAC;SAGD,EAAE,EAAE,CAAC,IAAK,CAAC;aAAC,MAAM,CAAC;KACvB,CAAC;KAED,MAAM,CAAE,IAAI,EAAE,IAAI,CAAE,IAAI,CAAE,CAAE,CAAC;KAC7B,MAAM,CAAC,IAAI,CAAC;AAChB,EAAC;AApBe,yBAAgB,mBAoB/B;AAGD,4BAAmC,SAAS,EAAE,KAAK;KAC/C,IAAM,IAAI,GAAG,SAAS,CAAC,KAAK,CAAE,GAAG,CAAE,EAC7B,IAAI,GAAG,EAAE,EACT,IAAI,GAAG,IAAI,CAAC,MAAM,GAAG,CAAC,CAAC;KAC7B,IAAI,OAAO,GAAG,IAAI,CAAC;KAEnB,GAAG,EAAE,IAAI,CAAC,GAAG,CAAC,EAAE,CAAC,GAAG,IAAI,EAAE,CAAC,EAAE,EAAE,CAAC;SAC5B,OAAO,GAAG,OAAO,CAAE,IAAI,CAAE,CAAC,CAAE,CAAE,GAAG,EAAE,CAAC;KACxC,CAAC;KAED,OAAO,CAAE,IAAI,CAAE,IAAI,CAAE,CAAE,GAAG,KAAK,CAAC;KAEhC,MAAM,CAAC,IAAI,CAAC;AAChB,EAAC;AAbe,0BAAiB,oBAahC;;;;;;;;;;;;;;;;;;;ACzED,sCAA2E,CAC3E,CAAC,CADiG;AAClG,2CAA6D,EAC7D,CAAC,CAD6E;AAC9E,4CAA8C,CAE9C,CAAC,CAF0E;AAEnE,6CAAQ,EAAE,wCAAQ,CAAe;AAazC;KAA4C,iCAAS;KAoBjD,uBAAa,GAAqB,EAAE,KAAc,EAAE,QAAkB;SAClE,kBAAO,GAAG,CAAE,CAAC;SAnBjB,iBAAY,GAAQ,EAAE;SAGtB,iBAAY,GAAa,KAAK,CAAC;SAG/B,aAAQ,GAAyB,IAAI,CAAC;SA0ItC,qBAAgB,GAAqB,KAAK,CAAC;SA5HvC,IAAI,CAAC,MAAM,GAAG,KAAK,CAAC;SACpB,IAAI,CAAC,SAAS,GAAG,QAAQ,CAAC;KAC9B,CAAC;KAQD,mCAAW,GAAX,UAAa,GAA6B,EAAE,OAAiC;SAAjC,uBAAiC,GAAjC,YAAiC;SACzE,IAAM,MAAM,GAAG,KAAK,CAAE,IAAI,CAAE,CAAC;SAC7B,GAAG,CAAC,IAAI,CAAE,IAAI,EAAE,IAAI,CAAE,CAAC;SACvB,MAAM,IAAI,MAAM,CAAE,IAAI,CAAE,CAAC;KAC7B,CAAC;KAID,kCAAU,GAAV,UAAY,QAA8C,EAAE,OAA6B;SACrF,IAAM,MAAM,GAAG,KAAK,CAAE,IAAI,CAAE,CAAC;SAC7B,IAAI,CAAC,IAAI,CAAE,QAAQ,CAAE,CAAC;SACtB,MAAM,IAAI,MAAM,CAAE,IAAI,CAAE,CAAC;KAC7B,CAAC;KAGD,2BAAG,GAAH,UAAK,MAAY,EAAE,OAA6B;SAC5C,EAAE,EAAE,MAAO,CAAC,EAAC;aACT,IAAM,WAAW,GAAG,IAAI,CAAC,kBAAkB,CAAE,MAAM,EAAE,OAAO,CAAE,CAAC;aAC/D,WAAW,IAAI,WAAW,CAAC,MAAM,EAAE,CAAC;SACxC,CAAC;SAED,MAAM,CAAC,IAAI,CAAC;KAChB,CAAC;KAQD,6BAAK,GAAL,UAAO,IAAU,IAAW,MAAM,CAAC,IAAI,EAAC,CAAC;KAazC,+BAAO,GAAP,UAAS,SAAkB;SACvB,MAAM,CAAC,iCAAgB,CAAE,IAAI,EAAE,SAAS,EAAE,UAAE,MAAM,EAAE,GAAG,IAAM,aAAM,CAAC,GAAG,CAAE,GAAG,CAAE,EAAjB,CAAiB,CAAE,CAAC;KACrF,CAAC;KAKD,gCAAQ,GAAR;SACI,MAAM,CAAC,IAAI,CAAC,MAAM,CAAC;KACvB,CAAC;KAMD,gCAAQ,GAAR;SACY,wBAAM,CAAU;SACxB,MAAM,CAAC,MAAM,GAAmB,MAAM,CAAC,QAAQ,EAAE,GAAG,IAAI,CAAC,aAAa,CAAC;KAC3E,CAAC;KAWD,2BAAG,GAAH,UAAQ,QAA2C,EAAE,OAAc;SAC/D,IAAM,GAAG,GAAS,EAAE,EACd,GAAG,GAAG,SAAS,CAAC,MAAM,KAAK,CAAC,GAAG,UAAE,CAAC,EAAE,CAAC,IAAM,eAAQ,CAAC,IAAI,CAAE,OAAO,EAAE,CAAC,EAAE,CAAC,CAAE,EAA9B,CAA8B,GAAG,QAAQ,CAAC;SAE3F,IAAI,CAAC,IAAI,CAAE,UAAE,GAAG,EAAE,GAAG;aACjB,IAAM,MAAM,GAAG,GAAG,CAAE,GAAG,EAAE,GAAG,CAAE,CAAC;aAC/B,EAAE,EAAE,MAAM,KAAK,KAAK,CAAE,CAAC;iBAAC,GAAG,CAAC,IAAI,CAAE,MAAM,CAAE,CAAC;SAC/C,CAAC,CAAE,CAAC;SAEJ,MAAM,CAAC,GAAG,CAAC;KACf,CAAC;KAGD,iCAAS,GAAT,UAAc,QAAoD,EAAE,OAAc;SAC9E,IAAM,GAAG,GAA8B,EAAE,EACrC,GAAG,GAAG,SAAS,CAAC,MAAM,KAAK,CAAC,GAAG,UAAE,CAAC,EAAE,CAAC,IAAM,eAAQ,CAAC,IAAI,CAAE,OAAO,EAAE,CAAC,EAAE,CAAC,CAAE,EAA9B,CAA8B,GAAG,QAAQ,CAAC;SAEzF,IAAI,CAAC,IAAI,CAAE,UAAE,GAAG,EAAE,GAAG;aACjB,IAAM,MAAM,GAAG,QAAQ,CAAE,GAAG,EAAE,GAAG,CAAE,CAAC;aACpC,EAAE,EAAE,MAAM,KAAK,KAAK,CAAE,CAAC;iBAAC,GAAG,CAAE,GAAG,CAAE,GAAG,MAAM,CAAC;SAChD,CAAC,CAAE,CAAC;SAEJ,MAAM,CAAC,GAAG,CAAC;KACf,CAAC;KAGD,4BAAI,GAAJ;SACI,MAAM,CAAC,IAAI,CAAC,GAAG,CAAE,UAAE,KAAK,EAAE,GAAG;aACzB,EAAE,EAAE,KAAK,KAAK,KAAK,CAAE,CAAC;iBAAC,MAAM,CAAC,GAAG,CAAC;SACtC,CAAC,CAAC,CAAC;KACP,CAAC;KAGD,8BAAM,GAAN;SACI,MAAM,CAAC,IAAI,CAAC,GAAG,CAAE,eAAK,IAAI,YAAK,EAAL,CAAK,CAAE,CAAC;KACtC,CAAC;KAUD,sBAAI,0CAAe;cAAnB;aACI,IAAM,KAAK,GAAG,IAAI,CAAC,gBAAgB,IAAI,CAAE,IAAI,CAAC,gBAAgB,GAAG,IAAI,+BAAe,CAAE,IAAI,CAAE,CAAE,CAAC;aAC/F,MAAM,CAAC,KAAK,CAAC,MAAM,GAAG,KAAK,GAAG,IAAI,CAAC;SACvC,CAAC;;;QAAA;KAED,mCAAW,GAAX,UAAa,OAAiC;SAC1C,IAAI,KAAK,CAAC;SACV,EAAE,EAAE,OAAO,CAAC,QAAQ,IAAI,CAAE,KAAK,GAAG,IAAI,CAAC,eAAe,CAAG,CAAC,EAAC;aACvD,IAAI,CAAC,OAAO,CAAE,SAAS,EAAE,IAAI,EAAE,KAAK,EAAE,iBAAM,CAAE,EAAE,eAAe,EAAG,KAAK,EAAE,EAAE,OAAO,CAAE,CAAE,CAAC;aACvF,MAAM,CAAC,IAAI,CAAC;SAChB,CAAC;KACL,CAAC;KAMD,gCAAQ,GAAR,UAAU,GAAoB,IAAU,CAAC;KAGzC,0CAAkB,GAAlB,UAAoB,GAAY;SAC5B,IAAI,KAAK,GAAG,IAAI,CAAC,eAAe,CAAC;SACjC,MAAM,CAAC,CAAE,GAAG,GAAG,KAAK,IAAI,KAAK,CAAC,MAAM,CAAE,GAAG,CAAE,GAAG,KAAK,CAAE,IAAI,IAAI,CAAC;KAClE,CAAC;KAGD,2CAAmB,GAAnB,UAAqB,SAAkB;SACnC,MAAM,CAAC,iCAAgB,CAAE,IAAI,EAAE,SAAS,EAAE,UAAE,MAAM,EAAE,GAAG,IAAM,aAAM,CAAC,kBAAkB,CAAE,GAAG,CAAE,EAAhC,CAAgC,CAAE,CAAC;KACpG,CAAC;KAGD,2CAAmB,GAAnB,UAAqB,QAAwE;SACjF,0CAAe,CAAU;SACjC,eAAe,IAAI,eAAe,CAAC,SAAS,CAAE,QAAQ,EAAE,IAAI,CAAE,CAAC;KACnE,CAAC;KAGD,+BAAO,GAAP,UAAS,GAAY;SACjB,MAAM,CAAC,CAAC,IAAI,CAAC,kBAAkB,CAAE,GAAG,CAAE,CAAC;KAC3C,CAAC;KA/LL;SAAC,iBAAM,CAAC;aACJ,gBAAgB,EAAG,QAAQ;UAC9B,CAAC;sBAAA;KA8LF,oBAAC;AAAD,EAAC,CA7L2C,oBAAS,GA6LpD;AA7LqB,sBAAa,gBA6LlC;AAoDD,gBAAuB,MAAsB;KACzC,MAAM,CAAC,MAAM,CAAC,YAAY,GAAG,KAAK,GAAG,CAAE,MAAM,CAAC,YAAY,GAAG,IAAI,CAAE,CAAC;AACxE,EAAC;AAFe,cAAK,QAEpB;AAID,sBAA6B,MAAsB,EAAE,OAA4B;KAE7E,IAAM,KAAK,GAAG,CAAC,OAAO,CAAC,MAAM,CAAC;KAC9B,EAAE,EAAE,KAAM,CAAC;SAAC,MAAM,CAAC,QAAQ,GAAG,OAAO,CAAC;KAGtC,MAAM,CAAC,YAAY,GAAG,EAAE,CAAC;KAGzB,MAAM,CAAC,gBAAgB,GAAG,KAAK,CAAC,CAAC;KAEjC,MAAM,CAAC,KAAK,CAAC;AACjB,EAAC;AAZe,oBAAW,cAY1B;AAID,iBAAwB,MAAsB,EAAE,QAAmB;KAC/D,IAAI,eAAe,GAAG,MAAM,CAAC,QAAQ,CAAC;KAEtC,EAAE,EAAE,eAAgB,CAAC,EAAC;SAElB,OAAO,MAAM,CAAC,QAAQ,EAAE,CAAC;aACrB,IAAM,OAAO,GAAG,MAAM,CAAC,QAAQ,CAAC;aAChC,MAAM,CAAC,QAAQ,GAAG,IAAI,CAAC;aACvB,QAAQ,CAAE,MAAM,EAAE,MAAM,CAAC,gBAAgB,EAAE,MAAM,EAAE,OAAO,CAAE,CAAC;SACjE,CAAC;SAGD,MAAM,CAAC,YAAY,GAAG,KAAK,CAAC;SAGpB,0BAAM,CAAY;SAC1B,EAAE,EAAE,MAAM,IAAI,CAAC,QAAS,CAAC,EAAC;aACtB,MAAM,CAAC,iBAAiB,CAAE,MAAM,EAAE,eAAe,CAAE,CAAC;SACxD,CAAC;KACL,CAAC;KACD,IAAI,EAAC;SAED,MAAM,CAAC,QAAQ,GAAG,IAAI,CAAC;SACvB,MAAM,CAAC,YAAY,GAAG,KAAK,CAAC;KAChC,CAAC;AACL,EAAC;AAzBe,eAAM,SAyBrB;AAOD,iBAAwB,KAAa,EAAE,KAAqB,EAAE,GAAa;KACvE,EAAE,EAAE,CAAC,KAAK,CAAC,MAAO,CAAC,EAAC;SAChB,KAAK,CAAC,MAAM,GAAG,KAAK,CAAC;SACrB,KAAK,CAAC,SAAS,GAAG,GAAG,CAAC;KAC1B,CAAC;AACL,EAAC;AALe,eAAM,SAKrB;AAGD,eAAsB,KAAa,EAAE,KAAqB;KACtD,EAAE,EAAE,KAAK,KAAK,KAAK,CAAC,MAAO,CAAC,EAAC;SACzB,KAAK,CAAC,MAAM,GAAG,KAAK,CAAC,CAAC;SACtB,KAAK,CAAC,SAAS,GAAG,KAAK,CAAC,CAAC;KAC7B,CAAC;AACL,EAAC;AALe,aAAI,OAKnB;;;;;;;;AC1TD;KAQI,yBAAa,GAAiB;SAC1B,IAAI,CAAC,MAAM,GAAG,GAAG,CAAC,eAAe,CAAE,IAAI,CAAC,MAAM,GAAG,EAAE,CAAE,CAAC;SAEtD,EAAE,EAAE,IAAI,CAAC,KAAK,GAAG,GAAG,CAAC,QAAQ,CAAE,GAAG,CAAG,CAAC,EAAC;aACnC,IAAI,CAAC,MAAM,EAAE,CAAC;SAClB,CAAC;KACL,CAAC;KAED,8BAAI,GAAJ,UAAM,QAAgD;SAClD,aAA8B,EAAtB,gBAAK,EAAE,kBAAM,CAAU;SAE/B,EAAE,EAAE,KAAM,CAAC;aAAC,QAAQ,CAAE,KAAK,EAAE,IAAI,CAAE,CAAC;SAEpC,GAAG,EAAE,IAAM,GAAG,IAAI,MAAO,CAAC,EAAC;aACvB,QAAQ,CAAE,MAAM,CAAE,GAAG,CAAE,EAAE,GAAG,CAAE,CAAC;SACnC,CAAC;KACL,CAAC;KAED,mCAAS,GAAT,UAAW,QAAsE,EAAE,MAAoB;SACnG,IAAI,CAAC,IAAI,CAAE,UAAE,KAAK,EAAE,GAAG;aACnB,EAAE,EAAE,KAAK,YAAY,eAAgB,CAAC,EAAC;iBACnC,KAAK,CAAC,SAAS,CAAE,QAAQ,EAAE,MAAM,CAAC,GAAG,CAAE,GAAG,CAAE,CAAE,CAAC;aACnD,CAAC;aACD,IAAI,EAAC;iBACD,QAAQ,CAAE,KAAK,EAAE,GAAG,EAAE,MAAM,CAAE,CAAC;aACnC,CAAC;SACL,CAAC,CAAC,CAAC;KACP,CAAC;KACL,sBAAC;AAAD,EAAC;AApCY,wBAAe,kBAoC3B;;;;;;;;AC/CD,0CAAiC,EAAgB,CAAC;AAElD,sCAAgE,CAChE,CAAC,CADuF;AACxF,yCAAsC,EAEtC,CAAC,CAFoD;AAErD,4CAAkC,CAElC,CAAC,CAF+D;AAyBhE,kBAAyB,QAAiC,EAAE,cAA+B;KACvF,IAAM,YAAY,GAAG,oBAAS,CAAkB,EAAE,EAAE,QAAQ,EAAE,eAAe,CAAE,EACzE,aAAa,GAAG,mBAAQ,CAAkB,EAAE,EAAE,YAAY,EAAE,cAAc,CAAE,EAC5E,UAAU,GAAG,eAAe,CAAE,aAAa,CAAE,EAC7C,KAAK,GAAkB;SACrB,UAAU,EAAG,UAAU;SACvB,WAAW,EAAG,IAAI,UAAU,CAAE,aAAa,CAAE;SAC7C,UAAU,EAAG,oBAAS,CAAyB,EAAE,EAAE,YAAY,EAAE,WAAC,IAAI,QAAC,CAAC,wBAAwB,EAAE,EAA5B,CAA4B,CAAE;SACpG,QAAQ,EAAG,cAAc,CAAE,aAAa,CAAE;SAC1C,OAAO,EAAG,YAAY,CAAE,aAAa,CAAE;SACvC,YAAY,EAAG,cAAc,CAAE,YAAY,CAAE;SAC7C,KAAK,EAAG,MAAM,CAAC,IAAI,CAAE,aAAa,CAAE;MACtC,CAAC;KAEP,IAAM,MAAM,GAAG,WAAW,CAAE,YAAY,EAAE,aAAa,CAAE,CAAC;KAC1D,EAAE,EAAE,MAAO,CAAC,EAAC;SACT,KAAK,CAAC,MAAM,GAAG,MAAM,CAAC;KAC1B,CAAC;KAGD,EAAE,EAAE,CAAC,cAAG,CAAC,KAAM,CAAC,EAAC;SACb,KAAK,CAAC,WAAW,GAAG,aAAa,CAAE,aAAa,CAAE,CAAC;KACvD,CAAC;KAED,MAAM,CAAC,KAAK,CAAC;AACjB,EAAC;AAzBe,gBAAO,UAyBtB;AAGD,0BAA0B,IAAI,EAAE,IAAI;KAChC,MAAM,CAAC,+BAAgB,CAAC,MAAM,CAAE,mCAAqB,CAAE,IAAI,CAAE,EAAE,IAAI,CAAE,CAAC;AAC1E,EAAC;AAGD,yBAAyB,SAA0B;KAC/C,IAAI,MAAiB,CAAC;KAEtB,GAAG,EAAE,IAAI,GAAG,IAAI,SAAU,CAAC,EAAC;SACxB,IAAM,SAAS,GAAG,SAAS,CAAE,GAAG,CAAE,EAC5B,uCAAS,CAAuB;SAEtC,EAAE,EAAE,SAAU,CAAC,EAAC;aACZ,MAAM,IAAI,CAAE,MAAM,GAAG,IAAI,mBAAQ,EAAE,CAAE,CAAC;aAEtC,MAAM,CAAC,QAAQ,CAAE,SAAS,GAAG,GAAG,EAC5B,OAAO,SAAS,KAAK,QAAQ;iBACzB,oBAAoB,CAAE,SAAS,EAAE,GAAG,CAAE;iBACtC,WAAW,CAAE,SAAS,EAAE,GAAG,CAAE,CAAE,CAAC;SAC5C,CAAC;KACL,CAAC;KAED,MAAM,CAAC,MAAM,CAAC;AAClB,EAAC;AAED,sBAAsB,OAAO,EAAE,GAAG;KAC9B,MAAM,CAAC,UAAU,MAAM,EAAE,KAAK;SAC1B,OAAO,CAAC,IAAI,CAAE,MAAM,EAAE,KAAK,EAAE,GAAG,CAAE,CAAC;KACvC,CAAC;AACL,EAAC;AAED,+BAA+B,GAAY,EAAE,GAAY;KACrD,0DAAmE,EAA3D,gBAAK,EAAE,oBAAO,EAAE,cAAI,CAAwC;KACpE,MAAM,CAAC,KAAK;SACR,UAAU,MAAM,EAAE,KAAK;aACnB,MAAM,CAAE,IAAI,CAAE,CAAE,KAAK,EAAE,GAAG,CAAE,CAAC;SACjC,CAAC;SACD,UAAU,MAAM,EAAE,KAAK;aACnB,OAAO,CAAE,MAAM,CAAE,CAAE,IAAI,CAAE,CAAE,KAAK,EAAE,GAAG,CAAE,CAAC;SAC5C,CAAC;AACT,EAAC;AAED,wBAA+B,SAA0B;KACrD,IAAI,UAAU,GAAG,CAAE,6BAA6B,CAAE,CAAC;KAEnD,GAAG,EAAE,IAAI,MAAI,IAAI,SAAU,CAAC,EAAC;SACzB,UAAU,CAAC,IAAI,CAAE,aAAW,MAAI,iCAA2B,MAAI,eAAS,MAAI,QAAK,CAAE,CAAC;KACxF,CAAC;KAED,MAAM,CAAW,IAAI,QAAQ,CAAE,GAAG,EAAE,GAAG,EAAE,UAAU,CAAC,IAAI,CAAE,EAAE,CAAE,CAAE,CAAC;AACrE,EAAC;AARe,sBAAa,gBAQ5B;AAED,0BAAiC,SAA0B;KACvD,IAAI,UAAU,GAAG,EAAE,CAAC;KAEpB,GAAG,EAAE,IAAI,MAAI,IAAI,SAAU,CAAC,EAAC;SACzB,UAAU,CAAC,IAAI,CAAE,UAAQ,MAAI,aAAQ,MAAI,MAAG,CAAE,CAAC;KACnD,CAAC;KAED,IAAI,SAAS,GAAG,IAAI,QAAQ,CAAE,GAAG,EAAE,UAAU,CAAC,IAAI,CAAE,EAAE,CAAE,CAAE,CAAC;KAC3D,SAAS,CAAC,SAAS,GAAG,MAAM,CAAC,SAAS,CAAC;KACvC,MAAM,CAAuB,SAAS,CAAC;AAC3C,EAAC;AAVe,wBAAe,kBAU9B;AAGD,yBAAyB,SAA0B;KAC/C,IAAI,QAAQ,GAAG,CAAC,QAAQ,CAAC,EAAE,QAAQ,GAAG,EAAE,CAAC;KAEzC,oBAAqB,IAAI,EAAE,IAAI;SAC3B,QAAQ,CAAC,IAAI,CAAE,UAAQ,IAAI,mBAAc,IAAI,wBAAmB,IAAI,UAAO,CAAE,CAAC;SAC9E,QAAQ,CAAC,IAAI,CAAE,UAAQ,IAAI,WAAM,IAAI,MAAG,CAAE,CAAC;KAC/C,CAAC;KAGD,GAAG,EAAE,IAAI,MAAI,IAAI,SAAU,CAAC,EAAC;SACzB,IAAM,QAAQ,GAAG,SAAS,CAAE,MAAI,CAAE,EAC1B,sBAAK,EAAE,oBAAI,CAAc;SAEjC,EAAE,EAAE,KAAK,KAAK,KAAK,CAAC,IAAI,IAAK,CAAC,EAAC;aAE3B,UAAU,CAAE,MAAI,EAAE,OAAK,MAAI,cAAW,CAAE,CAAC;SAC7C,CAAC;SACD,IAAI,EAAC;aAED,EAAE,EAAE,sBAAW,CAAE,KAAK,CAAG,CAAC,EAAC;iBAEvB,UAAU,CAAE,MAAI,EAAE,IAAI,CAAC,SAAS,CAAE,KAAK,CAAE,CAAE,CAAC;aAChD,CAAC;aACD,IAAI,CAAC,EAAE,EAAE,KAAK,KAAK,KAAK,CAAE,CAAC,EAAC;iBAExB,UAAU,CAAE,MAAI,EAAE,QAAQ,CAAE,CAAC;aACjC,CAAC;aACD,IAAI,EAAC;iBAED,UAAU,CAAE,MAAI,EAAE,OAAK,MAAI,WAAQ,CAAE,CAAC;aAC1C,CAAC;SACL,CAAC;KACL,CAAC;KAED,IAAM,cAAc,GAAS,IAAI,QAAQ,CAAE,GAAG,EAAE,QAAQ,CAAC,IAAI,CAAE,EAAE,CAAE,CAAE,EAC/D,cAAc,GAAS,IAAI,QAAQ,CAAE,GAAG,EAAE,GAAG,EAAE,QAAQ,CAAC,IAAI,CAAE,EAAE,CAAE,CAAE,CAAC;KAE3E,cAAc,CAAC,SAAS,GAAG,cAAc,CAAC,SAAS,GAAG,MAAM,CAAC,SAAS,CAAC;KAIvE,MAAM,CAAC,UAAU,KAAW;SACxB,MAAM,CAAC,KAAK,GAAG,IAAI,cAAc,CAAE,KAAK,EAAE,IAAI,CAAC,WAAW,CAAE,GAAG,IAAI,cAAc,CAAE,IAAI,CAAC,WAAW,CAAE,CAAC;KAC1G,CAAC;AACL,EAAC;AAED,sBAAsB,YAA6B,EAAE,SAA0B;KAC3E,IAAI,UAAU,GAAG,CAAE,yBAAyB,CAAE,EAC1C,MAAM,GAAO,KAAK,CAAC;KAEvB,GAAG,EAAE,IAAI,MAAI,IAAI,YAAa,CAAC,EAAC;SAC5B,IAAM,KAAK,GAAG,SAAS,CAAE,MAAI,CAAE,CAAC;SAGhC,EAAE,EAAE,KAAK,IAAI,KAAK,CAAC,KAAM,CAAC;aAAC,MAAM,GAAG,IAAI,CAAC;SAGzC,EAAE,EAAE,YAAY,CAAE,MAAI,CAAE,CAAC,KAAM,CAAC,EAAC;aAC7B,IAAM,CAAC,GAAG,OAAK,MAAI,0BAAqB,MAAI,aAAQ,MAAI,6BAAwB,MAAI,YAAM,MAAI,WAAO,CAAC;aACtG,UAAU,CAAC,IAAI,CAAE,CAAC,CAAE,CAAC;SACzB,CAAC;KACL,CAAC;KAED,EAAE,EAAE,MAAO,CAAC,EAAC;SACT,UAAU,CAAC,IAAI,CAAE,WAAW,CAAE,CAAC;SAC/B,MAAM,CAAO,IAAI,QAAQ,CAAE,GAAG,EAAE,UAAU,CAAC,IAAI,CAAE,EAAE,CAAE,CAAE,CAAC;KAC5D,CAAC;AACJ,EAAC;AAEF,uBAAuB,SAA0B;KAC7C,IAAI,UAAU,GAAG,CAAE,qDAAqD,CAAE,CAAC;KAE3E,GAAG,EAAE,IAAI,GAAG,IAAI,SAAU,CAAC,EAAC;SACxB,IAAM,MAAM,GAAG,SAAS,CAAE,GAAG,CAAE,CAAC,MAAM,CAAC;SAEvC,EAAE,EAAE,MAAO,CAAC,EAAC;aACT,UAAU,CAAC,IAAI,CAAE,UAAQ,GAAG,aAAQ,GAAG,8BAA0B,GAAG,WAAO,GAAG,SAAM,CAAE,CAAC;SAC3F,CAAC;KACL,CAAC;KAED,UAAU,CAAC,IAAI,CAAE,cAAc,CAAE,CAAC;KAElC,MAAM,CAAO,IAAI,QAAQ,CAAE,UAAU,CAAC,IAAI,CAAE,EAAE,CAAE,CAAE,CAAC;AACvD,EAAC;;;;;;;;AC9MD,4CAA+F,CAC/F,CAAC,CADgH;AACjH,sCAA8C,CAE9C,CAAC,CAFqE;AActE;KAuGI,0BAAoB,IAAa,EAAS,OAA6B;SAAnD,SAAI,GAAJ,IAAI,CAAS;SAAS,YAAO,GAAP,OAAO,CAAsB;SAyCvE,YAAO,GAAoC,IAAI;SAvCjC,yBAAK,EAAE,mBAAI,EAAE,qBAAK,EAAE,uBAAM,EAC1B,qBAAa,EAAb,kCAAa,EACb,uBAAe,EAAf,oCAAe,EACf,2BAAmB,EAAnB,wCAAmB,CACX;SAElB,IAAI,CAAC,KAAK,GAAG,KAAK,CAAC;SACnB,IAAI,CAAC,IAAI,GAAI,IAAI,CAAC;SAElB,IAAI,CAAC,KAAK,GAAI,KAAK,CAAC;SACpB,IAAI,CAAC,MAAM,GAAG,MAAM,KAAK,KAAK,CAAC,GAAG,IAAI,CAAC,MAAM,GAAG,MAAM,CAAC;SAOvD,UAAU,CAAC,OAAO,CAAE,IAAI,CAAC,OAAO,CAAE,CAAC;SAGnC,EAAE,EAAE,IAAI,CAAC,GAAI,CAAC;aAAC,QAAQ,CAAC,OAAO,CAAE,IAAI,CAAC,GAAG,CAAE,CAAC;SAG5C,IAAI,CAAC,UAAU,CAAC,KAAK,CAAE,IAAI,EAAE,SAAS,CAAE,CAAC;SAGzC,EAAE,EAAE,QAAQ,CAAC,MAAO,CAAC,EAAC;aAClB,IAAI,CAAC,OAAO,GAAG,QAAQ,CAAC,MAAM,CAAE,aAAa,CAAE,CAAC;SACpD,CAAC;SAED,EAAE,EAAE,UAAU,CAAC,MAAO,CAAC,EAAC;aACpB,IAAI,CAAC,SAAS,GAAG,UAAU,CAAC,MAAM,CAAE,eAAe,CAAE,CAAC;SAC1D,CAAC;SAED,EAAE,EAAE,cAAc,CAAC,MAAO,CAAC,EAAC;aACxB,IAAI,CAAC,YAAY,GAAG,cAAc,CAAC,MAAM,CAAE,mBAAmB,CAAE,CAAC;SACrE,CAAC;KACL,CAAC;KA5IM,uBAAM,GAAb,UAAe,OAA6B,EAAE,IAAa;SACvD,IAAM,IAAI,GAAG,OAAO,CAAC,IAAI,EACnB,aAAa,GAAG,IAAI,GAAG,IAAI,CAAC,UAAU,GAAG,gBAAgB,CAAC;SAEhE,MAAM,CAAC,IAAI,aAAa,CAAE,IAAI,EAAE,OAAO,CAAE,CAAC;KAC9C,CAAC;KAQA,uCAAY,GAAZ,UAAc,IAAI,EAAE,IAAI;SACpB,MAAM,CAAC,KAAK,CAAC;KACjB,CAAC;KAKF,oCAAS,GAAT,UAAW,KAAK,EAAE,OAAO,EAAE,IAAI,EAAE,KAAK,IAAK,MAAM,CAAC,KAAK,CAAC,CAAC,CAAC;KAG1D,kCAAO,GAAP,UAAS,KAAK,EAAE,OAAO,EAAE,KAAK,IAAK,MAAM,CAAC,KAAK,CAAC,CAAC,CAAC;KAKlD,oCAAS,GAAT,UAAW,CAAC,EAAE,CAAC;SACX,MAAM,CAAC,mBAAQ,CAAE,CAAC,EAAE,CAAC,CAAE,CAAC;KAC5B,CAAC;KAKD,uCAAY,GAAZ,UAAc,IAAI,EAAE,IAAI,EAAE,KAAK,IAAI,CAAC;KAOpC,iCAAM,GAAN,cAAW,MAAM,CAAC,IAAW,IAAI,CAAC,IAAM,EAAE,CAAC,CAAC,CAAC;KAI7C,gCAAK,GAAL,UAAO,KAAK,EAAE,OAAkC;SAAlC,uBAAkC,GAAlC,YAAkC;SAC5C,EAAE,EAAE,KAAK,IAAI,OAAO,KAAK,KAAK,QAAS,CAAC,CAAC,CAAC;aAEtC,EAAE,EAAE,KAAK,CAAC,KAAM,CAAC,CAAC,CAAC;iBACf,MAAM,CAAC,KAAK,CAAC,KAAK,CAAE,OAAO,CAAE,CAAC;aAClC,CAAC;aAED,EAAE,EAAE,OAAO,CAAC,IAAK,CAAC,EAAC;iBACf,IAAM,KAAK,GAAG,MAAM,CAAC,cAAc,CAAE,KAAK,CAAE,CAAC;iBAG7C,EAAE,EAAE,KAAK,KAAK,MAAM,CAAC,SAAS,IAAI,KAAK,KAAK,KAAK,CAAC,SAAU,CAAC,EAAC;qBAC1D,MAAM,CAAC,IAAI,CAAC,KAAK,CAAE,IAAI,CAAC,SAAS,CAAE,KAAK,CAAE,CAAE,CAAC;iBACjD,CAAC;aACL,CAAC;SACL,CAAC;SAED,MAAM,CAAC,KAAK,CAAC;KACjB,CAAC;KAED,mCAAQ,GAAR,UAAU,MAAe,EAAE,KAAW,EAAE,GAAY,IAAG,CAAC;KAExD,iCAAM,GAAN,UAAQ,KAAK,EAAE,GAAG;SACd,MAAM,CAAC,KAAK,IAAI,KAAK,CAAC,MAAM,GAAG,KAAK,CAAC,MAAM,EAAE,GAAG,KAAK,CAAC;KAC1D,CAAC;KAED,mDAAwB,GAAxB;SACI,aAA8B,EAAtB,cAAI,EAAE,oBAAO,CAAU;SAE/B,EAAE,EAAE,IAAI,KAAK,IAAK,CAAC,EAAC;aAChB,MAAM,CAAC;iBAEH,GAAG,YAAE,KAAK;qBACN,6BAAY,CAAO,IAAI,EAAE,IAAI,EAAE,KAAK,CAAE,CAAC;iBAC3C,CAAC;iBAGD,GAAG,EAAG,OAAO;qBACP;yBACI,MAAM,CAAC,OAAO,CAAC,IAAI,CAAE,IAAI,EAAE,IAAI,CAAC,UAAU,CAAE,IAAI,CAAE,EAAE,IAAI,CAAE,CAAC;qBAC/D,CAAC;qBACD;yBACI,MAAM,CAAC,IAAI,CAAC,UAAU,CAAE,IAAI,CAAE,CAAC;qBACnC,CAAC;cACV;SACL,CAAC;KACL,CAAC;KAOD,qCAAU,GAAV,UAAY,IAAa,EAAE,OAAO,IAAG,CAAC;KA6C1C,uBAAC;AAAD,EAAC;AAlJY,yBAAgB,mBAkJ5B;AAED,wBAAM,CAAC,SAAS,CAAC,WAAW,GAAG,EAAE,EAAE,EAAG,gBAAgB,CAAC,MAAM,CAAC,EAAE,KAAK,EAAG,KAAK,CAAC,EAAE,EAAE,IAAI,CAAE,EAAC,CAAC;AAC1F,wBAAM,CAAC,SAAS,CAAC,QAAQ,GAAG,UAAU,KAA6B;KAA7B,qBAA6B,GAA7B,UAA6B;KAAI,MAAM,CAAC,EAAE,EAAE,EAAG,KAAK,CAAC,EAAE,EAAE;AAAC,EAAC,CAAC;AAElG,8BAA8B,WAA2B,EAAE,WAA2B;KAClF,MAAM,CAAC,UAAU,IAAI,EAAE,IAAI,EAAE,KAAK;SAC9B,WAAW,CAAC,IAAI,CAAE,IAAI,EAAE,IAAI,EAAE,IAAI,EAAE,KAAK,CAAE,CAAC;SAC5C,WAAW,CAAC,IAAI,CAAE,IAAI,EAAE,IAAI,EAAE,IAAI,EAAE,KAAK,CAAE,CAAC;KAChD,CAAC;AACL,EAAC;AAED,wBAAwB,QAAkB,EAAE,QAAkB;KAC1D,MAAM,CAAC,UAAU,KAAK,EAAE,IAAI;SACxB,MAAM,CAAC,QAAQ,CAAC,IAAI,CAAE,QAAQ,CAAC,IAAI,CAAE,KAAK,EAAE,IAAI,CAAE,EAAE,IAAI,CAAE,CAAC;KAC/D,CAAC;AACL,EAAC;AAED,0BAA0B,aAAyB,EAAE,aAAyB;KAC1E,MAAM,CAAC,UAAU,KAAK,EAAE,OAAO,EAAE,IAAI,EAAE,KAAK;SACxC,MAAM,CAAC,aAAa,CAAC,IAAI,CAAE,IAAI,EAAE,aAAa,CAAC,IAAI,CAAE,IAAI,EAAE,KAAK,EAAE,OAAO,EAAE,IAAI,EAAE,KAAK,CAAE,EAAE,OAAO,EAAE,IAAI,EAAE,KAAK,CAAE,CAAC;KACrH,CAAC;AACL,EAAC;;;;;;;;AChLD,sCAAgE,CAEhE,CAAC,CAFuF;AAExF;KAGI,gCAAa,OAAkC;SAAlC,uBAAkC,GAAlC,YAAkC;SAC3C,IAAI,CAAC,OAAO,GAAG,EAAE,QAAQ,EAAG,EAAE,EAAE,UAAU,EAAG,EAAE,EAAE,cAAc,EAAG,EAAE,EAAC,CAAC;SACtE,iBAAM,CAAE,IAAI,CAAC,OAAO,EAAE,OAAO,CAAE,CAAC;KACpC,CAAC;KAED,mDAAkB,GAAlB,UAAoB,MAAM;SAEtB,MAAM,CAAC,IAAI,CAAC;KAChB,CAAC;KAED,wCAAO,GAAP,UAAS,GAAwD;SAC7D,IAAI,CAAC,OAAO,CAAC,SAAS,GAAG,GAAG,CAAC;SAC7B,MAAM,CAAC,IAAI,CAAC;KAChB,CAAC;KAED,sCAAK,GAAL,UAAO,GAAG;SACN,IAAI,CAAC,OAAO,CAAC,KAAK,GAAG,GAAG,CAAC;SACzB,MAAM,CAAC,IAAI,CAAC;KAChB,CAAC;KAED,uCAAM,GAAN,UAAQ,GAAG;SACP,IAAI,CAAC,OAAO,CAAC,MAAM,GAAG,GAAG,CAAC;SAC1B,MAAM,CAAC,IAAI,CAAC;KAChB,CAAC;KAGD,oCAAG,GAAH,UAAK,GAAG;SACJ,IAAI,CAAC,OAAO,CAAC,QAAQ,CAAC,IAAI,CAAE,GAAG,CAAE,CAAC;SAElC,MAAM,CAAC,IAAI,CAAC;KAChB,CAAC;KAGD,oCAAG,GAAH,UAAK,GAAG;SACJ,IAAI,CAAC,OAAO,CAAC,UAAU,CAAC,IAAI,CAAE,UAAU,IAAI,EAAE,OAAO,EAAE,IAAI,EAAE,KAAK;aAC9D,EAAE,EAAE,IAAI,CAAC,SAAS,CAAE,IAAI,EAAE,IAAI,CAAG,CAAC,CAAC,CAAC;iBAChC,IAAI,OAAO,GAAG,GAAG,CAAC,IAAI,CAAE,KAAK,EAAE,IAAI,EAAE,IAAI,CAAE,CAAC;iBAC5C,MAAM,CAAC,OAAO,KAAK,KAAK,CAAC,GAAG,IAAI,GAAG,OAAO,CAAC;aAC/C,CAAC;aAED,MAAM,CAAC,IAAI,CAAC;SAChB,CAAC,CAAE,CAAC;SAEJ,MAAM,CAAC,IAAI,CAAC;KAChB,CAAC;KAGD,uCAAM,GAAN,UAAQ,GAAsB;SAC1B,IAAM,QAAQ,GAAG,IAAI,mBAAQ,CAAE,GAAG,CAAE,CAAC;SAErC,IAAI,CAAC,OAAO,CAAC,cAAc,CAAC,IAAI,CAAE,UAAU,IAAI,EAAE,IAAI,EAAE,MAAe;aAC/D,IAAI,IAAI,QAAQ,CAAC,WAAW,CAAE,MAAM,EAAE,IAAI,CAAE,CAAC;aAE7C,IAAI,IAAI,QAAQ,CAAC,SAAS,CAAE,MAAM,EAAE,IAAI,CAAE,CAAC;SAC/C,CAAC,CAAC,CAAC;SAEP,MAAM,CAAC,IAAI,CAAC;KAChB,CAAC;KAED,sBAAI,uCAAG;cAAP,cAAmB,MAAM,CAAC,IAAI,CAAC,CAAC,CAAC;;;QAAA;KAQjC,sCAAK,GAAL,UAAO,CAAC;SACJ,IAAI,CAAC,OAAO,CAAC,KAAK,GAAG,CAAC,CAAC;SACvB,MAAM,CAAC,IAAI,CAAC;KAChB,CAAC;KACL,6BAAC;AAAD,EAAC;AA1EY,+BAAsB,yBA0ElC;AAUD,SAAQ,CAAC,SAAS,CAAC,KAAK,GAAG,UAAU,CAAC;KAClC,MAAM,CAAC,IAAI,sBAAsB,CAAE,EAAE,IAAI,EAAG,IAAI,EAAE,KAAK,EAAG,CAAC,EAAE,CAAE,CAAC;AACpE,EAAC,CAAC;AASF,OAAM,CAAC,cAAc,CAAE,QAAQ,CAAC,SAAS,EAAE,KAAK,EAAE;KAC9C,GAAG;SAEC,MAAM,CAAC,IAAI,CAAC,IAAI,IAAI,IAAI,sBAAsB,CAAE,EAAE,IAAI,EAAG,IAAI,EAAE,CAAE,CAAC;KACtE,CAAC;KAED,GAAG,YAAE,KAAK,IAAK,IAAI,CAAC,IAAI,GAAG,KAAK,CAAC,CAAC,CAAC;EACtC,CAAE,CAAC;AAEJ,gCAAuC,IAAU;KAC7C,EAAE,EAAE,OAAO,IAAI,KAAK,UAAW,CAAC,CAAC,CAAC;SAC9B,MAAM,CAAC,EAAE,IAAI,EAAS,IAAI,EAAE,CAAC;KACjC,CAAC;KAED,EAAE,EAAE,IAAI,IAAI,IAAI,YAAY,sBAAuB,CAAC,CAAC,CAAC;SAClD,MAAM,CAAC,IAAI,CAAC,OAAO,CAAC;KACxB,CAAC;KAED,MAAM,CAAC;SACH,IAAI,EAAG,SAAS,CAAE,IAAI,CAAE;SACxB,KAAK,EAAG,IAAI;MACf;AACL,EAAC;AAbe,8BAAqB,wBAapC;AAED,oBAAoB,KAAU;KAC1B,MAAM,EAAE,OAAO,KAAM,CAAC,CAAC,CAAC;SACpB,KAAK,QAAQ;aACT,MAAM,CAAC,MAAM,CAAC;SAClB,KAAK,QAAQ;aACT,MAAM,CAAC,MAAM,CAAC;SAClB,KAAK,SAAS;aACV,MAAM,CAAC,OAAO,CAAC;SACnB,KAAK,WAAW;aACZ,MAAM,CAAC,KAAK,CAAC,CAAC;SAClB,KAAK,QAAQ;aACT,MAAM,CAAC,KAAK,GAAS,KAAK,CAAC,WAAW,GAAG,MAAM,CAAC;KACxD,CAAC;AACL,EAAC;;;;;;;;;;;;;AC7ID,4CAAuB,CACvB,CAAC,CADwC;AACzC,0CAAiC,EACjC,CAAC,CADgD;AACjD,6CAAiG,CAEjG,CAAC,CAFoH;AAErH;KAAuC,qCAAgB;KAAvD;SAAuC,8BAAgB;KAqBvD,CAAC;KAlBG,wCAAY,GAAZ,UAAc,IAAoB,EAAE,IAAU;SAE1C,MAAM,CAAC,IAAI,IAAI,IAAI,IAAI,CAAC,CAAE,IAAI,YAAY,IAAI,CAAC,IAAI,CAAE,CAAC;KAC1D,CAAC;KAED,mCAAO,GAAP,UAAS,KAAW,EAAE,OAA4B,EAAE,MAAe;SAE/D,MAAM,CAAC,KAAK,IAAI,IAAI,IAAI,KAAK,YAAY,IAAI,CAAC,IAAI,GAAG,KAAK,GAAG,IAAI,CAAC,IAAI,CAAC,MAAM,CAAE,KAAK,EAAE,OAAO,EAAE,MAAM,CAAE,CAAC;KAC5G,CAAC;KAED,kCAAM,GAAN;SACI,MAAM,CAAC,IAAU,IAAI,CAAC,IAAK,EAAE,CAAC;KAClC,CAAC;KAED,wCAAY,GAAZ,UAAc,IAAoB,EAAE,IAAoB,EAAE,MAAe;SACrE,IAAI,IAAI,sBAAI,CAAE,MAAM,EAAE,IAAI,CAAE,CAAC;SAC7B,IAAI,IAAI,wBAAM,CAAE,MAAM,EAAE,IAAI,EAAE,IAAI,CAAC,IAAI,CAAE,CAAC;KAC9C,CAAC;KACL,wBAAC;AAAD,EAAC,CArBsC,+BAAgB,GAqBtD;AArBY,0BAAiB,oBAqB7B;AAED,wBAAM,CAAC,UAAU,GAAG,iBAAiB,CAAC;;;;;;;;;;;;;AC3BtC,0CAAiC,EACjC,CAAC,CADgD;AACjD,sCAA0B,CAG1B,CAAC,CAHiD;AAGlD;KAA8B,mCAAgB;KAA9C;SAA8B,8BAAgB;KAW9C,CAAC;KARG,iCAAO,GAAP,UAAS,KAAK;SACV,MAAM,CAAC,KAAK,IAAI,IAAI,IAAI,KAAK,YAAY,IAAI,CAAC,IAAI,GAAG,KAAK,GAAG,IAAI,IAAI,CAAC,IAAI,CAAE,KAAK,CAAE,CAAC;KACxF,CAAC;KAED,+BAAK,GAAL,UAAO,KAAK,EAAE,OAAO;SAEjB,MAAM,CAAC,KAAK,CAAC,KAAK,GAAG,KAAK,CAAC,KAAK,CAAE,KAAK,EAAE,OAAO,CAAE,GAAG,IAAI,CAAC,OAAO,CAAE,IAAI,CAAC,KAAK,CAAE,IAAI,CAAC,SAAS,CAAE,KAAK,CAAE,CAAE,CAAE,CAAC;KAC/G,CAAC;KACL,sBAAC;AAAD,EAAC,CAX6B,+BAAgB,GAW7C;AAED,SAAQ,CAAC,SAAS,CAAC,UAAU,GAAG,eAAe,CAAC;AAGhD;KAAuB,4BAAgB;KAAvC;SAAuB,8BAAgB;KAevC,CAAC;KAdG,0BAAO,GAAP,UAAS,KAAK;SACV,MAAM,CAAC,KAAK,IAAI,IAAI,IAAI,KAAK,YAAY,IAAI,GAAG,KAAK;aAC9C,IAAI,IAAI,CAAE,OAAO,KAAK,KAAK,QAAQ,GAAG,oBAAS,CAAE,KAAK,CAAE,GAAG,KAAK,CAAE,CAAC;KAC9E,CAAC;KAED,2BAAQ,GAAR,UAAU,KAAK,EAAE,KAAK,EAAE,IAAI;SACxB,EAAE,EAAE,KAAK,CAAE,CAAC,KAAK,CAAG,CAAC;aAAC,MAAM,CAAC,IAAI,GAAG,kBAAkB,CAAC;KAC3D,CAAC;KAED,yBAAM,GAAN,UAAQ,KAAK,IAAK,MAAM,CAAC,KAAK,IAAI,KAAK,CAAC,MAAM,EAAE,CAAC,CAAC,CAAC;KAEnD,4BAAS,GAAT,UAAW,CAAC,EAAE,CAAC,IAAK,MAAM,CAAC,CAAE,CAAC,IAAI,CAAC,CAAC,CAAE,KAAK,CAAE,CAAC,IAAI,CAAC,CAAC,CAAE,CAAC,CAAC,CAAC;KAEzD,wBAAK,GAAL,UAAO,KAAK,IAAK,MAAM,CAAC,KAAK,IAAI,IAAI,IAAI,CAAE,CAAC,KAAK,CAAE,CAAC,CAAC,CAAC;KAC1D,eAAC;AAAD,EAAC,CAfsB,+BAAgB,GAetC;AAED,KAAI,CAAC,UAAU,GAAG,QAAQ,CAAC;AAG3B;KAAmC,iCAAgB;KAAnD;SAAmC,8BAAgB;KAYnD,CAAC;KATG,8BAAM,GAAN,cAAW,MAAM,CAAC,IAAI,CAAC,IAAI,EAAE,CAAC,CAAC,CAAC;KAEhC,8BAAM,GAAN,UAAQ,KAAK,IAAK,MAAM,CAAC,KAAK,CAAC,CAAC,CAAC;KAEjC,+BAAO,GAAP,UAAS,KAAK,IAAK,MAAM,CAAC,KAAK,IAAI,IAAI,GAAG,KAAK,GAAG,IAAI,CAAC,IAAI,CAAE,KAAK,CAAE,CAAC,CAAC,CAAC;KAEvE,iCAAS,GAAT,UAAW,CAAC,EAAE,CAAC,IAAK,MAAM,CAAC,CAAC,KAAK,CAAC,CAAC,CAAC,CAAC;KAErC,6BAAK,GAAL,UAAO,KAAK,IAAK,MAAM,CAAC,KAAK,CAAC,CAAC,CAAC;KACpC,oBAAC;AAAD,EAAC,CAZkC,+BAAgB,GAYlD;AAZY,sBAAa,gBAYzB;AAED,QAAO,CAAC,UAAU,GAAG,MAAM,CAAC,UAAU,GAAG,aAAa,CAAC;AAGvD;KAAiC,+BAAa;KAA9C;SAAiC,8BAAa;KAS9C,CAAC;KANG,8BAAQ,GAAR,UAAU,KAAK,EAAE,KAAK,EAAE,IAAI;SAExB,EAAE,EAAE,CAAC,QAAQ,CAAE,KAAK,CAAG,CAAC,CAAC,CAAC;aACtB,MAAM,CAAC,IAAI,GAAG,sBAAsB,CAAC;SACzC,CAAC;KACL,CAAC;KACL,kBAAC;AAAD,EAAC,CATgC,aAAa,GAS7C;AATY,oBAAW,cASvB;AAED,OAAM,CAAC,UAAU,GAAG,WAAW,CAAC;AAShC,GAAE,EAAE,MAAO,CAAC,EAAC;KACT,MAAM,CAAC,OAAO,GAAG,UAAU,CAAC,IAAI,MAAM,CAAC,CAAC,GAAG,IAAI,CAAC,KAAK,CAAE,CAAC,CAAE,GAAG,CAAC,CAAC,CAAC,CAAC;KACjE,MAAM,CAAC,OAAO,CAAC,UAAU,GAAG,WAAW,CAAC;AAC5C,EAAC;AAGD;KAA+B,6BAAgB;KAA/C;SAA+B,8BAAgB;KAU/C,CAAC;KATG,0BAAM,GAAN,UAAQ,KAAK,IAAK,MAAM,CAAC,KAAK,CAAC,CAAC,CAAC;KAEjC,2BAAO,GAAP,UAAS,KAAK;SAEV,EAAE,EAAE,KAAK,IAAI,IAAI,IAAI,KAAK,CAAC,OAAO,CAAE,KAAK,CAAG,CAAC;aAAC,MAAM,CAAC,KAAK,CAAC;SAG3D,MAAM,CAAC,EAAE,CAAC;KACd,CAAC;KACL,gBAAC;AAAD,EAAC,CAV8B,+BAAgB,GAU9C;AAVY,kBAAS,YAUrB;AAED,MAAK,CAAC,UAAU,GAAG,SAAS,CAAC;;;;;;;;;;;;;;;;;;;AC/F7B,sCAA8G,CAC9G,CAAC,CADqI;AACtI,6CAAkG,CAClG,CAAC,CADqH;AACtH,sCAA0C,CAE1C,CAAC,CAF6D;AAE9D,wCAAmI,EACnI,CAAC,CADgJ;AACjJ,oCAA+B,EAC/B,CAAC,CADwC;AACzC,oCAAoD,EACpD,CAAC,CAD6D;AAC9D,uCAAsC,EAEtC,CAAC,CAFkD;AAE3C,wDAAQ,CAAmB;AAEnC,KAAI,MAAM,GAAG,CAAC,CAAC;AAEf,KAAM,aAAa,GAAG,EAAE,MAAM,EAAG,IAAI,EAAE,CAAC;AAqBxC;KAAgC,8BAAa;KAuHzC,oBAAa,OAA4B,EAAE,OAAgC;SAAhC,uBAAgC,GAAhC,YAAgC;SACvE,kBAAO,MAAM,EAAE,CAAE,CAAC;SAClB,IAAI,CAAC,MAAM,GAAG,EAAE,CAAC;SACjB,IAAI,CAAC,KAAK,GAAG,EAAE,CAAC;SAChB,IAAI,CAAC,KAAK,GAAQ,OAAO,CAAC,KAAK,IAAI,IAAI,CAAC,KAAK,CAAC;SAC9C,IAAI,CAAC,WAAW,GAAG,IAAI,CAAC,KAAK,CAAC,SAAS,CAAC,WAAW,CAAC;SACpD,EAAE,EAAE,OAAO,CAAC,UAAU,KAAK,KAAK,CAAE,CAAC,EAAC;aAChC,IAAI,CAAC,UAAU,GAAG,OAAO,CAAC,UAAU,CAAC;SACzC,CAAC;SACD,IAAI,EAAC;aAED,IAAI,CAAC,WAAW,GAAG,IAAI,CAAC,WAAW,CAAC;SACxC,CAAC;SAED,EAAE,EAAE,OAAQ,CAAC,EAAC;aACV,IAAM,QAAQ,GAAG,UAAU,CAAE,IAAI,EAAE,OAAO,EAAE,OAAO,CAAE,CAAC;aACtD,4BAAmB,CAAE,IAAI,EAAE,QAAQ,EAAE,OAAO,EAAE,IAAI,CAAE,CAAC;SACzD,CAAC;SAED,IAAI,CAAC,UAAU,CAAC,KAAK,CAAE,IAAI,EAAE,SAAS,CAAE,CAAC;SACzC,EAAE,EAAE,IAAI,CAAC,YAAa,CAAC;aAAC,IAAI,CAAC,YAAY,CAAC,SAAS,CAAE,IAAI,EAAE,IAAI,CAAE,CAAC;KACtE,CAAC;KA3IM,oBAAS,GAAhB,cAAyC,MAAM,CAAC,IAAI,CAAC,CAAC,CAAC;KAEhD,iBAAM,GAAb,UAAe,UAAkC,EAAE,WAAY;SAC3D,IAAM,IAAI,GAA0B,eAAI,CAAE,UAAU,EAAE,gBAAgB,EAAE,aAAa,CAAE,CAAC;SAExF,EAAE,EAAE,UAAU,CAAC,cAAe,CAAC,EAAC;aAC5B,IAAM,SAAS,GAAG,IAAI,mBAAQ,CAAE,IAAI,CAAC,SAAS,CAAC,eAAe,CAAE,CAAC;aACjE,SAAS,CAAC,YAAY,CAAE,UAAU,CAAC,cAAc,CAAE,CAAC;aACpD,IAAI,CAAC,eAAe,GAAG,SAAS,CAAC;SACrC,CAAC;SAED,MAAM,CAAC,+BAAa,CAAC,MAAM,CAAC,IAAI,CAAE,IAAI,EAAE,IAAI,EAAE,WAAW,CAAE,CAAC;KAChE,CAAC;KAaD,sBAAI,kCAAU;cA6Bd,cAAkB,MAAM,CAAC,IAAI,CAAC,WAAW,CAAC,CAAC,CAAC;cA7B5C,UAAgB,CAAqB;aAArC,iBA2BC;aA1BG,IAAI,OAAO,CAAC;aAEZ,MAAM,EAAE,OAAO,CAAE,CAAC,EAAC;iBACf,KAAK,QAAQ;qBACT,IAAI,CAAC,WAAW,GAAG,UAAE,CAAC,EAAE,CAAC;yBACrB,IAAM,EAAE,GAAG,CAAC,CAAU,CAAC,CAAE,EAAE,EAAE,GAAG,CAAC,CAAU,CAAC,CAAE,CAAC;yBAC/C,EAAE,EAAE,EAAE,KAAK,EAAG,CAAC;6BAAC,MAAM,CAAC,CAAC,CAAC;yBACzB,MAAM,CAAC,EAAE,GAAG,EAAE,GAAG,CAAC,CAAC,GAAG,CAAE,CAAC,CAAC;qBAC9B,CAAC;qBACD,KAAK,CAAC;iBACV,KAAK,UAAU;qBACX,EAAE,EAAE,CAAC,CAAC,MAAM,KAAK,CAAE,CAAC,EAAC;yBACjB,IAAI,CAAC,WAAW,GAAG,UAAE,CAAC,EAAE,CAAC;6BACrB,IAAM,EAAE,GAAS,CAAE,CAAC,IAAI,CAAE,KAAI,EAAE,CAAC,CAAE,EAAE,EAAE,GAAS,CAAE,CAAC,IAAI,CAAE,KAAI,EAAE,CAAC,CAAE,CAAC;6BACnE,EAAE,EAAE,EAAE,KAAK,EAAG,CAAC;iCAAC,MAAM,CAAC,CAAC,CAAC;6BACzB,MAAM,CAAC,EAAE,GAAG,EAAE,GAAG,CAAC,CAAC,GAAG,CAAE,CAAC,CAAC;yBAC9B,CAAC;qBACL,CAAC;qBACD,IAAI,EAAC;yBACD,IAAI,CAAC,WAAW,GAAG,UAAE,CAAC,EAAE,CAAC,IAAM,OAAM,CAAE,CAAC,IAAI,CAAE,KAAI,EAAE,CAAC,EAAE,CAAC,CAAE,EAA3B,CAA2B,CAAC;qBAC/D,CAAC;qBACD,KAAK,CAAC;iBAEV;qBACI,IAAI,CAAC,WAAW,GAAG,IAAI,CAAC;aAChC,CAAC;SACL,CAAC;;;QAAA;KAKD,sCAAiB,GAAjB,UAAmB,MAAe,EAAE,OAAiC;SAAjC,uBAAiC,GAAjC,YAAiC;SACjE,IAAM,MAAM,GAAG,uBAAK,CAAE,IAAI,CAAE,EACpB,8BAAW,CAAU;SAE7B,EAAE,EAAE,MAAM,CAAC,UAAU,CAAE,WAAW,CAAG,CAAC,EAAC;aAC3B,sBAAK,CAAU;aACvB,OAAO,KAAK,CAAE,MAAM,CAAC,QAAQ,CAAE,WAAW,CAAE,CAAE,CAAC;aAEvC,kBAAE,CAAY;aACtB,EAAE,IAAI,IAAI,IAAI,CAAE,KAAK,CAAE,EAAE,CAAE,GAAG,MAAM,CAAE,CAAC;SAC3C,CAAC;SAED,EAAE,EAAE,6BAAW,CAAE,IAAI,EAAE,OAAO,CAAG,CAAC,EAAC;aAE/B,QAAQ,CAAE,IAAI,EAAE,QAAQ,EAAE,MAAM,EAAE,OAAO,CAAE;SAC/C,CAAC;SAED,MAAM,IAAI,wBAAM,CAAE,IAAI,CAAE,CAAC;KAC7B,CAAC;KAED,wBAAG,GAAH,UAAK,OAAkC;SACnC,EAAE,EAAE,OAAO,IAAI,IAAK,CAAC;aAAC,MAAM,CAAC;SAE7B,EAAE,EAAE,OAAO,OAAO,KAAK,QAAS,CAAC,EAAC;aAC9B,IAAM,EAAE,GAAG,OAAO,CAAE,IAAI,CAAC,WAAW,CAAE,CAAC;aACvC,MAAM,CAAC,CAAE,EAAE,KAAK,KAAK,CAAC,IAAI,IAAI,CAAC,KAAK,CAAE,EAAE,CAAE,CAAE,IAAI,IAAI,CAAC,KAAK,CAAW,OAAQ,CAAC,GAAG,CAAE,CAAC;SACxF,CAAC;SACD,IAAI,EAAC;aACD,MAAM,CAAC,IAAI,CAAC,KAAK,CAAE,OAAO,CAAE,CAAC;SACjC,CAAC;KACL,CAAC;KAED,yBAAI,GAAJ,UAAM,QAAiD,EAAE,OAAc;SACnE,IAAM,GAAG,GAAG,SAAS,CAAC,MAAM,KAAK,CAAC,GAAG,UAAE,CAAC,EAAE,CAAC,IAAM,eAAQ,CAAC,IAAI,CAAE,OAAO,EAAE,CAAC,EAAE,CAAC,CAAE,EAA9B,CAA8B,GAAG,QAAQ,EACpF,oBAAM,CAAU;SAEtB,GAAG,EAAE,IAAI,CAAC,GAAG,CAAC,EAAE,CAAC,GAAG,MAAM,CAAC,MAAM,EAAE,CAAC,EAAE,EAAE,CAAC;aACrC,GAAG,CAAE,MAAM,CAAE,CAAC,CAAE,EAAE,CAAC,CAAE,CAAC;SAC1B,CAAC;KACL,CAAC;KAED,oCAAe,GAAf,UAAiB,MAAW;SACxB,IAAI,KAAK,GAAG,CAAC,CAAC;SAEd,IAAI,CAAC,IAAI,CAAE,gBAAM;aACb,IAAM,KAAK,GAAG,MAAM,CAAC,eAAe,CAAC;aACrC,EAAE,EAAE,KAAM,CAAC,EAAC;iBACR,MAAM,CAAE,MAAM,CAAC,GAAG,CAAE,GAAG,KAAK,CAAC;iBAC7B,KAAK,EAAE,CAAC;aACZ,CAAC;SACL,CAAC,CAAC,CAAC;SAEH,MAAM,CAAC,KAAK,CAAC;KACjB,CAAC;KA+BD,+BAAU,GAAV,cAAa,CAAC;KAEd,sBAAI,8BAAM;cAAV,cAAwB,MAAM,CAAC,IAAI,CAAC,MAAM,CAAC,MAAM,CAAC,CAAC,CAAC;;;QAAA;KACpD,0BAAK,GAAL,cAAmB,MAAM,CAAC,IAAI,CAAC,MAAM,CAAE,CAAC,CAAE,CAAC,CAAC,CAAC;KAC7C,yBAAI,GAAJ,cAAkB,MAAM,CAAC,IAAI,CAAC,MAAM,CAAE,IAAI,CAAC,MAAM,CAAC,MAAM,GAAG,CAAC,CAAE,CAAC,CAAC,CAAC;KACjE,uBAAE,GAAF,UAAI,OAAgB;SAChB,IAAM,KAAK,GAAG,OAAO,GAAG,CAAC,GAAG,OAAO,GAAG,IAAI,CAAC,MAAM,CAAC,MAAM,GAAG,OAAO,CAAC;SACnE,MAAM,CAAC,IAAI,CAAC,MAAM,CAAE,KAAK,CAAE,CAAC;KAChC,CAAC;KAGD,0BAAK,GAAL,UAAO,KAAY;SACf,IAAI,MAAM,GAAG,IAAI,CAAC,GAAG,CAAE,eAAK,IAAI,YAAK,CAAC,KAAK,EAAE,EAAb,CAAa,CAAE,CAAC;SAChD,MAAM,CAAC,IAAU,IAAI,CAAC,WAAY,CAAE,MAAM,EAAE,EAAE,KAAK,EAAG,IAAI,CAAC,KAAK,EAAE,UAAU,EAAG,IAAI,CAAC,UAAU,EAAE,EAAE,KAAK,CAAE,CAAC;KAC9G,CAAC;KAED,2BAAM,GAAN;SACI,MAAM,CAAC,IAAI,CAAC,MAAM,CAAC,GAAG,CAAE,eAAK,IAAI,YAAK,CAAC,MAAM,EAAE,EAAd,CAAc,CAAE,CAAC;KACtD,CAAC;KAGD,wBAAG,GAAH,UAAK,QAA2B,EAAE,OAAiC;SAA9D,wBAA2B,GAA3B,aAA2B;SAAE,uBAAiC,GAAjC,YAAiC;SAC/D,EAAE,EAAQ,OAAQ,CAAC,GAAG,KAAK,KAAK,CAAE,CAAC,EAAC;aAChC,cAAG,CAAC,KAAK,CAAC,mFAAmF,CAAC,CAAC;SACnG,CAAC;SAGD,EAAE,EAAE,OAAO,CAAC,KAAM,CAAC,EAAC;aAChB,IAAI,CAAC,KAAK,CAAE,QAAQ,EAAE,OAAO,CAAE;SACnC,CAAC;SACD,IAAI,EAAC;aACD,IAAM,WAAW,GAAG,IAAI,CAAC,kBAAkB,CAAE,QAAQ,EAAE,OAAO,CAAE,CAAC;aACjE,WAAW,IAAI,WAAW,CAAC,MAAM,EAAE,CAAC;SACxC,CAAC;SAED,MAAM,CAAC,IAAI,CAAC;KAChB,CAAC;KAED,0BAAK,GAAL,UAAO,UAAwB,EAAE,OAAiC;SAAjC,uBAAiC,GAAjC,YAAiC;SAC9D,IAAM,cAAc,GAAG,oBAAO,CAAE,IAAI,CAAE,CAAC;SAGvC,EAAE,EAAE,UAAW,CAAC,EAAC;aACb,4BAAmB,CAAE,IAAI,EAAE,UAAU,CAAE,IAAI,EAAE,UAAU,EAAE,OAAO,CAAE,EAAE,OAAO,EAAE,IAAI,CAAE,CAAC;SACxF,CAAC;SAED,OAAO,CAAC,MAAM,IAAI,QAAQ,CAAE,IAAI,EAAE,OAAO,EAAE,IAAI,EAAE,mBAAQ,CAAE,EAAE,cAAc,EAAG,cAAc,EAAE,EAAE,OAAO,CAAE,CAAE,CAAC;SAE5G,MAAM,CAAC,IAAI,CAAC,MAAM,CAAC;KACvB,CAAC;KAGD,wBAAG,GAAH,UAAK,UAAwB,EAAG,OAAiC;SAAjC,uBAAiC,GAAjC,YAAiC;SAC7D,IAAM,QAAQ,GAAG,UAAU,CAAE,IAAI,EAAE,UAAU,EAAE,OAAO,CAAE,EAClD,WAAW,GAAG,IAAI,CAAC,MAAM,CAAC,MAAM;aAC1B,uBAAc,CAAE,IAAI,EAAE,QAAQ,EAAE,OAAO,CAAE;aACzC,4BAAmB,CAAE,IAAI,EAAE,QAAQ,EAAE,OAAO,CAAE,CAAC;SAE3D,EAAE,EAAE,WAAY,CAAC,EAAC;aACd,WAAW,CAAC,MAAM,EAAE,CAAC;aACrB,MAAM,CAAC,WAAW,CAAC,KAAK,CAAC;SAC7B,CAAC;KACL,CAAC;KAGD,2BAAM,GAAN,UAAQ,YAAkB,EAAE,OAAiC;SAAjC,uBAAiC,GAAjC,YAAiC;SACzD,EAAE,EAAE,YAAa,CAAC,EAAC;aACf,MAAM,CAAC,KAAK,CAAC,OAAO,CAAE,YAAY,CAAE;iBACxB,sBAAU,CAAE,IAAI,EAAE,YAAY,EAAE,OAAO,CAAE;iBACzC,qBAAS,CAAE,IAAI,EAAE,YAAY,EAAE,OAAO,CAAE,CAAC;SACzD,CAAC;SAED,MAAM,CAAC,EAAE,CAAC;KACd,CAAC;KAID,uCAAkB,GAAlB,UAAoB,UAAwB,EAAE,OAAiC;SAAjC,uBAAiC,GAAjC,YAAiC;SAC3E,IAAM,QAAQ,GAAG,UAAU,CAAE,IAAI,EAAE,UAAU,EAAE,OAAO,CAAE,CAAC;SAEzD,EAAE,EAAE,IAAI,CAAC,MAAM,CAAC,MAAO,CAAC,EAAC;aACrB,MAAM,CAAC,OAAO,CAAC,MAAM,KAAK,KAAK;iBACnB,uBAAc,CAAE,IAAI,EAAE,QAAQ,EAAE,OAAO,CAAE;iBACzC,uBAAc,CAAE,IAAI,EAAE,QAAQ,EAAE,OAAO,CAAE,CAAC;SAC1D,CAAC;SACD,IAAI,EAAC;aACD,MAAM,CAAC,4BAAmB,CAAE,IAAI,EAAE,QAAQ,EAAE,OAAO,CAAE,CAAC;SAC1D,CAAC;KACL,CAAC;KAQD,0BAAK,GAAL,UAAO,GAAY;SACf,MAAM,CAAC,IAAI,CAAC,MAAM,CAAC,GAAG,CAAE,eAAK,IAAI,YAAK,CAAE,GAAG,CAAE,EAAZ,CAAY,CAAE,CAAC;KACpD,CAAC;KAED,yBAAI,GAAJ,UAAM,OAAiC;SAAjC,uBAAiC,GAAjC,YAAiC;SACnC,EAAE,EAAE,yBAAY,CAAE,IAAI,EAAE,OAAO,CAAG,CAAC,EAAC;aAChC,IAAM,MAAM,GAAG,uBAAK,CAAE,IAAI,CAAE,CAAC;aAE7B,EAAE,EAAE,6BAAW,CAAE,IAAI,EAAE,OAAO,CAAG,CAAC,EAAC;iBAC/B,QAAQ,CAAE,IAAI,EAAE,MAAM,EAAE,IAAI,EAAE,OAAO,CAAE,CAAC;aAC5C,CAAC;aAED,MAAM,IAAI,wBAAM,CAAE,IAAI,CAAE,CAAC;SAC7B,CAAC;SAED,MAAM,CAAC,IAAI,CAAC;KAChB,CAAC;KAGD,yBAAI,GAAJ,UAAK,KAAK,EAAE,OAAO;SACjB,MAAM,CAAC,IAAI,CAAC,GAAG,CAAC,KAAK,EAAE,iBAAM,CAAC,EAAC,EAAE,EAAE,IAAI,CAAC,MAAM,EAAC,EAAE,OAAO,CAAC,CAAC,CAAC;KAC7D,CAAC;KAGD,wBAAG,GAAH,UAAI,OAAO;SACT,IAAI,KAAK,GAAG,IAAI,CAAC,EAAE,CAAC,IAAI,CAAC,MAAM,GAAG,CAAC,CAAC,CAAC;SACrC,IAAI,CAAC,MAAM,CAAC,KAAK,EAAE,OAAO,CAAC,CAAC;SAC5B,MAAM,CAAC,KAAK,CAAC;KACf,CAAC;KAGD,4BAAO,GAAP,UAAQ,KAAK,EAAE,OAAO;SACpB,MAAM,CAAC,IAAI,CAAC,GAAG,CAAC,KAAK,EAAE,iBAAM,CAAC,EAAC,EAAE,EAAE,CAAC,EAAC,EAAE,OAAO,CAAC,CAAC,CAAC;KACnD,CAAC;KAGD,0BAAK,GAAL,UAAO,OAA4B;SACjC,IAAI,KAAK,GAAG,IAAI,CAAC,EAAE,CAAC,CAAC,CAAC,CAAC;SACvB,IAAI,CAAC,MAAM,CAAE,KAAK,EAAE,OAAO,CAAE,CAAC;SAC9B,MAAM,CAAC,KAAK,CAAC;KACf,CAAC;KAGD,0BAAK,GAAL;SACE,MAAM,CAAC,KAAK,CAAC,KAAK,CAAC,IAAI,CAAC,MAAM,EAAE,SAAS,CAAC,CAAC;KAC7C,CAAC;KAED,4BAAO,GAAP,UAAS,SAAe;SACpB,IAAM,MAAM,GAAG,IAAI,CAAC,GAAG,CAAE,SAAS,CAAE,CAAC;SACrC,MAAM,CAAC,IAAI,CAAC,MAAM,CAAC,OAAO,CAAE,MAAM,CAAE,CAAC;KACzC,CAAC;KAED,4BAAO,GAAP,UAAS,KAAU;SACf,MAAM,CAAC,KAAK,CAAE,IAAI,CAAC,KAAK,CAAC,SAAS,CAAC,WAAW,CAAE,CAAC;KACrD,CAAC;KA5DM,qBAAU,GAAG,4BAAiB,CAAC;KA9O1C;SAAC,iBAAM,CAAC;aAEJ,SAAS,EAAG,GAAG;aACf,KAAK,EAAG,iBAAM;aACd,gBAAgB,EAAG,SAAS;UAC/B,CAAC;mBAAA;KAsSF,iBAAC;AAAD,EAAC,CArS+B,+BAAa,GAqS5C;AArSY,mBAAU,aAqStB;AAID,qBAAqB,UAAuB,EAAE,QAAsB,EAAE,OAA2B;KAC7F,IAAM,MAAM,GAAG,OAAO,CAAC,KAAK,GAAG,UAAU,CAAC,KAAK,CAAE,QAAQ,CAAE,GAAG,QAAQ,CAAC;KACvE,MAAM,CAAC,KAAK,CAAC,OAAO,CAAE,MAAM,CAAE,GAAG,MAAM,GAAG,CAAE,MAAM,CAAE,CAAC;AACzD,EAAC;AAED,KAAM,KAAK,GAAG,KAAK,CAAC,SAAS,CAAC,KAAK,CAAC;AAEpC,kBAAM,CAAC,UAAU,GAAQ,UAAU,CAAC;;;;;;;;ACjVpC,6CACyD,CAEzD,CAAC,CAF4E;AAIrE,wDAAQ,EAAE,mDAAQ,CAAmB;AAqB7C,kBAAyB,UAA2B;KAChD,IAAM,MAAM,GAAG,UAAU,CAAC,MAAM,CAAC;KAEjC,UAAU,CAAC,MAAM,GAAG,EAAE,CAAC;KACvB,UAAU,CAAC,KAAK,GAAI,EAAE,CAAC;KAEvB,OAAO,CAAE,UAAU,EAAE,MAAM,CAAE,CAAC;KAC9B,MAAM,CAAC,MAAM,CAAC;AAClB,EAAC;AARe,gBAAO,UAQtB;AAGD,iBAAwB,KAAsB,EAAE,KAAc;KAC1D,wBAAO,CAAE,KAAK,EAAE,KAAK,CAAE,CAAC;KAEhB,2CAAe,CAAW;KAClC,eAAe,IAAI,eAAe,CAAC,SAAS,CAAE,KAAK,EAAE,KAAK,CAAE,CAAC;AACjE,EAAC;AALe,eAAM,SAKrB;AAED,eAAsB,KAAsB,EAAE,KAAc;KACxD,sBAAK,CAAE,KAAK,EAAE,KAAK,CAAE,CAAC;KAEd,2CAAe,CAAW;KAClC,eAAe,IAAI,eAAe,CAAC,WAAW,CAAE,KAAK,EAAE,KAAK,CAAE,CAAC;AACnE,EAAC;AALe,aAAI,OAKnB;AAED,kBAAyB,UAA2B,EAAE,QAAmB;KACrE,GAAG,EAAe,UAAQ,EAAR,qBAAQ,EAAR,sBAAQ,EAAR,IAAS,CAAC;SAAvB,IAAI,KAAK;SACV,IAAI,CAAE,UAAU,EAAE,KAAK,CAAE,CAAC;MAC7B;KAED,MAAM,CAAC,QAAQ,CAAC;AACpB,EAAC;AANe,gBAAO,UAMtB;AAGD,uBAA8B,UAA2B,EAAE,OAA2B;KAC5E,wCAAW,CAAgB;KACjC,EAAE,EAAE,WAAW,IAAI,OAAO,CAAC,IAAI,KAAK,KAAM,CAAC,EAAC;SACxC,UAAU,CAAC,MAAM,CAAC,IAAI,CAAE,WAAW,CAAE,CAAC;SACtC,MAAM,CAAC,IAAI,CAAC;KAChB,CAAC;KAED,MAAM,CAAC,KAAK,CAAC;AACjB,EAAC;AARe,qBAAY,eAQ3B;AAYD,mBAA0B,KAAe,EAAE,KAAc;KACrD,KAAK,CAAE,KAAK,CAAC,GAAG,CAAE,GAAG,KAAK,CAAC;KAC3B,IAAI,EAAE,GAAe,KAAK,CAAC,EAAE,CAAC;KAE9B,EAAE,EAAE,EAAE,IAAI,IAAK,CAAC,EAAC;SACb,KAAK,CAAE,EAAE,CAAE,GAAG,KAAK,CAAC;KACxB,CAAC;AACL,EAAC;AAPe,iBAAQ,WAOvB;AAGD,sBAA6B,KAAe,EAAE,KAAc;KACxD,OAAO,KAAK,CAAE,KAAK,CAAC,GAAG,CAAE,CAAC;KAC1B,IAAI,EAAE,GAAG,KAAK,CAAC,EAAE,CAAC;KAClB,EAAE,EAAE,EAAE,IAAI,IAAK,CAAC,EAAC;SACb,OAAO,KAAK,CAAE,EAAE,CAAE,CAAC;KACvB,CAAC;AACL,EAAC;AANe,oBAAW,cAM1B;AAGD,kBAAyB,UAA2B,EAAE,KAAK,EAAE,OAAO;KACxD,4BAAK,CAAgB;KAC7B,MAAM,CAAC,KAAK,YAAY,KAAK,GAAG,KAAK,GAAG,KAAK,CAAC,MAAM,CAAE,KAAK,EAAE,OAAO,EAAE,UAAU,CAAE,CAAC;AACvF,EAAC;AAHe,gBAAO,UAGtB;AAED,2BAAkC,UAA2B,EAAE,KAAK,EAAE,OAAO;KACjE,4BAAK,EACV,MAAM,GAAG,KAAK,YAAY,KAAK,GAAG,KAAK,GAAG,KAAK,CAAC,MAAM,CAAE,KAAK,EAAE,OAAO,EAAE,UAAU,CAAE,CAAC;KAExF,MAAM,CAAE,UAAU,EAAE,MAAM,CAAE,CAAC;KAC7B,MAAM,CAAC,MAAM,CAAC;AAClB,EAAC;AANe,yBAAgB,mBAM/B;AAgBD;KAEI,+BAAuB,MAAuB,EACvB,MAAgB,EAChB,KAAgB,EAChB,OAAkB,EAClB,MAAsB,EACtB,MAAgB;SALhB,WAAM,GAAN,MAAM,CAAiB;SACvB,WAAM,GAAN,MAAM,CAAU;SAChB,UAAK,GAAL,KAAK,CAAW;SAChB,YAAO,GAAP,OAAO,CAAW;SAClB,WAAM,GAAN,MAAM,CAAgB;SACtB,WAAM,GAAN,MAAM,CAAU;KAAG,CAAC;KAG3C,sCAAM,GAAN,UAAQ,QAAmB;SACvB,aAA+B,EAAvB,kBAAM,EAAE,kBAAM,EACd,0BAAQ,CAAY;SAG5B,GAAG,EAAqB,UAAM,EAAN,iBAAM,EAAN,oBAAM,EAAN,IAAO,CAAC;aAA3B,IAAI,WAAW;aAChB,WAAW,CAAC,MAAM,CAAE,IAAI,CAAE,CAAC;UAC9B;SAID,GAAG,EAAqB,UAAM,EAAN,iBAAM,EAAN,oBAAM,EAAN,IAAO,CAAC;aAA3B,IAAI,WAAW;aAChB,QAAQ,CAAE,MAAM,EAAE,QAAQ,EAAE,WAAW,CAAC,MAAM,EAAE,QAAQ,CAAE,CAAC;UAC9D;SAGD,aAA+B,EAAvB,gBAAK,EAAE,oBAAO,CAAU;SAGhC,GAAG,EAAgB,UAAK,EAAL,eAAK,EAAL,mBAAK,EAAL,IAAM,CAAC;aAArB,IAAI,MAAM;aACX,QAAQ,CAAE,MAAM,EAAE,KAAK,EAAE,MAAM,EAAE,MAAM,EAAE,QAAQ,CAAE,CAAC;aACpD,QAAQ,CAAE,MAAM,EAAE,KAAK,EAAE,MAAM,EAAE,MAAM,EAAE,QAAQ,CAAE,CAAC;UACvD;SAGD,GAAG,EAAgB,UAAO,EAAP,mBAAO,EAAP,qBAAO,EAAP,IAAQ,CAAC;aAAvB,IAAI,MAAM;aACX,QAAQ,CAAE,MAAM,EAAE,QAAQ,EAAE,MAAM,EAAE,MAAM,EAAE,QAAQ,CAAE,CAAC;aACvD,QAAQ,CAAE,MAAM,EAAE,QAAQ,EAAE,MAAM,EAAE,MAAM,EAAE,QAAQ,CAAE,CAAC;UAC1D;SAED,EAAE,EAAE,IAAI,CAAC,MAAO,CAAC,EAAC;aACd,QAAQ,CAAE,MAAM,EAAE,MAAM,EAAE,MAAM,EAAE,QAAQ,CAAE,CAAC;SACjD,CAAC;SAED,EAAE,EAAE,KAAK,CAAC,MAAM,IAAI,OAAO,CAAC,MAAO,CAAC,EAAC;aACjC,QAAQ,CAAE,MAAM,EAAE,QAAQ,EAAE,MAAM,EAAE,QAAQ,CAAE,CAAC;SACnD,CAAC;SAED,IAAI,CAAC,MAAM,IAAI,wBAAM,CAAE,MAAM,EAAE,QAAQ,CAAE,CAAC;KAC9C,CAAC;KACL,4BAAC;AAAD,EAAC;AAlDY,8BAAqB,wBAkDjC;;;;;;;;ACjLD,6CAAwD,CACxD,CAAC,CAD2E;AAC5E,wCAAwH,EACxH,CAAC,CADqI;AAOtI,yBAAgC,UAA2B,EAAE,KAAK,EAAE,OAAoB;KACpF,IAAM,MAAM,GAAG,uBAAK,CAAE,UAAU,CAAE,EAC5B,MAAM,GAAG,EAAE,CAAC;KAElB,IAAI,KAAK,GAAG,cAAc,CAAE,UAAU,EAAE,KAAK,EAAE,MAAM,EAAE,OAAO,CAAE,CAAC;KAEjE,EAAE,EAAE,KAAK,CAAC,MAAM,IAAI,MAAM,CAAC,MAAO,CAAC,EAAC;SAChC,IAAI,QAAQ,GAAG,kBAAkB,CAAE,UAAU,EAAE,KAAK,EAAE,OAAO,CAAE,CAAC;SAChE,EAAE,EAAE,6BAAW,CAAE,UAAU,EAAE,OAAO,CAAG,CAAC,EAAC;aACrC,MAAM,CAAC,IAAI,kCAAqB,CAAE,UAAU,EAAE,MAAM,EAAE,KAAK,EAAE,EAAE,EAAE,MAAM,EAAE,QAAQ,CAAE,CAAC;SACxF,CAAC;KACL,CAAC;KAGD,MAAM,IAAI,wBAAM,CAAE,UAAU,CAAE,CAAC;AACnC,EAAC;AAfe,uBAAc,iBAe7B;AAAA,EAAC;AAGF,6BAA6B,UAA2B,EAAE,KAAgB,EAAE,OAAoB;KAC5F,IAAI,EAAE,GAAG,OAAO,CAAC,EAAE,CAAC;KAGpB,EAAE,EAAE,EAAE,IAAI,IAAK,CAAC,EAAC;SAEb,IAAM,QAAM,GAAG,UAAU,CAAC,MAAM,CAAC,MAAM,GAAG,KAAK,CAAC,MAAM,CAAC;SAGvD,EAAE,GAAG,MAAM,CAAE,EAAE,CAAE,CAAC;SAClB,EAAE,EAAE,EAAE,GAAG,CAAE,CAAC;aAAC,EAAE,IAAI,QAAM,GAAG,CAAC,CAAC;SAC9B,EAAE,EAAE,EAAE,GAAG,CAAE,CAAC;aAAC,EAAE,GAAG,CAAC,CAAC;SACpB,EAAE,EAAE,EAAE,GAAG,QAAO,CAAC;aAAC,EAAE,GAAG,QAAM,CAAC;SAG9B,YAAY,CAAE,UAAU,CAAC,MAAM,EAAE,EAAE,EAAE,KAAK,CAAE,CAAC;SAC7C,MAAM,CAAC,KAAK,CAAC;KACjB,CAAC;KAED,MAAM,CAAC,yBAAY,CAAE,UAAU,EAAE,OAAO,CAAE,CAAC;AAC/C,EAAC;AAED,uBAAuB,MAAc,EAAE,EAAW,EAAE,KAAa;KAC7D,GAAG,EAAE,IAAI,CAAC,GAAG,MAAM,CAAC,MAAM,GAAG,CAAC,EAAE,CAAC,GAAG,CAAC,GAAG,KAAK,CAAC,MAAM,EAAE,CAAC,IAAI,EAAE,EAAE,CAAC,EAAE,EAAE,CAAC,EAAE,EAAE,CAAC;SACtE,MAAM,CAAE,CAAC,CAAE,GAAG,MAAM,CAAE,CAAC,CAAE,CAAC;KAC9B,CAAC;KAED,GAAG,EAAE,CAAC,GAAG,CAAC,EAAE,CAAC,GAAG,EAAE,EAAE,CAAC,GAAG,KAAK,CAAC,MAAM,EAAE,CAAC,EAAE,EAAE,CAAC,EAAE,EAAE,CAAC;SAC7C,MAAM,CAAE,CAAC,CAAE,GAAG,KAAK,CAAE,CAAC,CAAE,CAAC;KAC7B,CAAC;AACL,EAAC;AAGD,yBAAyB,UAA2B,EAAE,OAAO,EAAE,MAAsB,EAAE,SAAS;KAC5F,IAAI,MAAM,GAAQ,UAAU,CAAC,MAAM,EAC/B,KAAK,GAAS,UAAU,CAAC,KAAK,EAC9B,KAAK,GAAS,SAAS,CAAC,KAAK,EAC7B,KAAK,GAAS,SAAS,CAAC,KAAK,EAC7B,WAAW,GAAG,UAAU,CAAC,KAAK,CAAC,SAAS,CAAC,WAAW,EACpD,UAAU,GAAG,MAAM,CAAC,MAAM,CAAC;KAE/B,GAAG,EAAgB,UAAO,EAAP,mBAAO,EAAP,qBAAO,EAAP,IAAQ,CAAC;SAAvB,IAAM,IAAI;SACX,IAAI,KAAK,GAAG,IAAI,GAAG,KAAK,CAAE,IAAI,CAAE,WAAW,CAAE,CAAE,IAAI,KAAK,CAAE,IAAI,CAAC,GAAG,CAAE,GAAG,IAAI,CAAC;SAE5E,EAAE,EAAE,KAAM,CAAC,EAAC;aACR,EAAE,EAAE,KAAK,IAAI,IAAI,KAAK,KAAM,CAAC,EAAC;iBAC1B,IAAI,KAAK,GAAG,IAAI,CAAC,UAAU,IAAI,IAAI,CAAC;iBACpC,IAAM,WAAW,GAAG,KAAK,CAAC,kBAAkB,CAAE,KAAK,EAAE,SAAS,CAAE,CAAC;iBACjE,WAAW,IAAI,MAAM,CAAC,IAAI,CAAE,WAAW,CAAE,CAAC;aAC9C,CAAC;SACL,CAAC;SACD,IAAI,EAAC;aACD,KAAK,GAAG,oBAAO,CAAE,UAAU,EAAE,IAAI,EAAE,SAAS,CAAE,CAAC;aAE/C,MAAM,CAAC,IAAI,CAAE,KAAK,CAAE,CAAC;aACrB,mBAAM,CAAE,UAAU,EAAE,KAAK,CAAE,CAAC;aAC5B,qBAAQ,CAAE,KAAK,EAAE,KAAK,CAAE,CAAC;SAC7B,CAAC;MACJ;KAED,MAAM,CAAC,MAAM,CAAC,KAAK,CAAE,UAAU,CAAE,CAAC;AACtC,EAAC;;;;;;;;ACvFD,6CAAwD,CACxD,CAAC,CAD2E;AAC5E,wCAAoJ,EACpJ,CAAC,CADiK;AAOlK,KAAM,aAAa,GAAG,EAAE,MAAM,EAAG,IAAI,EAAE,CAAC;AAExC,8BAAqC,UAA2B,EAAE,KAAgB,EAAE,OAA2B,EAAE,MAAiB;KAC9H,IAAM,MAAM,GAAG,uBAAK,CAAE,UAAU,CAAE,CAAC;KAEnC,IAAM,KAAK,GAAG,gBAAgB,CAAE,UAAU,EAAE,KAAK,EAAE,OAAO,CAAE,CAAC;KAE7D,EAAE,EAAE,KAAK,CAAC,MAAO,CAAC,EAAC;SACf,IAAM,QAAQ,GAAG,yBAAY,CAAE,UAAU,EAAE,OAAO,CAAE,CAAC;SAErD,EAAE,EAAE,6BAAW,CAAE,UAAU,EAAE,MAAM,GAAG,aAAa,GAAG,OAAO,CAAG,CAAC,EAAC;aAE9D,MAAM,CAAC,IAAI,kCAAqB,CAAE,UAAU,EAAE,MAAM,EAAE,KAAK,CAAC,KAAK,EAAE,EAAE,EAAE,EAAE,EAAE,EAAE,QAAQ,CAAE,CAAC;SAC5F,CAAC;KACL,CAAC;KAGD,MAAM,IAAI,wBAAM,CAAE,UAAU,CAAE,CAAC;AACnC,EAAC;AAhBe,4BAAmB,sBAgBlC;AAAA,EAAC;AAEF,yBAAgC,UAAU,EAAE,KAAK,EAAE,OAAO;KACtD,IAAM,MAAM,GAAG,uBAAK,CAAE,UAAU,CAAE,EAC5B,MAAM,GAAG,EAAE,CAAC;KAElB,IAAI,QAAQ,GAAG,UAAU,CAAC,MAAM,EAC5B,KAAK,GAAM,WAAW,CAAE,UAAU,EAAE,KAAK,EAAE,MAAM,EAAE,OAAO,CAAE,CAAC;KAEjE,IAAM,WAAW,GAAG,UAAU,CAAC,MAAM,CAAC,MAAM,GAAG,KAAK,CAAC,MAAM,EACrD,OAAO,GAAG,WAAW,GAAG,QAAQ,CAAC,MAAM,GAAG,CAC5B,WAAW,GAAG,eAAe,CAAE,UAAU,EAAE,QAAQ,CAAE;SACrC,oBAAO,CAAE,UAAU,EAAE,QAAQ,CAAE,CAClD,GAAG,EAAE,CAAC;KAEvB,IAAM,cAAc,GAAG,MAAM,CAAC,MAAM,IAAI,KAAK,CAAC,MAAM,EAC9C,MAAM,GAAG,CAAE,cAAc,IAAI,yBAAY,CAAE,UAAU,EAAE,OAAO,CAAE,CAAE,IAAI,KAAK,CAAC,MAAM,IAAI,OAAO,CAAC,MAAM,CAAC;KAE3G,EAAE,EAAE,cAAc,IAAI,OAAO,CAAC,MAAM,IAAI,MAAO,CAAC,EAAC;SAC7C,EAAE,EAAE,6BAAW,CAAE,UAAU,EAAE,OAAO,CAAG,CAAC,EAAC;aACrC,MAAM,CAAC,IAAI,kCAAqB,CAAE,UAAU,EAAE,MAAM,EAAE,KAAK,EAAE,OAAO,EAAE,MAAM,EAAE,MAAM,CAAE,CAAC;SAC3F,CAAC;KACL,CAAC;KAED,MAAM,IAAI,wBAAM,CAAE,UAAU,CAAE,CAAC;AACnC,EAAC;AAvBe,uBAAc,iBAuB7B;AAAA,EAAC;AAIF,0BAA0B,UAA2B,EAAE,QAAmB;KAC9D,4BAAK,EACP,OAAO,GAAG,EAAE,CAAC;KAGnB,GAAG,EAAgB,UAAQ,EAAR,qBAAQ,EAAR,sBAAQ,EAAR,IAAS,CAAC;SAAxB,IAAI,MAAM;SACX,EAAE,EAAE,CAAC,KAAK,CAAE,MAAM,CAAC,GAAG,CAAG,CAAC,EAAC;aACvB,OAAO,CAAC,IAAI,CAAE,MAAM,CAAE,CAAC;aACvB,iBAAI,CAAE,UAAU,EAAE,MAAM,CAAE,CAAC;SAC/B,CAAC;MACJ;KAED,MAAM,CAAC,OAAO,CAAC;AACnB,EAAC;AAGD,sBAAsB,UAA2B,EAAE,MAAc,EAAE,MAAsB,EAAE,OAAO;KAC9F,IAAI,MAAM,GAAQ,KAAK,CAAE,MAAM,CAAC,MAAM,CAAE,EACpC,KAAK,GAAa,EAAE,EACpB,KAAK,GAAS,OAAO,CAAC,KAAK,IAAI,IAAI,GAAG,IAAI,GAAG,OAAO,CAAC,KAAK,EAC1D,SAAS,GAAK,UAAU,CAAC,KAAK,EAC9B,UAAU,GAAI,UAAU,CAAC,MAAM,EAC/B,WAAW,GAAG,UAAU,CAAC,KAAK,CAAC,SAAS,CAAC,WAAW,EACpD,KAAK,GAAS,EAAE,EAChB,SAAS,GAAK,IAAI,CAAC;KAGvB,GAAG,EAAE,IAAI,CAAC,GAAG,CAAC,EAAE,CAAC,GAAG,CAAC,EAAE,CAAC,GAAG,MAAM,CAAC,MAAM,EAAE,CAAC,EAAE,EAAE,CAAC;SAC5C,IAAI,IAAI,GAAI,MAAM,CAAE,CAAC,CAAE,EACnB,KAAK,GAAY,IAAI,CAAC;SAE1B,EAAE,EAAE,IAAK,CAAC,EAAC;aACP,IAAI,EAAE,GAAI,IAAI,CAAE,WAAW,CAAE,EACzB,GAAG,GAAG,IAAI,CAAC,GAAG,CAAC;aAEnB,EAAE,EAAE,KAAK,CAAE,EAAE,CAAE,IAAI,KAAK,CAAE,GAAG,CAAG,CAAC;iBAAC,QAAQ,CAAC;aAE3C,KAAK,GAAG,SAAS,CAAE,EAAE,CAAE,IAAI,SAAS,CAAE,GAAG,CAAE,CAAC;SAChD,CAAC;SAED,EAAE,EAAE,KAAM,CAAC,EAAC;aACR,EAAE,EAAE,KAAK,IAAI,IAAI,KAAK,KAAM,CAAC,EAAC;iBAC1B,EAAE,EAAE,SAAS,IAAI,UAAU,CAAE,CAAC,CAAE,KAAK,KAAM,CAAC;qBAAC,SAAS,GAAG,KAAK,CAAC;iBAE/D,IAAI,KAAK,GAAG,IAAI,CAAC,UAAU,IAAI,IAAI,CAAC;iBACpC,IAAM,WAAW,GAAG,KAAK,CAAC,kBAAkB,CAAE,KAAK,EAAE,OAAO,CAAE,CAAC;iBAC/D,WAAW,IAAI,MAAM,CAAC,IAAI,CAAE,WAAW,CAAE,CAAC;aAC9C,CAAC;SACL,CAAC;SACD,IAAI,EAAC;aACD,KAAK,GAAG,oBAAO,CAAE,UAAU,EAAE,IAAI,EAAE,OAAO,CAAE,CAAC;aAC7C,mBAAM,CAAE,UAAU,EAAE,KAAK,CAAE,CAAC;aAC5B,KAAK,CAAC,IAAI,CAAE,KAAK,CAAE,CAAC;SACxB,CAAC;SAED,MAAM,CAAE,CAAC,EAAE,CAAE,GAAG,KAAK,CAAC;SACtB,qBAAQ,CAAE,KAAK,EAAE,KAAK,CAAE,CAAC;KAC7B,CAAC;KAED,MAAM,CAAC,MAAM,GAAG,CAAC,CAAC;KAClB,UAAU,CAAC,MAAM,GAAK,MAAM,CAAC;KAC7B,UAAU,CAAC,KAAK,GAAM,KAAK,CAAC;KAE5B,EAAE,EAAE,CAAC,SAAU,CAAC;SAAC,OAAO,CAAC,MAAM,GAAG,IAAI,CAAC;KAEvC,MAAM,CAAC,KAAK,CAAC;AACjB,EAAC;AAED,2BAA2B,IAAI,EAAE,MAAM,EAAE,OAAO;KAC5C,IAAI,GAAG,GAAW,MAAM,GAAG,MAAM,CAAC,MAAM,GAAG,CAAC,EACxC,MAAM,GAAQ,KAAK,CAAE,GAAG,CAAE,EAC1B,KAAK,GAAa,EAAE,EACpB,WAAW,GAAG,IAAI,CAAC,KAAK,CAAC,SAAS,CAAC,WAAW,CAAC;KAEnD,GAAG,EAAE,IAAI,CAAC,GAAG,CAAC,EAAE,CAAC,GAAG,CAAC,EAAE,CAAC,GAAG,GAAG,EAAE,CAAC,EAAE,EAAE,CAAC;SAClC,IAAI,GAAG,GAAG,MAAM,CAAE,CAAC,CAAE,CAAC;SAEtB,EAAE,EAAE,GAAG,IAAI,CAAE,KAAK,CAAE,GAAG,CAAE,WAAW,CAAE,CAAE,IAAI,KAAK,CAAE,GAAG,CAAC,GAAG,CAAE,CAAG,CAAC,EAAC;aAC7D,QAAQ,CAAC;SACb,CAAC;SAED,IAAI,KAAK,GAAG,oBAAO,CAAE,IAAI,EAAE,GAAG,EAAE,OAAO,CAAE,CAAC;SAE1C,mBAAM,CAAE,IAAI,EAAE,KAAK,CAAE,CAAC;SACtB,MAAM,CAAE,CAAC,EAAE,CAAE,GAAG,KAAK,CAAC;SACtB,qBAAQ,CAAE,KAAK,EAAE,KAAK,CAAE,CAAC;KAE7B,CAAC;KAED,MAAM,CAAC,MAAM,GAAG,CAAC,CAAC;KAClB,IAAI,CAAC,KAAK,GAAM,KAAK,CAAC;KAEtB,MAAM,CAAC,IAAI,CAAC,MAAM,GAAG,MAAM,CAAC;AAChC,EAAC;;;;;;;;ACzID,wCAAyE,EACzE,CAAC,CADsF;AACvF,sCAA0B,CAC1B,CAAC,CADiD;AAClD,6CAA+D,CAE/D,CAAC,CAFkF;AAE3E,6CAAQ,EAAE,wCAAQ,CAAe;AAEzC,oBAA2B,UAA2B,EAAE,EAAyB,EAAE,OAA4B;KAC3G,IAAI,KAAK,GAAY,UAAU,CAAC,GAAG,CAAE,EAAE,CAAE,CAAC;KAE1C,EAAE,EAAE,KAAM,CAAC,EAAC;SACR,IAAM,MAAM,GAAG,uBAAK,CAAE,UAAU,CAAE,EAC5B,MAAM,GAAG,UAAU,CAAC,MAAM,CAAC;SAGjC,MAAM,CAAC,MAAM,CAAE,MAAM,CAAC,OAAO,CAAE,KAAK,CAAE,EAAE,CAAC,CAAE,CAAC;SAC5C,wBAAW,CAAE,UAAU,CAAC,KAAK,EAAE,KAAK,CAAE,CAAC;SAGvC,IAAM,MAAM,GAAG,6BAAW,CAAE,UAAU,EAAE,OAAO,CAAE,CAAC;SAGlD,EAAE,EAAE,MAAO,CAAC,EAAC;aACT,QAAQ,CAAE,KAAK,EAAE,QAAQ,EAAE,KAAK,EAAE,UAAU,EAAE,OAAO,CAAE,CAAC;aACxD,QAAQ,CAAE,UAAU,EAAE,QAAQ,EAAE,KAAK,EAAE,UAAU,EAAE,OAAO,CAAE,CAAC;SACjE,CAAC;SAED,iBAAI,CAAE,UAAU,EAAE,KAAK,CAAE,CAAC;SAE1B,MAAM,IAAI,QAAQ,CAAE,UAAU,EAAE,QAAQ,EAAE,UAAU,EAAE,OAAO,CAAE,CAAC;SAGhE,MAAM,IAAI,wBAAM,CAAE,UAAU,CAAE,CAAC;SAE/B,MAAM,CAAC,KAAK,CAAC;KACjB,CAAC;AACL,EAAC;AA7Be,kBAAS,YA6BxB;AAAA,EAAC;AAOF,qBAA4B,UAA2B,EAAE,QAAgB,EAAE,OAAO;KAC9E,IAAM,OAAO,GAAG,gBAAgB,CAAE,UAAU,EAAE,QAAQ,CAAE,CAAC;KACzD,EAAE,EAAE,OAAO,CAAC,MAAO,CAAC,EAAC;SACjB,IAAM,MAAM,GAAG,uBAAK,CAAE,UAAU,CAAE,CAAC;SAEnC,WAAW,CAAE,UAAU,EAAE,OAAO,CAAC,MAAM,CAAE,CAAC;SAE1C,EAAE,EAAE,6BAAW,CAAE,UAAU,EAAE,OAAO,CAAG,CAAC,EAAC;aACrC,IAAM,WAAW,GAAG,IAAI,kCAAqB,CAAE,UAAU,EAAE,MAAM,EAAE,EAAE,EAAE,OAAO,EAAE,EAAE,EAAE,KAAK,CAAE,CAAC;aAC5F,WAAW,CAAC,MAAM,EAAE,CAAC;SACzB,CAAC;SACD,IAAI,EAAC;aAED,MAAM,IAAI,wBAAM,CAAE,UAAU,CAAE,CAAC;SACnC,CAAC;KACL,CAAC;KAED,MAAM,CAAC,OAAO,CAAC;AACnB,EAAC;AAlBe,mBAAU,aAkBzB;AAAA,EAAC;AAGF,2BAA2B,UAAU,EAAE,QAAQ;KAC3C,IAAI,OAAO,GAAG,KAAK,CAAE,QAAQ,CAAC,MAAM,CAAE,EAClC,KAAK,GAAK,UAAU,CAAC,KAAK,CAAC;KAE/B,GAAG,EAAE,IAAI,CAAC,GAAG,CAAC,EAAE,CAAC,GAAG,CAAC,EAAE,CAAC,GAAG,QAAQ,CAAC,MAAM,EAAE,CAAC,EAAE,EAAE,CAAC;SAC9C,IAAI,KAAK,GAAG,UAAU,CAAC,GAAG,CAAE,QAAQ,CAAE,CAAC,CAAE,CAAE,CAAC;SAC5C,EAAE,EAAE,KAAM,CAAC,EAAC;aACR,OAAO,CAAE,CAAC,EAAE,CAAE,GAAG,KAAK,CAAC;aACvB,wBAAW,CAAE,KAAK,EAAE,KAAK,CAAE,CAAC;aAC5B,iBAAI,CAAE,UAAU,EAAE,KAAK,CAAE,CAAC;SAC9B,CAAC;KACL,CAAC;KAED,OAAO,CAAC,MAAM,GAAG,CAAC,CAAC;KAEnB,MAAM,CAAC,OAAO,CAAC;AACnB,EAAC;AAGD,sBAAsB,UAAU,EAAE,OAAO;KACrC,IAAI,IAAI,GAAK,UAAU,CAAC,MAAM,EAC1B,MAAM,GAAG,UAAU,CAAC,MAAM,GAAG,KAAK,CAAE,IAAI,CAAC,MAAM,GAAG,OAAO,CAAE,EAC3D,KAAK,GAAG,UAAU,CAAC,KAAK,CAAC;KAE7B,GAAG,EAAE,IAAI,CAAC,GAAG,CAAC,EAAE,CAAC,GAAG,CAAC,EAAE,CAAC,GAAG,IAAI,CAAC,MAAM,EAAE,CAAC,EAAE,EAAE,CAAC;SAC1C,IAAI,KAAK,GAAG,IAAI,CAAE,CAAC,CAAE,CAAC;SAEtB,EAAE,EAAE,KAAK,CAAE,KAAK,CAAC,GAAG,CAAG,CAAC,EAAC;aACrB,MAAM,CAAE,CAAC,EAAE,CAAE,GAAG,KAAK,CAAC;SAC1B,CAAC;KACL,CAAC;KAED,MAAM,CAAC,MAAM,GAAG,CAAC,CAAC;AACtB,EAAC","file":"./index.js","sourcesContent":["(function webpackUniversalModuleDefinition(root, factory) {\n\tif(typeof exports === 'object' && typeof module === 'object')\n\t\tmodule.exports = factory();\n\telse if(typeof define === 'function' && define.amd)\n\t\tdefine([], factory);\n\telse if(typeof exports === 'object')\n\t\texports[\"Nested\"] = factory();\n\telse\n\t\troot[\"Nested\"] = factory();\n})(this, function() {\nreturn \n\n\n/** WEBPACK FOOTER **\n ** webpack/universalModuleDefinition\n **/"," \t// The module cache\n \tvar installedModules = {};\n\n \t// The require function\n \tfunction __webpack_require__(moduleId) {\n\n \t\t// Check if module is in cache\n \t\tif(installedModules[moduleId])\n \t\t\treturn installedModules[moduleId].exports;\n\n \t\t// Create a new module (and put it into the cache)\n \t\tvar module = installedModules[moduleId] = {\n \t\t\texports: {},\n \t\t\tid: moduleId,\n \t\t\tloaded: false\n \t\t};\n\n \t\t// Execute the module function\n \t\tmodules[moduleId].call(module.exports, module, module.exports, __webpack_require__);\n\n \t\t// Flag the module as loaded\n \t\tmodule.loaded = true;\n\n \t\t// Return the exports of the module\n \t\treturn module.exports;\n \t}\n\n\n \t// expose the modules object (__webpack_modules__)\n \t__webpack_require__.m = modules;\n\n \t// expose the module cache\n \t__webpack_require__.c = installedModules;\n\n \t// __webpack_public_path__\n \t__webpack_require__.p = \"\";\n\n \t// Load entry module and return exports\n \treturn __webpack_require__(0);\n\n\n\n/** WEBPACK FOOTER **\n ** webpack/bootstrap 5abb8f15292351fa542b\n **/","/**\n * Main module\n */\n\nimport * as tools from './objectplus/tools.ts'\nimport { ChainableAttributeSpec } from './record/index.ts'\nimport { Record as Model } from './record/index.ts' \n\nimport { Events } from './objectplus/events.ts'\nexport const { on, off, trigger, once, listenTo, stopListening, listenToOnce } = Events;\n\nimport { Collection } from './collection/index.ts'\n\nexport * from './objectplus/mixins.ts'\nexport * from './objectplus/events.ts'\n\nimport { Mixable as Class } from './objectplus/mixins.ts'\n\nexport {\n    tools,\n    Model,\n    Collection,\n    Class,\n    transaction,\n    value\n}; \n\nfunction value( x ){\n    return new ChainableAttributeSpec({ value : x });\n}\n\nfunction transaction( method ){\n    return function( ...args ){\n        let result;\n        \n        this.transaction( () => {\n            result = method.apply( this, args );\n        });\n        \n        return result;\n    }\n}\n\n\n/** WEBPACK FOOTER **\n ** ./src/index.ts\n **/","/**\n * Simple overridable logging stubs\n *\n */\n\nclass Log {\n    level : Number = 2\n\n    error( ...args : any[] ) : void {\n        console.error.apply( console, args );\n    }\n\n    warn( ...args : any[] ) : void {\n        if( this.level > 0 ) console.warn.apply( console, args );\n    }\n\n    info(){\n        if( this.level > 1 ) console.info.apply( console, arguments );\n    }\n\n    debug(){\n        if( this.level > 2 ) console.log.apply( console, arguments );\n    }\n}\n\nexport let log = new Log();\n\n// Check if value is valid JSON.\nexport function isValidJSON( value : any ) : boolean {\n    if( value === null ){\n        return true;\n    }\n\n    switch( typeof value ){\n    case 'number' :\n    case 'string' :\n    case 'boolean' :\n        return true;\n\n    case 'object':\n        var proto = Object.getPrototypeOf( value );\n\n        if( proto === Object.prototype || proto === Array.prototype ){\n            return every( value, isValidJSON );\n        }\n    }\n\n    return false;\n}\n\n/**\n * Object manipulation helpers...\n */\n\nexport function getBaseClass( Class : Function ){\n    return Object.getPrototypeOf( Class.prototype ).constructor\n}\n\nexport function isEmpty( obj : {} ) : boolean {\n    if( obj ){\n        for( let key in obj ){\n            if( obj.hasOwnProperty( key ) ){\n                return false;\n            }\n        }\n    }\n\n    return true;\n}\n\ntype Iteratee = ( value : any, key? : string | number ) => any;\n\nfunction someArray( arr : any[], fun : Iteratee ) : any {\n    let result;\n\n    for( let i = 0; i < arr.length; i++ ){\n        if( result = fun( arr[ i ], i ) ){\n            return result;\n        }\n    }\n}\n\nfunction someObject( obj : {}, fun : Iteratee ) : any {\n    let result;\n\n    for( let key in obj ){\n        if( obj.hasOwnProperty( key ) ){\n            if( result = fun( obj[ key ], key ) ){\n                return result;\n            }\n        }\n    }\n}\n\nexport function some( obj, fun : Iteratee ) : any {\n    if( Object.getPrototypeOf( obj ) === ArrayProto ){\n        return someArray( obj, fun );\n    }\n    else{\n        return someObject( obj, fun );\n    }\n}\n\nexport function every( obj : { }, predicate : Iteratee ) : boolean {\n    return !some( obj, x => !predicate( x ) );\n}\n\nexport function getPropertyDescriptor( obj : {}, prop : string ) : PropertyDescriptor {\n    let desc : PropertyDescriptor;\n\n    for( let proto = obj; !desc && proto; proto = Object.getPrototypeOf( proto ) ) {\n        desc = Object.getOwnPropertyDescriptor( obj, prop );\n    }\n\n    return desc;\n}\n\nexport function omit( source : {}, ...rest : string[] ) : {}\nexport function omit( source ) : {} {\n    const dest = {}, discard = {};\n\n    for( let i = 1; i < arguments.length; i ++ ){\n        discard[ arguments[ i ] ] = true;\n    }\n\n    for( var name in source ) {\n        if( !discard[ name ] && source.hasOwnProperty( name ) ) {\n            dest[ name ] = source[ name ];\n        }\n    }\n\n    return dest;\n}\n\nexport function transform< A, B >( dest : { [ key : string ] : A }, source : { [ key : string ] : B }, fun : ( value : B, key : string ) => A | void ) : { [ key : string ] : A } {\n    for( var name in source ) {\n        if( source.hasOwnProperty( name ) ) {\n            var value = fun( source[ name ], name );\n            value === void 0 || ( dest[ name ] = < A >value );\n        }\n    }\n\n    return dest;\n}\n\nexport function fastAssign( dest : {}, source : {} ) : void {\n    for( var name in source ) {\n        dest[ name ] = source[ name ];\n    }\n}\n\nexport function fastDefaults( dest : {}, source : {} ) : void {\n    for( var name in source ) {\n        if( dest[ name ] === void 0 ){\n            dest[ name ] = source[ name ];\n        }\n    }\n}\n\nfunction forAllArgs( fun ) {\n    return function< T >( dest : T, ...sources ) : T {\n        for( var i = 0; i < sources.length; i++ ) {\n            const source = sources[ i ];\n            source && fun( dest, source );\n        }\n\n        return dest;\n    }\n}\n\nexport const assign = forAllArgs( ( dest, source ) => {\n    for( var name in source ) {\n        if( source.hasOwnProperty( name ) ) {\n            dest[ name ] = source[ name ];\n        }\n    }\n} );\n\nexport const defaults = forAllArgs( ( dest, source ) => {\n    for( var name in source ) {\n        if( source.hasOwnProperty( name ) && dest[ name ] === void 0 ) {\n             dest[ name ] = source[ name ];\n        }\n    }\n} );\n\nexport function keys( o : any ) : string[]{\n    return o ? Object.keys( o ) : [];\n}\n\nexport function once( func : Function ) : Function {\n    var memo, first = true;\n    return function() {\n        if ( first ) {\n            first = false;\n            memo = func.apply(this, arguments);\n            func = null;\n        }\n        return memo;\n    };\n}\n\n/**\n * notEqual( a, b ) function, for deep JSON comparison\n * Optimized for primitive types\n */\n\nconst ArrayProto = Array.prototype,\n      DateProto = Date.prototype,\n      ObjectProto = Object.prototype;\n\nexport function notEqual( a : any, b : any) : boolean {\n    if( a === b ) return false;\n\n    if( a && b && typeof a == 'object' && typeof b == 'object' ) {\n        const protoA = Object.getPrototypeOf( a );\n\n        if( protoA !== Object.getPrototypeOf( b ) ) return true;\n\n        switch( protoA ){\n            case DateProto   : return +a !== +b;\n            case ArrayProto  : return arraysNotEqual( a, b );\n            case ObjectProto :\n            case null:\n                return objectsNotEqual( a, b );\n        }\n    }\n\n    return true;\n}\n\nfunction objectsNotEqual( a, b ) {\n    const keysA = Object.keys( a );\n\n    if( keysA.length !== Object.keys( b ).length ) return true;\n\n    for( let i = 0; i < keysA.length; i++ ) {\n        const key = keysA[ i ];\n\n        if( !b.hasOwnProperty( key ) || notEqual( a[ key ], b[ key ] ) ) {\n            return true;\n        }\n    }\n\n    return false;\n}\n\nfunction arraysNotEqual( a, b ) {\n    if( a.length !== b.length ) return true;\n\n    for( let i = 0; i < a.length; i++ ) {\n        if( notEqual( a[ i ], b[ i ] ) ) return true;\n    }\n\n    return false;\n}\n\n\nvar numericKeys    = [ 1, 4, 5, 6, 7, 10, 11 ],\n    msDatePattern  = /\\/Date\\(([0-9]+)\\)\\//,\n    isoDatePattern = /^(\\d{4}|[+\\-]\\d{6})(?:-(\\d{2})(?:-(\\d{2}))?)?(?:T(\\d{2}):(\\d{2})(?::(\\d{2})(?:\\.(\\d{3}))?)?(?:(Z)|([+\\-])(\\d{2})(?::(\\d{2}))?)?)?$/;\n\nexport function parseDate( date ) {\n    var msDate, timestamp, struct, minutesOffset = 0;\n\n    if( msDate = msDatePattern.exec( date ) ) {\n        timestamp = Number( msDate[ 1 ] );\n    }\n    else if( ( struct = isoDatePattern.exec( date )) ) {\n        // avoid NaN timestamps caused by undefined values being passed to Date.UTC\n        for( var i = 0, k; ( k = numericKeys[ i ] ); ++i ) {\n            struct[ k ] = +struct[ k ] || 0;\n        }\n\n        // allow undefined days and months\n        struct[ 2 ] = (+struct[ 2 ] || 1) - 1;\n        struct[ 3 ] = +struct[ 3 ] || 1;\n\n        if( struct[ 8 ] !== 'Z' && struct[ 9 ] !== undefined ) {\n            minutesOffset = struct[ 10 ] * 60 + struct[ 11 ];\n\n            if( struct[ 9 ] === '+' ) {\n                minutesOffset = 0 - minutesOffset;\n            }\n        }\n\n        timestamp =\n            Date.UTC( struct[ 1 ], struct[ 2 ], struct[ 3 ], struct[ 4 ], struct[ 5 ] + minutesOffset, struct[ 6 ],\n                      struct[ 7 ] );\n    }\n    else {\n        timestamp = Date.parse( date );\n    }\n\n    return timestamp;\n}\n\n\n\n/** WEBPACK FOOTER **\n ** ./src/objectplus/tools.ts\n **/","import { Record, RecordDefinition, AttributeDescriptorMap } from './transaction.ts'\nimport { assign, defaults, omit, Mixable, ClassDefinition, getBaseClass } from '../objectplus/index.ts'\nimport { compile, AttributesSpec } from './define.ts'\nimport { ChainableAttributeSpec } from './typespec.ts'\n\nimport { TransactionalType } from './nestedTypes.ts'\nimport './basicTypes.ts'\n\nRecord.define = function( protoProps : RecordDefinition, staticProps ){\n    const BaseConstructor : typeof Record = getBaseClass( this ),\n          baseProto : Record = BaseConstructor.prototype;\n\n    if( protoProps ) {\n        // Compile attributes spec, creating definition mixin.\n        const definition = compile( getAttributes( protoProps ), <AttributesSpec> baseProto._attributes );\n\n        // Explicit 'properties' declaration overrides auto-generated attribute properties.\n        if( protoProps.properties === false ){\n            definition.properties = {};\n        }\n\n        assign( definition.properties, protoProps.properties || {} );\n\n        // Merge in definition.\n        defaults( definition, omit( protoProps, 'attributes', 'collection' ) );            \n        Mixable.define.call( this, definition, staticProps );\n        defineCollection.call( this, protoProps && protoProps.collection );\n    }\n\n    return this;\n}\n\nRecord.predefine = function(){\n    Mixable.predefine.call( this );\n\n    this.Collection = getBaseClass( this ).Collection.extend();\n    this.Collection.prototype.model = this;\n\n    return this;\n}\n\nRecord._attribute = TransactionalType;\n\nfunction getAttributes({ defaults, attributes, idAttribute } : RecordDefinition ) : AttributeDescriptorMap {\n    const definition = typeof defaults === 'function' ? (<any>defaults)() : attributes || defaults || {};\n    \n    // If there is an undeclared idAttribute, add its definition as untyped generic attribute.\n    if( idAttribute && !( idAttribute in definition ) ){\n        definition[ idAttribute ] = void 0;\n    }\n\n    return definition;\n}\n\nexport { Record, ChainableAttributeSpec, TransactionalType }\n\nfunction defineCollection( collection : {} ){\n    const BaseCollection = getBaseClass( this ).Collection;\n\n    let CollectionConstructor;\n\n    // If collection constructor is specified, just take it. \n    if( typeof collection === 'function' ) {\n        CollectionConstructor = collection;\n    } \n    // Same when Collection is specified as static class member.  \n    else{\n        CollectionConstructor = this.Collection;\n        if( collection ) (<any>CollectionConstructor).define( collection );\n    }\n\n    // Link collection with the record\n    CollectionConstructor.prototype.model = this;\n    this.Collection = CollectionConstructor;\n}\n\n\n/** WEBPACK FOOTER **\n ** ./src/record/index.ts\n **/","/**\n * Record core implementing transactional updates.\n * The root of all definitions. \n */\n\nimport { assign, isEmpty, Mixable, ClassDefinition, Constructor, log, define } from '../objectplus/index.ts'\n\nimport { begin as _begin, markAsDirty as _markAsDirty, commit, Transactional, Transaction, TransactionOptions, Owner } from '../transactions.ts'\nimport { ChildrenErrors } from '../validation.ts'\n\nconst { trigger3 } = Transactional;\n\n/***************************************************************\n * Record Definition as accepted by Record.define( definition )\n */\n\nexport interface RecordDefinition extends ClassDefinition {\n    attributes? : AttributeDescriptorMap\n    defaults? : AttributeDescriptorMap | ( () => AttributeDescriptorMap )\n    collection? : typeof Transactional | {}\n}\n\nexport interface AttributeDescriptorMap {\n    [ name : string ] : AttributeDescriptor\n}\n\nexport interface AttributeDescriptor {\n    type? : Constructor< any >\n    value? : any\n\n    parse? : AttributeParse\n    toJSON? : AttributeToJSON\n   \n    getHooks? : GetHook[]\n    transforms? : Transform[]\n    changeHandlers? : ChangeHandler[]\n\n    _onChange? : ChangeAttrHandler\n}\n\nexport type GetHook = ( value : any, key : string ) => any;\n\nexport type ChangeAttrHandler = ( ( value : any, attr : string ) => void ) | string;\nexport type Transform = ( next : any, options : TransactionOptions, prev : any, record : Record ) => any;\nexport type ChangeHandler = ( next : any, prev : any, record : Record ) => void;\n\nexport type AttributeToJSON = ( value : any, key : string ) => any\nexport type AttributeParse = ( value : any, key : string ) => any\n\n/*************************************\n * Attribute definitions\n */\nexport interface AttributesValues {\n    id? : string | number \n    [ key : string ] : any\n}\n\nexport type CloneAttributesCtor = new ( x : AttributesValues ) => AttributesValues\n\nexport interface AttributesSpec {\n    [ key : string ] : Attribute\n}\n\nexport interface Attribute extends AttributeUpdatePipeline, AttributeSerialization {\n    clone( value : any ) : any\n    create() : any\n    validate( record : Record, value : any, key : string )\n}\n\nexport interface AttributeUpdatePipeline{\n    canBeUpdated( prev : any, next : any ) : boolean\n    transform : Transform\n    isChanged( a : any, b : any ) : boolean\n    handleChange : ChangeHandler\n}\n\nexport interface AttributeSerialization {\n    toJSON : AttributeToJSON\n    parse : AttributeParse\n}\n\n/*******************************************************\n * Record core implementation\n */\n\ninterface ConstructorOptions extends TransactionOptions{\n    clone? : boolean\n}\n\n// Client unique id counter\nlet _cidCounter : number = 0;\n\n@define({\n    // Default client id prefix \n    cidPrefix : 'm',\n\n    // Default id attribute name\n    idAttribute : 'id',\n    _keys : [ 'id' ]\n})\nexport class Record extends Transactional implements Owner {\n    // Implemented at the index.ts to avoid circular dependency. Here we have just proper singature.\n    static define( protoProps : RecordDefinition, staticProps? ) : typeof Record {\n        return <any>Transactional.define( protoProps, staticProps );\n    }\n\n    static predefine : () => typeof Record\n    static Collection : typeof Transactional\n\n    static defaults( attrs : AttributeDescriptorMap ){\n        return this.extend({ attributes : attrs });\n    }\n    \n    /***********************************\n     * Core Members\n     */\n    // Previous attributes\n    _previousAttributes : {}\n\n    previousAttributes(){ return new this.Attributes( this._previousAttributes ); } \n\n    // Current attributes    \n    attributes : AttributesValues\n\n    // Lazily evaluated changed attributes hash\n    _changedAttributes : AttributesValues\n\n    get changed(){\n        let changed = this._changedAttributes;\n\n        if( !changed ){\n            const prev = this._previousAttributes;\n            changed = {};\n\n            const { _attributes, attributes } = this;\n\n            for( let key of this._keys ){\n                const value = attributes[ key ];\n\n                if( _attributes[ key ].isChanged( value, prev[ key ] ) ){\n                    changed[ key ] = value;\n                }\n            }\n\n            this._changedAttributes = changed;\n        }\n\n        return changed;    \n    }\n\n    changedAttributes( diff? : {} ) : boolean | {} {\n        if( !diff ) return this.hasChanged() ? assign( {}, this.changed ) : false;\n\n        var val, changed : {} | boolean = false,\n            old          = this._transaction ? this._previousAttributes : this.attributes,\n            attrSpecs    = this._attributes;\n\n        for( var attr in diff ){\n            if( !attrSpecs[ attr ].isChanged( old[ attr ], ( val = diff[ attr ] ) ) ) continue;\n            (changed || (changed = {}))[ attr ] = val;\n        }\n\n        return changed;        \n    }\n\n    hasChanged( key? : string ) : boolean {\n        const { _previousAttributes } = this;\n        if( !_previousAttributes ) return false;\n\n        return key ?\n                this._attributes[ key ].isChanged( this.attributes[ key ], _previousAttributes[ key ] ) :\n                !isEmpty( this.changed );\n    }\n\n    previous( key : string ) : any {\n        if( key ){\n            const { _previousAttributes } = this;\n            if( _previousAttributes ) return _previousAttributes[ key ];\n        }\n        \n        return null;\n    }\n\n    isNew() : boolean {\n        return this.id === void 0;\n    }\n\n    has( key : string ) : boolean {\n        return this[ key ] != void 0;\n    }\n\n    unset( key, options? ) {\n        this.set( key, void 0, options );\n        return this; \n    }\n\n    clear( options ){\n        this.transaction( () =>{\n            this.forEachAttr( this.attributes, ( value, key ) => this[ key ] = void 0 );\n        }, options );\n    }\n\n    // Returns Record owner skipping collections. TODO: Move out\n    getOwner() : Owner {\n        const owner : any = this._owner;\n\n        // If there are no key, owner must be transactional object, and it's the collection.\n        // We don't expect that collection can be the member of collection, so we're skipping just one level up. An optimization.\n        return this._ownerKey ? owner : owner && owner._owner;\n    }\n\n    /***********************************\n     * Identity managements\n     */\n\n    // Id attribute name ('id' by default)\n    idAttribute : string;\n\n    // Fixed 'id' property pointing to id attribute\n    get id() : string | number { return this.attributes[ this.idAttribute ]; }\n    set id( x : string | number ){ setAttribute( this, this.idAttribute, x ); }\n\n    /***********************************\n     * Dynamically compiled stuff\n     */\n\n    // Attributes specifications \n    _attributes : AttributesSpec\n\n    // Attribute keys\n    _keys : string[]\n    \n    // Attributes object copy constructor\n//    Attributes : CloneAttributesCtor\n    Attributes( x : AttributesValues ) : void { this.id = x.id; }\n\n    // forEach function for traversing through attributes, with protective default implementation\n    // Overriden by dynamically compiled loop unrolled function in define.ts\n    forEachAttr( attrs : {}, iteratee : ( value : any, key? : string, spec? : Attribute ) => void ) : void {\n        const { _attributes } = this;\n\n        for( let name in attrs ){\n            const spec = _attributes[ name ];\n\n            if( spec ){\n                iteratee( attrs[ name ], name, spec );\n            }\n            else{\n                log.warn( '[Unknown Attribute]', this, 'Unknown record attribute \"' + name + '\" is ignored:', attrs );\n            }\n        }\n\n        // TODO: try this versus object traversal.\n        /*\n        const { _attributes, _keys } = this;\n        \n        for( let name of _keys ){\n            const spec = _attributes[ name ],\n                  value = attrs[ name ];\n\n            value && iteratee( value, name, spec );\n        }*/\n    }\n\n    each( iteratee : ( value? : any, key? : string ) => void, context? : any ){\n        const fun = arguments.length === 2 ? ( v, k ) => iteratee.call( context, v, k ) : iteratee,\n            { attributes, _keys } = this;\n\n        for( const key of _keys ){\n            const value = attributes[ key ];\n            if( value !== void 0 ) fun( value, key );\n        }\n    }\n\n    // Attributes-level serialization\n    _toJSON(){ return {}; }\n\n    // Attributes-level parse\n    _parse( data ){ return data; }\n\n    // Create record default values, optionally augmenting given values.\n    defaults( values? : {} ){ return {}; }\n\n    /***************************************************\n     * Record construction\n     */\n    // Create record, optionally setting an owner\n    constructor( a_values? : {}, a_options? : ConstructorOptions, owner? : Owner ){\n        super( _cidCounter++, owner );\n\n        const options = a_options || {},\n              values = ( options.parse ? this.parse( a_values ) :  a_values ) || {};\n\n        // TODO: type error for wrong object.\n\n        const attributes = options.clone ? cloneAttributes( this, values ) : this.defaults( values ); \n\n        this.forEachAttr( attributes, ( value : any, key : string, attr : AttributeUpdatePipeline ) => {\n            const next = attributes[ key ] = attr.transform( value, options, void 0, this );\n                  attr.handleChange( next, void 0, this );\n        });\n\n        this.attributes = this._previousAttributes = attributes;\n\n        this.initialize( a_values, a_options );\n\n        if( this._localEvents ) this._localEvents.subscribe( this, this );\n    }\n\n    // Initialization callback, to be overriden by the subclasses \n    initialize( values?, options? ){}\n\n    // Deeply clone record, optionally setting new owner.\n    clone( owner? : any ) : this {\n        return new (<any>this.constructor)( this.attributes, { clone : true }, owner );\n    }\n\n    // Validate attributes.\n    _validateNested( errors : ChildrenErrors ) : number {\n        var length    = 0;\n\n        this.forEachAttr( this.attributes, ( value, name, attribute ) => {\n            const error = attribute.validate( this, value, name );\n\n            if( error ){\n                errors[ name ] = error;\n                length++;\n            }\n        } );\n\n        return length;\n    }\n\n    // Get attribute by key\n    get( key : string ) : any {\n        return this[ key ];\n    }\n\n    /**\n     * Serialization control\n     */\n\n    // Default record-level serializer, to be overriden by subclasses \n    toJSON() : Object {\n        const json = {};\n\n        this.forEachAttr( this.attributes, ( value, key : string, { toJSON } : AttributeSerialization ) =>{\n            // If attribute serialization is not disabled, and its value is not undefined...\n            if( toJSON && value !== void 0 ){\n                // ...serialize it according with its spec.\n                json[ key ] = toJSON.call( this, value, key );\n            }\n        });\n\n        return json;\n    }\n    \n    // Default record-level parser, to be overriden by the subclasses.\n    parse( data ){\n        // Call dynamically compiled loop-unrolled attribute-level parse function.\n        return this._parse( data );\n    }\n\n    /**\n     * Transactional control\n     */\n\n    // Polimorphic set method.\n    set( key : string, value : any, options? : TransactionOptions ) : this\n    set( attrs : {}, options? : TransactionOptions ) : this\n    set( a, b?, c? ) : this {\n        if( typeof a === 'string' ){\n            if( c ){\n                return <this> super.set({ [ a ] : b }, c );\n            }\n            else{\n                setAttribute( this, a, b );\n                return this;\n            } \n        }\n        else{\n            return <this> super.set( a, b );\n        }\n    }\n\n    // Need to override it here, since begin/end transaction brackets are overriden. \n    transaction( fun : ( self : this ) => void, options : TransactionOptions = {} ) : void{\n        const isRoot = begin( this );\n        fun.call( this, this );\n        isRoot && commit( this );\n    }\n    \n    // Create transaction. TODO: Move to transaction constructor\n    _createTransaction( a_values : {}, options : TransactionOptions = {} ) : Transaction {\n        const isRoot = begin( this ),\n              changes : string[] = [],\n              nested : RecordTransaction[]= [],\n              { attributes } = this,\n              values = options.parse ? this.parse( a_values ) : a_values,\n              merge = !options.reset;\n\n        if( Object.getPrototypeOf( values ) === Object.prototype ){\n            this.forEachAttr( values, ( value, key : string, attr : AttributeUpdatePipeline ) => {\n                const prev = attributes[ key ];\n\n                // handle deep update...\n                if( merge && attr.canBeUpdated( prev, value ) ) { // todo - skip empty updates.\n                    const nestedTransaction = prev._createTransaction( value, options );\n                    if( nestedTransaction ){\n                        nested.push( nestedTransaction );\n                        changes.push( key );\n                    }\n\n                    return;\n                }\n\n                // cast and hook...\n                const next = attr.transform( value, options, prev, this );\n                attributes[ key ] = next;\n\n                if( attr.isChanged( next, prev ) ) {    \n                    changes.push( key );\n\n                    // Do the rest of the job after assignment\n                    attr.handleChange( next, prev, this );\n                }\n            } );\n        }\n        else{\n            log.error( '[Type Error]', this, 'Record update rejected (', values, '). Incompatible type.' );\n        }\n\n        if( ( nested.length || changes.length ) && markAsDirty( this, options ) ){\n            return new RecordTransaction( this, isRoot, nested, changes );\n        }\n        \n        // No changes\n        isRoot && commit( this );\n    }\n\n    // Handle nested changes\n    _onChildrenChange( child : Transactional, options : TransactionOptions ) : void {        \n        this.forceAttributeChange( child._ownerKey, options );\n    }\n\n    // Simulate attribute change \n    forceAttributeChange( key : string, options : TransactionOptions = {} ){\n        // Touch an attribute in bounds of transaction\n        const isRoot = begin( this );\n\n        if( markAsDirty( this, options ) ){\n            trigger3( this, 'change:' + key, this, this.attributes[ key ], options );\n        }\n        \n        isRoot && commit( this );\n    }\n\n    // Returns owner without the key (usually it's collection)\n    get collection() : any {\n        return this._ownerKey ? null : this._owner;\n    }\n\n    // Dispose object and all childrens\n    dispose(){\n        this.forEachAttr( this.attributes, ( value, key ) => {\n            if( value && this === value._owner ){\n                value.dispose();\n            }\n        });\n\n        super.dispose();\n    }\n};\n\n/***********************************************\n * Helper functions\n */\n\nfunction begin( record : Record ){\n    if( _begin( record ) ){\n        record._previousAttributes = new record.Attributes( record.attributes );\n        record._changedAttributes = null;\n        return true;\n    }\n    \n    return false;\n}\n\nfunction markAsDirty( record : Record, options : TransactionOptions ){\n    // Need to recalculate changed attributes, when we have nested set in change:attr handler\n    if( record._changedAttributes ){\n        record._changedAttributes = null;\n    }\n\n    return _markAsDirty( record, options );\n}\n\n// Deeply clone record attributes\nfunction cloneAttributes( record : Record, a_attributes : AttributesValues ) : AttributesValues {\n    const attributes = new record.Attributes( a_attributes );\n\n    record.forEachAttr( attributes, function( value, name, attr : Attribute ){\n        attributes[ name ] = attr.clone( value ); //TODO: Add owner?\n    } );\n\n    return attributes;\n}\n\n // Optimized single attribute transactional update. To be called from attributes setters\n // options.silent === false, parse === false. \nexport function setAttribute( record : Record, name : string, value : any ) : void {\n    const isRoot  = begin( record ),\n          options = {},\n        { attributes } = record,\n          spec = record._attributes[ name ],\n          prev = attributes[ name ];\n\n    // handle deep update...\n    if( spec.canBeUpdated( prev, value ) ) {\n        const nestedTransaction = ( <Transactional> prev )._createTransaction( value, options );\n        if( nestedTransaction ){\n            nestedTransaction.commit( true );\n            markAsDirty( record, options );\n            trigger3( record, 'change:' + name, record, prev, options );\n        }\n    }\n    else {\n        // cast and hook...\n        const next = spec.transform( value, options, prev, record );\n\n        attributes[ name ] = next;\n\n        if( spec.isChanged( next, prev ) ) {\n            // Do the rest of the job after assignment\n            spec.handleChange( next, prev, record );\n\n            markAsDirty( record, options );\n            trigger3( record, 'change:' + name, record, next, options );\n        }\n    }\n\n    isRoot && commit( record );\n}\n\n// Transaction class. Implements two-phase transactions on object's tree. \n// Transaction must be created if there are actual changes and when markIsDirty returns true. \nclass RecordTransaction implements Transaction {\n    // open transaction\n    constructor( public object : Record,\n                 public isRoot : boolean,\n                 public nested : Transaction[],\n                 public changes : string[] ){}\n\n    // commit transaction\n    commit( isNested? : boolean ) : void {\n        const { nested, object, changes } = this;\n\n        // Commit all pending nested transactions...\n        for( let transaction of nested ){ \n            transaction.commit( true );\n        }\n\n        // Notify listeners on attribute changes...\n        // Transaction is never created when silent option is set, so just send events out.\n        const { attributes, _isDirty } = object;\n        for( let key of changes ){\n            trigger3( object, 'change:' + key, object, attributes[ key ], _isDirty );\n        }\n\n        this.isRoot && commit( object, isNested );\n    }\n}\n\n\n/** WEBPACK FOOTER **\n ** ./src/record/transaction.ts\n **/","export * from './tools.ts'\nexport * from './mixins.ts'\nexport * from './events.ts'\n\n\n/** WEBPACK FOOTER **\n ** ./src/objectplus/index.ts\n **/","/**\n * Mixins and @define metaprogramming class extensions\n * \n * Vlad Balin & Volicon, (c) 2016\n */\nimport { log, assign, omit, getPropertyDescriptor, getBaseClass, defaults, transform } from './tools.ts'\n\n/**\n * Class definition recognized by `define`\n */\nexport interface ClassDefinition {\n    properties? : PropertyMap | boolean\n    mixins? : Mixin[]\n    mixinRules? : MixinRules\n    [ name : string ] : any\n}\n\ninterface PropertyMap {\n    [ name : string ] : Property\n}\n\ntype Property = PropertyDescriptor | ( () => any )\n\ntype Mixin = Constructor< any > | {}\n\ninterface MixinRules {\n    [ propertyName : string ] : MergeRule | MixinRules\n}\n\ntype MergeRule = 'merge' | 'pipe' | 'sequence' | 'reverse' | 'every' | 'some'\n\n\ndeclare function __extends( a, b )\n\n/**\n *  Generic interface to reference constructor function type for any given T. \n */\nexport interface Constructor< T >{\n    new ( ...args : any[] ) : T\n}\n\n/**\n * Generic interface to reference constructor function of any Mixable type T.\n */\nexport interface MixableConstructor< T > extends Constructor< T >{\n\n    prototype : Mixable\n    create( a : any, b? : any, c? : any ) : Mixable\n    mixins( ...mixins : ( Constructor<any> | {} )[] ) : MixableConstructor< T >\n    mixinRules( mixinRules : MixinRules ) : MixableConstructor< T >\n    mixTo( ...args : Constructor<any>[] ) : MixableConstructor< T >\n    define( definition : ClassDefinition, staticProps? : {} ) : MixableConstructor< T >\n    extend(spec? : ClassDefinition, statics? : {} ) : MixableConstructor< T >\n    predefine() : MixableConstructor< T >\n}\n\n/**\n * Base class, holding metaprogramming class extensions.\n * Supports mixins, and Class.define metaprogramming method.\n */ \nexport class Mixable {\n\n    // Generic class factory. May be overridden for abstract classes. Not inherited.\n    static create( a : any, b? : any, c? : any ) : Mixable {\n        return new (<any>this)( a, b, c );\n    }\n\n    protected static _mixinRules : MixinRules = { properties : 'merge' };\n\n    /**\n     * Attach the sequence of mixins to the class prototype.\n     * \n     * ```javascript\n     *    MyMixableClass.mixins( plainObjMixin, OtherConstructor, ... );\n     *    MyOtherClass.mixins([ plainObjMixin, OtherConstructor, ... ]); \n     * ```\n     */\n    static mixins( ...mixins : ( Mixin | Mixin[] )[] ) : typeof Mixable {\n        const proto      = this.prototype,\n              mergeRules : MixinRules = this._mixinRules || {};\n\n        // Apply mixins in sequence...\n        for( let mixin of mixins ) {\n            // Mixins array should be flattened. \n            if( mixin instanceof Array ) {\n                Mixable.mixins.apply( this, mixin );\n            }\n            // For constructors, merge _both_ static and prototype members.\n            else if( typeof mixin === 'function' ){\n                // Statics are merged by simple substitution.\n                defaults( this, mixin );\n\n                // Prototypes are merged according with a rules.\n                mergeProps( proto, (<Constructor<any>>mixin).prototype, mergeRules );\n            }\n            // Handle plain object mixins.\n            else {\n                mergeProps( proto, mixin, mergeRules );\n            }\n        }\n\n        return this;\n    }\n\n    // Inversion of control version of Class.mixin.\n    static mixTo< T >( ...args : Function[] ) : typeof Mixable {\n        for( let Ctor of args ) {\n            Mixable.mixins.call( Ctor, this );\n        }\n\n        return this;\n    }\n\n    // Members merging policy is controlled by MyClass.mixinRules property.\n    // mixinRules are properly inherited and merged.\n    static mixinRules( mixinRules : MixinRules ) : MixableConstructor< Mixable > {\n        const Base = Object.getPrototypeOf( this.prototype ).constructor;\n\n        if( Base._mixinRules ) {\n            mergeProps( mixinRules, Base._mixinRules );\n        }\n\n        this._mixinRules = mixinRules;\n        return this;\n    }\n\n    /**\n     * Main metaprogramming method. May be overriden in subclasses to customize the behavior.   \n     * - Merge definition to the prototype.\n     * - Add native properties with descriptors from spec.properties to the prototype.\n     * - Prevents inheritance of 'create' factory method.\n     * - Assign mixinRules static property, and merge it with parent.\n     * - Adds mixins.\n     */\n    static define( definition : ClassDefinition = {}, staticProps? : {} ) : typeof Mixable {\n        // That actually might happen when we're using @define decorator... \n        if( !this.define ){\n            log.error( \"[Class.define] Class must have class extensions to use @define decorator. Use '@extendable' before @define, or extend the base class with class extensions.\", definition );\n            return this;\n        }\n\n        this.predefine();\n\n        // Obtain references to prototype and base class.\n        const proto = this.prototype;\n\n        // Extract prototype properties from the definition.\n        const protoProps = omit( definition, 'properties', 'mixins', 'mixinRules' ),\n            { properties = <PropertyMap> {}, mixins, mixinRules } = definition;\n\n        // Update prototype and statics.\n        assign( proto, protoProps );\n        assign( this, staticProps );\n\n        // Define native properties.\n        properties && Object.defineProperties( proto, transform( {}, <PropertyMap>properties, toPropertyDescriptor ) );\n\n        // Apply mixins and mixin rules.\n        mixinRules && this.mixinRules( mixinRules );\n        mixins && this.mixins( mixins );\n\n        return this;\n    }\n\n    // Backbone-compatible extend method to be used in ES5 and for backward compatibility\n    static extend(spec? : ClassDefinition, statics? : {} ) : typeof Mixable {\n        let Subclass : typeof Mixable;\n\n        // 1. Create the subclass (ES5 compatibility shim).\n        // If constructor function is given...\n        if( spec && spec.hasOwnProperty( 'constructor' ) ){\n            // ...we need to manually call internal TypeScript __extend function. Hack! Hack!\n            Subclass = <any>spec.constructor; \n            __extends( Subclass, this );\n        }\n        // Otherwise, create the subclall in usual way.\n        else{\n            Subclass = class Subclass extends this {};\n        }\n\n        // 2. Apply definitions\n        return spec ? Subclass.define( spec, statics ) : Subclass.predefine();\n    }\n\n    // Do the magic necessary for forward declarations.\n    // Must be written in the way that it's safe to call twice.\n    static predefine() : typeof Mixable {\n        const BaseClass : typeof Mixable = getBaseClass( this );\n\n        // Make sure we don't inherit class factories.\n        if( BaseClass.create === this.create ) {\n            this.create = Mixable.create;\n        }\n\n        return this;\n    }\n}\n\nfunction toPropertyDescriptor( x : Property ) : PropertyDescriptor {\n    if( x ){\n        return typeof x === 'function' ? { get : < () => any >x } : <PropertyDescriptor> x;\n    }\n}\n\n// @mixinRules({ ... }) decorator\nexport function mixinRules( rules : MixinRules ) {\n    return createDecorator( 'mixinRules', rules );\n}\n\n// @mixins( A, B, C ) decorator\nexport function mixins( ...list : {}[] ) {\n    return createDecorator( 'mixins', list );\n}\n\n// @extendable decorator. Convert class to be an ExtendableConstructor.\nexport function extendable( Type : Function ) : void {\n    Mixable.mixTo( Type );\n}\n\n// @predefine decorator for forward definitions. \nexport function predefine( Constructor : MixableConstructor< any > ) : void {\n    Constructor.predefine();\n}\n\n// @define decorator for metaprogramming magic.\nexport function define( spec : ClassDefinition ){\n    return createDecorator( 'define', spec );\n} \n\n// Create ES7 class decorator forwarding call to the static class member.\n// If there is no such a member, forward the call to Class.\nfunction createDecorator( name : string, spec : {} ){\n    return function( Ctor : Function ) : void {\n        if( Ctor[ name ] ) {\n            Ctor[ name ]( spec );\n        }\n        else {\n            Mixable[ name ].call( Ctor, spec );\n        }\n    }\n}\n\n/***********************\n * Mixins helpers\n */\nfunction mergeObjects( a : {}, b : {}, rules? : MixinRules ) : {} {\n    const x = assign( {}, a );\n    return mergeProps( x , b, rules );\n}\n\ninterface IMergeFunctions {\n    [ name : string ] : ( a : Function, b : Function ) => Function\n}\n\nconst mergeFunctions : IMergeFunctions = {\n    pipe< A, B, C >( a: ( x : B ) => C, b : ( x : A ) => B ) : ( x : A ) => C {\n        return function( x : A ) : C {\n            return a.call( this, b.call( this, x ) );\n        }\n    },\n\n    sequence( a : Function, b : Function ){\n        return function() : void {\n            a.apply( this, arguments );\n            b.apply( this, arguments );\n        }\n    },\n\n    reverse( a : Function, b : Function ){\n        return function() : void {\n            b.apply( this, arguments );\n            a.apply( this, arguments );\n        }\n    },\n\n    every( a : Function, b : Function ){\n        return function() {\n            return a.apply( this, arguments ) && b.apply( this, arguments );\n        }\n    },\n\n    some( a : Function, b : Function ){\n        return function() {\n            return a.apply( this, arguments ) || b.apply( this, arguments );\n        }\n    }\n};\n\nfunction mergeProps< T extends {} >( target : T, source : {}, rules : MixinRules = {}) : T {\n    for( let name of Object.keys( source ) ) {\n        const sourceProp = Object.getOwnPropertyDescriptor( source, name ),\n              destProp   = getPropertyDescriptor( target, name ); // Shouldn't be own\n\n        if( destProp ) {\n            const rule  = rules[ name ],\n                  value = destProp.value;\n\n            if( rule && value ) {\n                target[ name ] = typeof rule === 'object' ?\n                    mergeObjects( value, sourceProp.value, rule ) :(\n                        rule === 'merge' ?\n                            mergeObjects( value, sourceProp.value ) :\n                            mergeFunctions[ rule ]( value, sourceProp.value )\n                    );\n            }\n        }\n        else {\n            Object.defineProperty( target, name, sourceProp );\n        }\n    }\n\n    return target;\n}\n\n\n/** WEBPACK FOOTER **\n ** ./src/objectplus/mixins.ts\n **/","import Mixins = require( './mixins.ts' )\nimport Tools = require( './tools.ts' );\nimport EventMaps = require( './eventmaps.ts' );\nimport { EventMap, EventsDefinition } from './eventmaps.ts'\n\nconst { mixins, define, extendable } = Mixins;\nconst { omit, once, isEmpty, keys } = Tools;\nconst { EventHandler, trigger0, trigger1, trigger2, trigger3 } = EventMaps;\n\n// Regular expression used to split event strings.\nconst eventSplitter = /\\s+/;\n\nlet _idCount = 0;\n\nfunction uniqueId(){\n    return 'l' + _idCount++;\n}\n\n/*************************\n * Messenger is extendable class with capabilities of sending and receiving messages.\n * This class itself can serve as both mixin and base class\n */\nexport { EventMap, EventsDefinition }\n\nexport interface MessengerDefinition extends Mixins.ClassDefinition {\n    _localEvents? : EventMap\n    localEvents? : EventsDefinition\n}\n\n// Attach default cid prefix to the prototype.\n@define({\n    cidPrefix : 'l'\n})\n@extendable\nexport abstract class Messenger implements Mixins.Mixable {\n    // High-performance API to be used in the library core.\n    static trigger0 = EventMaps.trigger0\n    static trigger1 = EventMaps.trigger1\n    static trigger2 = EventMaps.trigger2\n    static trigger3 = EventMaps.trigger3\n    static on = EventMaps.on\n    static off = EventMaps.off\n\n    _events : EventMaps.SubscribedEvents = {};\n    _listeners : Listeners\n    _listeningTo : ListeningToMap\n    cidPrefix : string\n    cid : string\n\n    static create : ( a : any, b? : any, c? : any ) => Messenger\n    static extend : ( a? : any, b? : any ) => typeof Messenger\n\n    // Prototype-only property to manage automatic local events subscription.\n    _localEvents : EventMaps.EventMap\n\n    static define( protoProps? : MessengerDefinition , staticProps? ){\n        const spec : MessengerDefinition = omit( protoProps || {}, 'localEvents' );\n\n        if( protoProps ){\n            const { localEvents, _localEvents } = protoProps;\n            if( localEvents || _localEvents ){\n                const eventsMap = new EventMap( this.prototype._localEvents );\n                localEvents && eventsMap.addEventsMap( localEvents );\n                _localEvents && eventsMap.merge( _localEvents );\n                spec._localEvents = eventsMap;\n            }\n        }\n\n        return Mixins.Mixable.define.call( this, spec, staticProps );\n    }\n\n    constructor( cid : string | number ){\n        this.cid = this.cidPrefix + cid;\n    }\n    \n    // Bind an event to a `callback` function. Passing `\"all\"` will bind\n    // the callback to all events fired.\n    on(name, callback, context) {\n        return internalOn(this, name, callback, context);\n    }\n    // Remove one or many callbacks. If `context` is null, removes all\n    // callbacks with that function. If `callback` is null, removes all\n    // callbacks for the event. If `name` is null, removes all bound\n    // callbacks for all events.\n    off(name? : string, callback? : Function, context? ) {\n        if (!this._events) return this;\n        this._events = eventsApi(offApi, this._events, name, callback,\n                                new OffOptions(\n                                    context,\n                                    this._listeners )\n                                );\n        return this;\n    }\n\n    // Tell this object to stop listening to either specific events ... or\n    // to every object it's currently listening to.\n    stopListening( obj? : Messenger, name? : string, callback? : Function ) {\n        const listeningTo = this._listeningTo;\n        if (!listeningTo) return this;\n\n        const ids = obj ? [obj.cid] : keys(listeningTo);\n\n        for (let i = 0; i < ids.length; i++) {\n            const listening = listeningTo[ids[i]];\n\n            // If listening doesn't exist, this object is not currently\n            // listening to obj. Break out early.\n            if (!listening) break;\n\n            listening.obj.off(name, callback, this);\n        }\n        if (isEmpty(listeningTo)) this._listeningTo = void 0;\n\n        return this;\n    }\n\n    // Inversion-of-control versions of `on`. Tell *this* object to listen to\n    // an event in another object... keeping track of what it's listening to\n    // for easier unbinding later.\n    listenTo(obj : Messenger, name, callback? ) {\n        if( !obj ) return this;\n        \n        const id = obj.cid || (obj.cid = uniqueId()),\n              listeningTo = this._listeningTo || (this._listeningTo = {});\n\n        let listening = listeningTo[id];\n\n        // This object is not listening to any other events on `obj` yet.\n        // Setup the necessary references to track the listening callbacks.\n        if (!listening) {\n            const thisId = this.cid || (this.cid = uniqueId());\n            listening = listeningTo[id] = new ListeningTo( obj, id, thisId, listeningTo );\n        }\n\n        // Bind callbacks on obj, and keep track of them on listening.\n        internalOn( obj, name, callback, this, listening );\n        return this;\n    }\n\n    // Bind an event to only be triggered a single time. After the first time\n    // the callback is invoked, its listener will be removed. If multiple events\n    // are passed in using the space-separated syntax, the handler will fire\n    // once for each event, not once for a combination of all events.\n    once(name, callback, context) {\n        // Map the event into a `{event: once}` object.\n        const events = eventsApi(onceMap, {}, name, callback, this.off.bind( this ));\n        return this.on(events, void 0, context);\n    }\n\n    // Inversion-of-control versions of `once`.\n    listenToOnce(obj : Messenger, name, callback) {\n        // Map the event into a `{event: once}` object.\n        const events = eventsApi(onceMap, {}, name, callback, this.stopListening.bind( this, obj ) );\n        return this.listenTo(obj, events);\n    }\n\n    // Trigger one or many events, firing all bound callbacks. Callbacks are\n    // passed the same arguments as `trigger` is, apart from the event name\n    // (unless you're listening on `\"all\"`, which will cause your callback to\n    // receive the true name of the event as the first argument).\n    trigger(name : string, a?, b?, c? ) : this {\n        if( !this._events ) return this;\n\n        switch( arguments.length ){\n            // Forward call to monomorphic fast-path functions.\n            case 1 : trigger0( this, name ); break;\n            case 2 : trigger1( this, name, a ); break;\n            case 3 : trigger2( this, name, a, b ); break;\n            case 4 : trigger3( this, name, a, b, c ); break;\n            \n            // Trigger event with more than 3 arguments.\n            default :\n                // Passing arguments around killing performance. Convert it to array.\n                const allArgs = Array( arguments.length );\n                \n                for( let i = 0; i < allArgs.length; i++ ){\n                    allArgs[ i ] = arguments[ i ];\n                }\n\n                // Send events.\n                const { _events } = this;\n                let queue = _events[ name ];\n\n                if( queue ) _fireEventAll( queue, allArgs.splice( 0, 1 ) );\n                if( queue = _events.all ) _fireEventAll( queue, allArgs );                      \n        }\n\n        return this;\n    }\n\n    dispose() : void {\n        this.stopListening();\n        this.off();\n    }\n}\n\nconst slice = Array.prototype.slice;\n\nexport const Events = Messenger.prototype;\n\n// Iterates over the standard `event, callback` (as well as the fancy multiple\n// space-separated events `\"change blur\", callback` and jQuery-style event\n// maps `{event: callback}`).\nfunction eventsApi(iteratee, events, name, callback, opts) {\n    let i = 0, names;\n    if (name && typeof name === 'object') {\n        // Handle event maps.\n        if (callback !== void 0 && 'context' in opts && opts.context === void 0) opts.context = callback;\n        for (names = keys(name); i < names.length ; i++) {\n            events = eventsApi(iteratee, events, names[i], name[names[i]], opts);\n        }\n    } else if (name && eventSplitter.test(name)) {\n        // Handle space separated event names by delegating them individually.\n        for (names = name.split(eventSplitter); i < names.length; i++) {\n            events = iteratee(events, names[i], callback, opts);\n        }\n    } else {\n        // Finally, standard events.\n        events = iteratee(events, name, callback, opts);\n    }\n    return events;\n};\n\nclass ListeningTo {\n    count : number = 0\n    constructor( public obj, public objId, public id, public listeningTo ){}\n}\n\ninterface ListeningToMap {\n    [ id : string ] : ListeningTo\n}\n\ninterface Listeners {\n    [ id : string ] : Messenger\n}\n\n// Guard the `listening` argument from the public API.\nfunction internalOn(obj : Messenger, name, callback, context, listening? ) : Messenger {\n    obj._events = eventsApi(onApi, obj._events || {}, name,\n                            callback, new EventHandler( context, obj, listening));\n\n    if (listening) {\n        const listeners = obj._listeners || (obj._listeners = {});\n        listeners[listening.id] = listening;\n    }\n\n    return obj;\n};\n\n// The reducing API that adds a callback to the `events` object.\nfunction onApi(events : EventMaps.SubscribedEvents, name : string, callback : Function, options) : EventMaps.SubscribedEvents {\n    if (callback) {\n        const handlers = events[name],\n              toAdd = [ options.clone( callback ) ];\n            \n        events[name] = handlers ? handlers.concat( toAdd ) : toAdd;\n    }\n    \n    return events;\n};\n\nclass OffOptions {\n    constructor( public context, public listeners : Listeners ){}\n}\n\n// The reducing API that removes a callback from the `events` object.\nfunction offApi(events : EventMaps.SubscribedEvents, name, callback, options : OffOptions ) {\n    if (!events) return;\n\n    let i = 0, listening;\n    const context = options.context, listeners = options.listeners;\n\n    // Delete all events listeners and \"drop\" events.\n    if (!name && !callback && !context) {\n        const ids = keys(listeners);\n        for (; i < ids.length; i++) {\n            listening = listeners[ids[i]];\n            delete listeners[listening.id];\n            delete listening.listeningTo[listening.objId];\n        }\n        return {};\n    }\n\n    const names = name ? [name] : keys(events);\n    for (; i < names.length; i++) {\n        name = names[i];\n        const handlers = events[name];\n\n        // Bail out if there are no events stored.\n        if (!handlers) break;\n\n        // Replace events if there are any remaining.  Otherwise, clean up.\n        const remaining = [];\n        for (let j = 0; j < handlers.length; j++) {\n            const handler = handlers[j];\n            if (\n                callback && callback !== handler.callback &&\n                callback !== handler.callback._callback ||\n                context && context !== handler.context\n            ) {\n                remaining.push(handler);\n            } else {\n                listening = handler.listening;\n                if (listening && --listening.count === 0) {\n                    delete listeners[listening.id];\n                    delete listening.listeningTo[listening.objId];\n                }\n            }\n        }\n\n        // Update tail event if the list has any events.  Otherwise, clean up.\n        if (remaining.length) {\n            events[name] = remaining;\n        } else {\n            delete events[name];\n        }\n    }\n    return events;\n};\n\n// Reduces the event callbacks into a map of `{event: onceWrapper}`.\n// `offer` unbinds the `onceWrapper` after it has been called.\nfunction onceMap(map, name, callback, offer) {\n    if (callback) {\n        const _once : EventMaps.Callback = map[name] = once(function() {\n            offer(name, _once);\n            callback.apply(this, arguments);\n        });\n        _once._callback = callback;\n    }\n    return map;\n};\n\nfunction _fireEventAll( events : EventMaps.EventHandler[], a ) : void {\n    for( let ev of events )\n        ev.callback.call( ev.ctx, a );\n}\n\n\n/** WEBPACK FOOTER **\n ** ./src/objectplus/events.ts\n **/","import { Traversable, CompiledReference } from './traversable.ts'\n\nexport const eventSplitter = /\\s+/;\n\nexport interface EventsCore {\n    _events : SubscribedEvents\n}\n\nexport interface SubscribedEvents {\n    all? : EventHandler[]\n    [ name : string ] : EventHandler[]\n}\n\nexport class EventHandler {\n    constructor(\n        public context,\n        public ctx,\n        public listening : any,\n        public callback? : Callback\n    ){}\n\n    clone( callback ){\n        const { context, listening } = this;\n        if (listening) listening.count++;\n        return new EventHandler( context, context || this.ctx, listening, callback );\n    }\n}\n\nexport interface Callback extends Function{\n    _callback? : any\n}\n\n/*******************\n * Prebuilt events map, used for optimized bulk event subscriptions.\n * \n * const events = new EventMap({\n *      'change' : true, // resend this event from target\n *      'change:attr' : 'localTargetFunction',\n *      'executedInTargetContext' : function(){ ... }\n *      'executedInNativeContext' : '^props.handler' \n * })\n */\nexport interface EventsDefinition {\n    [ events : string ] : Function | string | boolean\n}\n\nexport class EventMap {\n    handlers : EventDescriptor[] = [];\n\n    constructor( map? : EventsDefinition | EventMap ){\n        if( map ){\n            if( map instanceof EventMap ){\n                this.handlers = map.handlers.slice();\n            }\n            else{\n                map && this.addEventsMap( map );\n            }\n        }\n    }\n\n    merge( map : EventMap ){\n        this.handlers = this.handlers.concat( map.handlers );\n    }\n\n    addEventsMap( map : EventsDefinition ){\n        for( let names in map ){\n            this.addEvent( names, map[ names ] )\n        }\n    }\n\n    bubbleEvents( names : string ){\n        for( let name of names.split( eventSplitter ) ){\n            this.addEvent( name, getBubblingHandler( name ) );\n        }\n    }\n\n    addEvent( names : string, callback : Function | string | boolean ){\n        const { handlers } = this;   \n        \n        for( let name of names.split( eventSplitter ) ){\n            handlers.push( new EventDescriptor( name, callback ) );\n        }        \n    }\n\n    subscribe( target : Traversable, source : EventsCore ){\n        const { _events } = source;\n        for( let event of this.handlers ){\n            _on( _events, event.name, event.callback, target );\n        }\n    }\n\n    unsubscribe( target : Traversable, source : EventsCore ){\n        const { _events } = source;\n        for( let event of this.handlers ){\n            _off( _events, event.name, event.callback, target );\n        }\n    }\n}\n\nclass EventDescriptor {\n    callback : Function\n\n    constructor(\n        public name : string,\n        callback : Function | string | boolean\n    ){\n        if( callback === true ){\n            this.callback = getBubblingHandler( name );\n        }\n        else if( typeof callback === 'string' ){\n            const { local, resolve, tail } = new CompiledReference( callback, true );\n            this.callback = local ? (\n                function localCallback(){\n                    const handler = this[ tail ]; \n                    handler && handler.apply( this, arguments );\n                }\n            ) : (\n                function referenceCallback(){\n                    const context = resolve( this );\n                    if( context ){\n                        const handler = context[ tail ];\n                        if( handler ){\n                            handler.apply( context, arguments );\n                        } \n                    }\n                }\n            );\n        }\n        else{\n            this.callback = <Function>callback;\n        }\n    }\n}\n\n/****************************\n * Subscription API \n */\n\nexport function on( self : EventsCore, name : string, callback : Function, context? ){\n    _on( self._events, name, callback, context );\n}\n\nexport function off( self : EventsCore, name : string, callback : Function, context : {} ){\n    _off( self._events, name, callback, context );\n}\n\n/*********************************\n * Event-triggering API \n */\nexport function trigger0( self : EventsCore, name : string ) : void {\n    const { _events } = self,\n          queue = _events[ name ],\n          { all } = _events;\n\n    if( queue ) _fireEvent0( queue );\n    if( all ) _fireEvent1( all, name );\n};\n\nexport function trigger1( self : EventsCore, name : string, a : any ) : void {\n    const { _events } = self,\n            queue = _events[ name ],\n          { all } = _events;\n\n    if( queue ) _fireEvent1( queue, a );\n    if( all ) _fireEvent2( all, name, a );\n};\n\nexport function trigger2( self : EventsCore, name : string, a, b ) : void {\n    const { _events } = self,\n            queue = _events[ name ],\n          { all } = _events;\n\n    if( queue ) _fireEvent2( queue, a, b );\n    if( all ) _fireEvent3( all, name, a, b );\n};\n\nexport function trigger3( self : EventsCore, name : string, a, b, c ) : void{\n    const { _events } = self,\n            queue = _events[ name ],\n          { all } = _events;\n\n    if( queue ) _fireEvent3( queue, a, b, c );\n    if( all ) _fireEvent4( all, name, a, b, c );\n};\n\n// Specialized functions with events triggering loops.\n// JS JIT loves these small functions and code duplication.\nfunction _fireEvent0( events : EventHandler[] ) : void {\n    for( let ev of events )\n        ev.callback.call( ev.ctx );\n}\n\nfunction _fireEvent1( events : EventHandler[], a ) : void {\n    for( let ev of events )\n        ev.callback.call( ev.ctx, a );\n}\n\nfunction _fireEvent2( events : EventHandler[], a, b ) : void {\n    for( let ev of events )\n        ev.callback.call( ev.ctx, a, b );\n}\n\nfunction _fireEvent3( events : EventHandler[], a, b, c ) : void {\n    for( let ev of events )\n        ev.callback.call( ev.ctx, a, b, c );\n}\n\nfunction _fireEvent4( events : EventHandler[], a, b, c, d ) : void {\n    for( let ev of events )\n        ev.callback.call( ev.ctx, a, b, c, d );\n}\n\n// Subscrive for the single event\nfunction _on( _events : SubscribedEvents, name : string, callback : Function, context : Object, ctx? : Object ){\n    const events = _events[ name ],\n          handler = new EventHandler( context, ctx || context, null, callback );\n\n    if( events ){\n        events.push( handler );\n    }\n    else{\n        _events[ name ] = [ handler ];\n    }\n};\n\n// Remove all events with a given name and context, or callback, if its provided. \nfunction _off( _events : SubscribedEvents, name : string, callback : Function, context : {} ) {\n    const events = _events[ name ];\n\n    if( events ) {\n        const retain = [];\n\n        for ( let ev of events ) {\n            if( ( callback && callback !== ev.callback ) || context !== ev.context ) {\n                retain.push(ev);\n            }\n        }\n\n        _events[ name ] = retain.length ? retain : void 0;\n    }\n};\n\nconst _bubblingHandlers = {};\n\nfunction getBubblingHandler( event : string ){\n    return _bubblingHandlers[ event ] || (\n        _bubblingHandlers[ event ] = function( a, b, c ){\n            switch( arguments.length ){\n                // Forward call to monomorphic fast-path functions.\n                case 0 : trigger0( this, event ); break;\n                case 1 : trigger1( this, event, a ); break;\n                case 2 : trigger2( this, event, a, b ); break;\n                case 3 : trigger3( this, event, a, b, c ); break;\n                default :\n                    const args = [ event, a, b, c ];\n\n                    for( let i = 3; i < arguments.length; i++ ){\n                        args.push( arguments[ i ] );\n                    }\n\n                    this.trigger.apply( this, args );\n            }\n        }\n    );\n}\n\n\n/** WEBPACK FOOTER **\n ** ./src/objectplus/eventmaps.ts\n **/","/**\n * Some sketches for reference resolution.\n *\n * \n * a : Model.from( '~collection' )\n * \n * We need two functions. One for get, and one for compile. \n */\nexport interface Traversable {\n    getStore() : Traversable\n    getOwner() : Traversable\n    get( key : string ) : any \n}\n\nconst referenceMask =  /\\~|\\^|([^.]+)/g;\n\n// Compile reference to function\n\nexport class CompiledReference {\n    resolve : ( root : Traversable ) => any\n    tail : string\n    local : boolean\n\n    constructor( reference : string, splitTail : boolean = false ){\n        const path = reference\n                        .match( referenceMask )\n                        .map( key => key === '~' ? 'getStore()' : ( key === '^' ? 'getOwner()' : key ) );\n               \n        this.tail = splitTail && path.pop();\n        this.local = !path.length;\n\n        path.unshift( 'self' );\n        \n        this.resolve = <any> new Function( 'self', `return ${ path };` );\n    }\n}\n\nexport function resolveReference( root : Traversable, reference : string, action : ( object, key : string ) => any ) : any {\n    const path = reference.match( referenceMask ),\n          skip = path.length - 1;\n    \n    let self = root;\n\n    for( var i = 0; i < skip; i++ ){\n        const key = path[ i ];\n        switch( key ){\n            case '~' : self = self.getStore(); break;\n            case '^' : self = self.getOwner(); break;\n            default  : self = self.get( key );\n        }\n\n        // Do nothing if object on the path doesn't exist.\n        if( !self ) return;\n    }\n\n    action( self, path[ skip ] );\n    return self;\n}\n\n// Construct object reference { a : { b : { c : 0 } } }\nexport function referenceToObject( reference, value ){\n    const path = reference.split( '.' ),\n          root = {},\n          last = path.length - 1;\n    let current = root;\n\n    for( let i = 0; i < last; i++ ){\n        current = current[ path[ i ] ] = {};\n    }\n\n    current[ path[ last ] ] = value;\n\n    return root;\n}\n\n\n/** WEBPACK FOOTER **\n ** ./src/objectplus/traversable.ts\n **/","import { Messenger, assign, define, Constructor, MixableConstructor } from './objectplus/index.ts'\nimport { ValidationError, Validatable, ChildrenErrors } from './validation.ts'\nimport { Traversable, resolveReference } from './objectplus/traversable.ts'\n\nconst { trigger2, trigger3 } = Messenger;\n/***\n * Abstract class implementing ownership tree, tho-phase transactions, and validation. \n * 1. createTransaction() - apply changes to an object tree, and if there are some events to send, transaction object is created.\n * 2. transaction.commit() - send and process all change events, and close transaction.\n */\n\nexport type TransactionalConstructor = MixableConstructor< Transactional >;\n\n// Transactional object interface\n@define({\n    _changeEventName : 'change' // TODO: move to record.\n})\nexport abstract class Transactional extends Messenger implements Validatable, Traversable {\n    // Unique version token replaced on change\n    _changeToken : {} = {}\n\n    // true while inside of the transaction\n    _transaction : boolean = false;\n\n    // Holds current transaction's options, when in the middle of transaction and there're changes but is an unsent change event\n    _isDirty  : TransactionOptions = null;\n\n    // Backreference set by owner (Record, Collection, or other object)\n    _owner : Owner\n\n    // Key supplied by owner. Used by record to identify attribute key.\n    // Only collections doesn't set the key, which is used to distinguish collections.  \n    _ownerKey : string\n\n    // Name of the change event\n    _changeEventName : string\n\n    constructor( cid : string | number, owner? : Owner, ownerKey? : string ){\n        super( cid );\n        this._owner = owner;\n        this._ownerKey = ownerKey;\n    }\n\n    // Deeply clone ownership subtree, optionally setting the new owner\n    // (TODO: Do we really need it? Record must ignore events with empty keys)\n    // 'Pin store' shall assign this._defaultStore = this.getStore();\n    abstract clone( options? : { owner? : Owner, key? : string, pinStore? : boolean }) : this\n    \n    // Execute given function in the scope of ad-hoc transaction.\n    transaction( fun : ( self : this ) => void, options : TransactionOptions = {} ) : void{\n        const isRoot = begin( this );\n        fun.call( this, this );\n        isRoot && commit( this );\n    }\n\n    // Loop through the members in the scope of transaction.\n    // Transactional version of each()\n    updateEach( iteratee : ( val : any, key : string ) => void, options? : TransactionOptions ){\n        const isRoot = begin( this );\n        this.each( iteratee );\n        isRoot && commit( this );\n    }\n\n    // Apply bulk in-place object update in scope of ad-hoc transaction \n    set( values : any, options? : TransactionOptions ) : this {\n        if( values ){ \n            const transaction = this._createTransaction( values, options );\n            transaction && transaction.commit();\n        } \n\n        return this;\n    }\n\n    // Apply bulk object update without any notifications, and return open transaction.\n    // Used internally to implement two-phase commit.\n    // Returns null if there are no any changes.  \n    abstract _createTransaction( values : any, options? : TransactionOptions ) : Transaction\n    \n    // Parse function applied when 'parse' option is set for transaction.\n    parse( data : any ) : any { return data }\n\n    // Convert object to the serializable JSON structure\n    abstract toJSON() : {}\n\n    /*******************\n     * Traversals and member access\n     */\n    \n    // Get object member by its key.\n    abstract get( key : string ) : any\n\n    // Get object member by symbolic reference.\n    deepGet( reference : string ) : any {\n        return resolveReference( this, reference, ( object, key ) => object.get( key ) );\n    }\n\n    //_isCollection : boolean\n\n    // Return owner skipping collections.\n    getOwner() : Owner {\n        return this._owner;\n    }\n\n    // Store used when owner chain store lookup failed. Static value in the prototype. \n    _defaultStore : Transactional\n\n    // Locate the closest store. Store object stops traversal by overriding this method. \n    getStore() : Transactional {\n        const { _owner } = this;\n        return _owner ? <Transactional> _owner.getStore() : this._defaultStore;\n    }\n\n\n    /***************************************************\n     * Iteration API\n     */\n\n    // Loop through the members. Must be efficiently implemented in container class.\n    abstract each( iteratee : ( val : any, key : string | number ) => void, context? : any )\n\n    // Map members to an array\n    map<T>( iteratee : ( val : any, key : string ) => T, context? : any ) : T[]{\n        const arr : T[] = [],\n              fun = arguments.length === 2 ? ( v, k ) => iteratee.call( context, v, k ) : iteratee;\n        \n        this.each( ( val, key ) => {\n            const result = fun( val, key );\n            if( result !== void 0 ) arr.push( result );\n        } );\n\n        return arr;\n    }\n\n    // Map members to an object\n    mapObject<T>( iteratee : ( val : any, key : string | number ) => T, context? : any ) : { [ key : string ] : T }{\n        const obj : { [ key : string ] : T } = {},\n            fun = arguments.length === 2 ? ( v, k ) => iteratee.call( context, v, k ) : iteratee;\n        \n        this.each( ( val, key ) => {\n            const result = iteratee( val, key );\n            if( result !== void 0 ) obj[ key ] = result;\n        } );\n\n        return obj;\n    }\n\n    // Get array of attribute keys (Record) or record ids (Collection) \n    keys() : string[] {\n        return this.map( ( value, key ) => {\n            if( value !== void 0 ) return key;\n        });\n    }\n\n    // Get array of attribute values (Record) or records (Collection)\n    values() : any[] {\n        return this.map( value => value );\n    }\n    \n    /*********************************\n     * Validation API\n     */\n\n    // Lazily evaluated validation error\n    _validationError : ValidationError = void 0\n\n    // Validate ownership tree and return valudation error \n    get validationError() : ValidationError {\n        const error = this._validationError || ( this._validationError = new ValidationError( this ) );\n        return error.length ? error : null; \n    }\n\n    _invalidate( options : { validate? : boolean } ) : boolean {\n        var error;\n        if( options.validate && ( error = this.validationError ) ){\n            this.trigger( 'invalid', this, error, assign( { validationError : error }, options ) );\n            return true;\n        }\n    }\n\n    // Validate nested members. Returns errors count.\n    abstract _validateNested( errors : ChildrenErrors ) : number\n\n    // Object-level validator. Returns validation error.\n    validate( obj? : Transactional ) : any {}\n\n    // Return validation error (or undefined) for nested object with the given key. \n    getValidationError( key : string ) : any {\n        var error = this.validationError;\n        return ( key ? error && error.nested[ key ] : error ) || null;\n    }\n\n    // Get validation error for the given symbolic reference.\n    deepValidationError( reference : string ) : any {\n        return resolveReference( this, reference, ( object, key ) => object.getValidationError( key ) );\n    }\n\n    // Iterate through all validation errors across the ownership tree.\n    eachValidationError( iteratee : ( error : any, key : string, object : Transactional ) => void ) : void {\n        const { validationError } = this;\n        validationError && validationError.eachError( iteratee, this );\n    }\n\n    // Check whenever member with a given key is valid. \n    isValid( key : string ) : boolean {\n        return !this.getValidationError( key );\n    }\n}\n\n// Owner must accept children update events. It's an only way children communicates with an owner.\nexport interface Owner extends Traversable, Messenger {\n    _onChildrenChange( child : Transactional, options : TransactionOptions ) : void;\n    getOwner() : Owner\n    getStore() : Transactional\n}\n\n// Transaction object used for two-phase commit protocol.\n// Must be implemented by subclasses.\n// Transaction must be created if there are actual changes and when markIsDirty returns true. \nexport interface Transaction {\n    // Object transaction is being made on.\n    object : Transactional\n\n    // Send out change events, process update triggers, and close transaction.\n    // Nested transactions must be marked with isNested flag (it suppress owner notification).\n    commit( isNested? : boolean )\n}\n\n// Options for distributed transaction  \nexport interface TransactionOptions {\n    // Invoke parsing \n    parse? : boolean\n\n    // Suppress change notifications and update triggers\n    silent? : boolean\n\n    // Update existing transactional members in place, or skip the update (ignored by models)\n    merge? : boolean // =true\n\n    // Should collections remove elements in set (ignored by models)  \n    remove? : boolean // =true\n\n    // Always replace enclosed objects with new instances\n    reset? : boolean // = false\n\n    validate? : boolean\n}\n\n/**\n * Low-level transactions API. Must be used like this:\n * const isRoot = begin( record );\n * ...\n * isRoot && commit( record, options );\n * \n * When committing nested transaction, the flag must be set to true. \n * commit( object, options, isNested ) \n */\n\n// Start transaction. Return true if it's the root one.\nexport function begin( object : Transactional ) : boolean {\n    return object._transaction ? false : ( object._transaction = true );  \n}\n\n// Mark object having changes inside of the current transaction.\n// Returns true whenever there notifications are required.\nexport function markAsDirty( object : Transactional, options : TransactionOptions ) : boolean {\n    // If silent option is in effect, don't set isDirty flag.\n    const dirty = !options.silent;\n    if( dirty ) object._isDirty = options;\n    \n    // Reset version token.\n    object._changeToken = {};\n\n    // Object is changed, so validation must happen again. Clear the cache.\n    object._validationError = void 0;\n\n    return dirty;\n}\n\n// Commit transaction. Send out change event and notify owner. Returns true if there were changes.\n// Must be executed for the root transaction only.\nexport function commit( object : Transactional, isNested? : boolean ){\n    let originalOptions = object._isDirty;\n\n    if( originalOptions ){\n        // Send the sequence of change events, handling chained handlers.\n        while( object._isDirty ){\n            const options = object._isDirty;\n            object._isDirty = null; \n            trigger2( object, object._changeEventName, object, options );\n        }\n        \n        // Mark transaction as closed.\n        object._transaction = false;\n\n        // Notify owner on changes out of transaction scope.\n        const { _owner } = object;  \n        if( _owner && !isNested ){ // If it's the nested transaction, owner is already aware there are some changes.\n            _owner._onChildrenChange( object, originalOptions );\n        }\n    }\n    else{\n        // No changes. Silently close transaction.\n        object._isDirty = null;\n        object._transaction = false;\n    }\n}\n\n/************************************\n * Ownership management\n */\n\n// Add reference to the record.\nexport function aquire( owner : Owner, child : Transactional, key? : string ) : void {\n    if( !child._owner ){\n        child._owner = owner;\n        child._ownerKey = key;\n    }\n}\n\n// Remove reference to the record.\nexport function free( owner : Owner, child : Transactional ) : void {\n    if( owner === child._owner ){\n        child._owner = void 0;\n        child._ownerKey = void 0;\n    }\n}\n\n\n/** WEBPACK FOOTER **\n ** ./src/transactions.ts\n **/","export interface ChildrenErrors {\n    [ key : string ] : ValidationError | any\n} \n\nexport interface Validatable {\n    _validateNested( errors : ChildrenErrors ) : number;\n    validate( self : any ) : any\n    get( key : string ) : any\n}\n\n// Validation error object.\nexport class ValidationError {\n    // Invalid nested object keys \n    nested : ChildrenErrors \n    length : number\n\n    // Local error\n    error : any\n\n    constructor( obj : Validatable ){\n        this.length = obj._validateNested( this.nested = {} );\n\n        if( this.error = obj.validate( obj ) ){\n            this.length++;\n        }\n    }\n\n    each( iteratee : ( value : any, key : string ) => void ){\n        const { error, nested } = this;\n\n        if( error ) iteratee( error, null );\n\n        for( const key in nested ){\n            iteratee( nested[ key ], key );\n        }\n    }\n\n    eachError( iteratee : ( error : any, key : string, object : Validatable ) => void, object : Validatable ){\n        this.each( ( value, key ) => {\n            if( value instanceof ValidationError ){\n                value._traverse( iteratee, object.get( key ) );\n            }\n            else{\n                iteratee( value, key, object );\n            }\n        });\n    }\n}\n\n\n/** WEBPACK FOOTER **\n ** ./src/validation.ts\n **/","import { GenericAttribute } from './attribute.ts';\nimport { Attribute, AttributesValues, AttributeDescriptorMap, CloneAttributesCtor } from './transaction.ts'\nimport { defaults, isValidJSON, transform, log, EventMap } from '../objectplus/index.ts'\nimport { toAttributeDescriptor } from './typespec.ts'\n\nimport { CompiledReference } from '../objectplus/traversable.ts'\n\nexport interface DynamicMixin {\n    _attributes : AttributesSpec\n    Attributes : CloneAttributesCtor\n    properties : PropertyDescriptorMap\n    forEachAttr? : ForEach\n    defaults : Defaults\n    _toJSON : ToJSON\n    _parse? : Parse\n    _localEvents : EventMap\n    _keys : string[]\n}\n\n// Refine AttributesSpec definition.\nexport interface AttributesSpec {\n    [ key : string ] : GenericAttribute\n}\n\ntype ForEach   = ( obj : {}, iteratee : ( val : any, key? : string, spec? : Attribute ) => void ) => void;\ntype Defaults  = ( attrs? : {} ) => {}\ntype Parse     = ( data : any ) => any;\ntype ToJSON    = () => any;\n\n// Compile attributes spec\nexport function compile( rawSpecs : AttributeDescriptorMap, baseAttributes : AttributesSpec ) : DynamicMixin {\n    const myAttributes = transform( <AttributesSpec>{}, rawSpecs, createAttribute ),\n          allAttributes = defaults( <AttributesSpec>{}, myAttributes, baseAttributes ),\n          Attributes = createCloneCtor( allAttributes ),\n          mixin : DynamicMixin = {\n            Attributes : Attributes,\n            _attributes : new Attributes( allAttributes ),\n            properties : transform( <PropertyDescriptorMap>{}, myAttributes, x => x.createPropertyDescriptor() ),\n            defaults : createDefaults( allAttributes ),\n            _toJSON : createToJSON( allAttributes ), // <- TODO: profile and check if there is any real benefit. I doubt it. \n            _localEvents : createEventMap( myAttributes ),\n            _keys : Object.keys( allAttributes )\n         };\n\n    const _parse = createParse( myAttributes, allAttributes );\n    if( _parse ){\n        mixin._parse = _parse;\n    }\n\n    // Enable optimized forEach if warnings are disabled.\n    if( !log.level ){\n        mixin.forEachAttr = createForEach( allAttributes );\n    }\n\n    return mixin;\n}\n\n// Create attribute from the type spec.\nfunction createAttribute( spec, name ){\n    return GenericAttribute.create( toAttributeDescriptor( spec ), name );\n}\n\n// Build events map for attribute change events.\nfunction createEventMap( attrSpecs : AttributesSpec ) : EventMap {\n    let events : EventMap;\n\n    for( var key in attrSpecs ){\n        const attribute = attrSpecs[ key ],\n            { _onChange } = attribute.options; \n\n        if( _onChange ){\n            events || ( events = new EventMap() );\n\n            events.addEvent( 'change:' + key,\n                typeof _onChange === 'string' ?\n                    createWatcherFromRef( _onChange, key ) : \n                    wrapWatcher( _onChange, key ) );\n        }\n    }\n\n    return events;\n}\n\nfunction wrapWatcher( watcher, key ){\n    return function( record, value ){\n        watcher.call( record, value, key );\n    } \n}\n\nfunction createWatcherFromRef( ref : string, key : string ){\n    const { local, resolve, tail } = new CompiledReference( ref, true );\n    return local ?\n        function( record, value ){\n            record[ tail ]( value, key );\n        } :\n        function( record, value ){\n            resolve( record )[ tail ]( value, key );\n        }\n}\n\nexport function createForEach( attrSpecs : AttributesSpec ) : ForEach {\n    let statements = [ 'var v, _a=this._attributes;' ];\n\n    for( let name in attrSpecs ){\n        statements.push( `( v = a.${name} ) === void 0 || f( v, \"${name}\", _a.${name} );` );\n    }\n\n    return <ForEach> new Function( 'a', 'f', statements.join( '' ) );\n}\n\nexport function createCloneCtor( attrSpecs : AttributesSpec ) : CloneAttributesCtor {\n    var statements = [];\n\n    for( let name in attrSpecs ){\n        statements.push( `this.${name} = x.${name};` );\n    }\n\n    var CloneCtor = new Function( \"x\", statements.join( '' ) );\n    CloneCtor.prototype = Object.prototype;\n    return <CloneAttributesCtor> CloneCtor;\n}\n\n// Create optimized model.defaults( attrs, options ) function\nfunction createDefaults( attrSpecs : AttributesSpec ) : Defaults {\n    let assign_f = ['var v;'], create_f = [];\n\n    function appendExpr( name, expr ){\n        assign_f.push( `this.${name} = ( v = a.${name} ) === void 0 ? ${expr} : v;` );\n        create_f.push( `this.${name} = ${expr};` );\n    }\n\n    // Compile optimized constructor function for efficient deep copy of JSON literals in defaults.\n    for( let name in attrSpecs ){\n        const attrSpec = attrSpecs[ name ],\n              { value, type } = attrSpec;\n\n        if( value === void 0 && type ){\n            // if type with no value is given, create an empty object\n            appendExpr( name, `i.${name}.create()` );//TODO: consider adding owner reference\n        }\n        else{\n            // If value is given, type casting logic will do the job later, converting value to the proper type.\n            if( isValidJSON( value ) ){\n                // JSON literals must be deep copied.\n                appendExpr( name, JSON.stringify( value ) );\n            }\n            else if( value === void 0 ){\n                // handle undefined value separately. Usual case for model ids.\n                appendExpr( name, 'void 0' );\n            }\n            else{\n                // otherwise, copy value by reference.\n                appendExpr( name, `i.${name}.value` );\n            }\n        }\n    }\n\n    const CreateDefaults : any = new Function( 'i', create_f.join( '' ) ),\n          AssignDefaults : any = new Function( 'a', 'i', assign_f.join( '' ) );\n\n    CreateDefaults.prototype = AssignDefaults.prototype = Object.prototype;\n\n    // Create model.defaults( attrs, options ) function\n    // 'attrs' will override default values, options will be passed to nested backbone types\n    return function( attrs? : {} ){ //TODO: Consider removing of the CreateDefaults. Currently is not used. May be used in Record costructor, though.\n        return attrs ? new AssignDefaults( attrs, this._attributes ) : new CreateDefaults( this._attributes );\n    }\n}\n\nfunction createParse( allAttrSpecs : AttributesSpec, attrSpecs : AttributesSpec ) : Parse {\n    var statements = [ 'var a=this._attributes;' ],\n        create     = false;\n\n    for( let name in allAttrSpecs ){\n        const local = attrSpecs[ name ];\n\n        // Is there any 'parse' option in local model definition?\n        if( local && local.parse ) create = true;\n\n        // Add statement for each attribute with 'parse' option.\n        if( allAttrSpecs[ name ].parse ){\n            const s = `r.${name} === void 0 ||( r.${name} = a.${name}.parse.call( this, r.${name}, \"${name}\") );`;\n            statements.push( s );\n        }\n    }\n\n    if( create ){\n        statements.push( 'return r;' );\n        return <any> new Function( 'r', statements.join( '' ) );\n    }\n }\n\nfunction createToJSON( attrSpecs : AttributesSpec ) : ToJSON {\n    let statements = [ `var json = {},v=this.attributes,a=this._attributes;` ];\n\n    for( let key in attrSpecs ){\n        const toJSON = attrSpecs[ key ].toJSON;\n\n        if( toJSON ){\n            statements.push( `json.${key} = a.${key}.toJSON.call( this, v.${ key }, '${key}' );` );\n        }\n    }\n\n    statements.push( `return json;` );\n\n    return <any> new Function( statements.join( '' ) );\n}\n\n\n\n/** WEBPACK FOOTER **\n ** ./src/record/define.ts\n **/","import { setAttribute, Record, Attribute, Transform, ChangeHandler, AttributeDescriptor } from './transaction.ts'\nimport { notEqual, assign, Constructor } from '../objectplus/index.ts'\n\nimport { Owner, Transactional, TransactionOptions } from '../transactions.ts'\n\ntype GetHook = ( value : any, key : string ) => any;\nexport type ChangeAttrHandler = ( ( value : any, attr : string ) => void ) | string;\n\ndeclare global {\n    interface Function {\n        _attribute : typeof GenericAttribute\n    }\n}\n\n// TODO: interface differs from options, do something obout it\nexport class GenericAttribute implements Attribute {\n    // Factory method to create attribute from options \n    static create( options : AttributeDescriptor, name : string ) : GenericAttribute {\n        const type = options.type,\n              AttributeCtor = type ? type._attribute : GenericAttribute;\n\n        return new AttributeCtor( name, options );\n    }\n    /**\n     * Update pipeline functions\n     * =========================\n     *\n     * Stage 0. canBeUpdated( value )\n     * - presence of this function implies attribute's ability to update in place.\n     */\n     canBeUpdated( prev, next ) : boolean {\n         return false;\n     }\n\n    /**\n     * Stage 1. Transform stage\n     */\n    transform( value, options, prev, model ) { return value; }\n\n    // convert attribute type to `this.type`\n    convert( value, options, model ) { return value; }\n\n    /**\n     * Stage 2. Check if attr value is changed\n     */\n    isChanged( a, b ) {\n        return notEqual( a, b );\n    }\n\n    /**\n     * Stage 3. Handle attribute change\n     */\n    handleChange( next, prev, model ) {}\n\n    /**\n     * End update pipeline definitions.\n     */\n\n    // create empty object passing backbone options to constructor...\n    create() { return new ( <any>this.type )(); }\n\n    // generic clone function for typeless attributes\n    // Must be overriden in sublass\n    clone( value, options : { deep? : boolean } = {} ) {\n        if( value && typeof value === 'object' ) {\n            // delegate to object's clone(), if it exist...\n            if( value.clone ) {\n                return value.clone( options );\n            }\n\n            if( options.deep ){\n                const proto = Object.getPrototypeOf( value );\n\n                // attempt to deep copy raw objects, assuming they are JSON\n                if( proto === Object.prototype || proto === Array.prototype ){\n                    return JSON.parse( JSON.stringify( value ) );\n                }\n            }\n        }\n\n        return value;\n    }\n\n    validate( record : Record, value : any, key : string ){}\n\n    toJSON( value, key ) {\n        return value && value.toJSON ? value.toJSON() : value;\n    }\n\n    createPropertyDescriptor() : PropertyDescriptor | void {\n        const { name, getHook } = this;\n\n        if( name !== 'id' ){\n            return {\n                // call to optimized set function for single argument.\n                set( value ){\n                    setAttribute( <any>this, name, value );\n                },\n\n                // attach get hook to the getter function, if present\n                get : getHook ?\n                      function() {\n                          return getHook.call( this, this.attributes[ name ], name );\n                      } :\n                      function() {\n                          return this.attributes[ name ];\n                      }\n            }\n        }\n    }\n\n    value : any\n    type : Constructor< any >\n\n    parse : ( value, key : string ) => any\n\n    initialize( name : string, options ){}\n\n    constructor( public name : string, public options : AttributeDescriptor ) {\n        const {\n                  value, type, parse, toJSON,\n                  getHooks = [],\n                  transforms = [],\n                  changeHandlers = []\n              } = options;\n\n        this.value = value;\n        this.type  = type;\n\n        this.parse  = parse;\n        this.toJSON = toJSON === void 0 ? this.toJSON : toJSON;\n\n        /**\n         * Assemble pipelines...\n         */\n\n        // `convert` is default transform, which is always present...\n        transforms.unshift( this.convert );\n\n        // Get hook from the attribute will be used first...\n        if( this.get ) getHooks.unshift( this.get );\n\n        // let subclasses configure the pipeline...\n        this.initialize.apply( this, arguments );\n\n        // let attribute spec configure the pipeline...\n        if( getHooks.length ){\n            this.getHook = getHooks.reduce( chainGetHooks );\n        }\n        \n        if( transforms.length ){\n            this.transform = transforms.reduce( chainTransforms );\n        }\n        \n        if( changeHandlers.length ){\n            this.handleChange = changeHandlers.reduce( chainChangeHandlers );\n        }\n    }\n\n    getHook : ( value, key : string ) => any = null\n    get : ( value, key : string ) => any\n}\n\nRecord.prototype._attributes = { id : GenericAttribute.create({ value : void 0 }, 'id' )};\nRecord.prototype.defaults = function( attrs : { id? : string } = {} ){ return { id : attrs.id } };\n\nfunction chainChangeHandlers( prevHandler : ChangeHandler, nextHandler : ChangeHandler ) : ChangeHandler {\n    return function( next, prev, model ) {\n        prevHandler.call( this, next, prev, model );\n        nextHandler.call( this, next, prev, model );\n    }\n}\n\nfunction chainGetHooks( prevHook : GetHook, nextHook : GetHook ) : GetHook {\n    return function( value, name ) {\n        return nextHook.call( prevHook.call( value, name ), name );\n    }\n}\n\nfunction chainTransforms( prevTransform : Transform, nextTransform : Transform ) : Transform {\n    return function( value, options, prev, model ) {\n        return nextTransform.call( this, prevTransform.call( this, value, options, prev, model ), options, prev, model );\n    }\n}\n\n\n/** WEBPACK FOOTER **\n ** ./src/record/attribute.ts\n **/","/**\n * Type spec engine. Declare attributes using chainable syntax,\n * and returns object with spec.\n */\n\nimport { ChangeAttrHandler } from './attribute.ts'\nimport { AttributeDescriptor, Record } from './transaction.ts'\nimport { assign, EventMap, EventsDefinition, Constructor } from '../objectplus/index.ts'\n\nexport class ChainableAttributeSpec {\n    options : AttributeDescriptor;\n\n    constructor( options : AttributeDescriptor = {} ) {\n        this.options = { getHooks : [], transforms : [], changeHandlers : []};\n        assign( this.options, options );\n    }\n\n    triggerWhenChanged( events ) : this {\n        // TODO: not clear\n        return this;\n    }\n\n    watcher( ref : string | ( ( value : any, key : string ) => void ) ) : this {\n        this.options._onChange = ref;\n        return this;\n    }\n\n    parse( fun ) : this {\n        this.options.parse = fun;\n        return this;\n    }\n\n    toJSON( fun ) : this{\n        this.options.toJSON = fun;\n        return this;\n    }\n\n    // Attribute get hook.\n    get( fun ) : this {\n        this.options.getHooks.push( fun );\n\n        return this;\n    }\n\n    // Attribute set hook.\n    set( fun ) : this {\n        this.options.transforms.push( function( next, options, prev, model ) {\n            if( this.isChanged( next, prev ) ) {\n                var changed = fun.call( model, next, name );\n                return changed === void 0 ? prev : changed;\n            }\n\n            return prev;\n        } );\n\n        return this;\n    }\n\n    // Subsribe to events from an attribute.\n    events( map : EventsDefinition ) : this {\n        const eventMap = new EventMap( map );\n\n        this.options.changeHandlers.push( function( next, prev, record : Record ){\n                prev && eventMap.unsubscribe( record, prev );\n\n                next && eventMap.subscribe( record, next );\n            });\n\n        return this;\n    }\n\n    get has() : this { return this; }\n\n    /*\n    get isRequired() {\n        this.options.isRequired = true;\n        return this;\n    }*/\n\n    value( x ) : this {\n        this.options.value = x;\n        return this;\n    }\n}\n\ndeclare global {\n    interface Function{\n        value : ( x : any ) => ChainableAttributeSpec;\n        isRequired : ChainableAttributeSpec;\n        has : ChainableAttributeSpec;\n    }\n}\n\nFunction.prototype.value = function( x ) {\n    return new ChainableAttributeSpec( { type : this, value : x } );\n};\n\n/*\nObject.defineProperty( Function.prototype, 'isRequired', {\n    get() {\n        return new ChainableAttributeSpec( { type : this, isRequired : true } );\n    } \n});*/\n\nObject.defineProperty( Function.prototype, 'has', {\n    get() {\n        // workaround for sinon.js and other libraries overriding 'has'\n        return this._has || new ChainableAttributeSpec( { type : this } );\n    },\n\n    set( value ) { this._has = value; }\n} );\n\nexport function toAttributeDescriptor( spec : any ) : AttributeDescriptor {\n    if( typeof spec === 'function' ) {\n        return { type : <any> spec };\n    }\n\n    if( spec && spec instanceof ChainableAttributeSpec ) {\n        return spec.options;\n    }\n \n    return {\n        type : inferType( spec ),\n        value : spec\n    }\n}\n\nfunction inferType( value : {} ) : Constructor<any> {\n    switch( typeof value ) {\n        case 'number' :\n            return Number;\n        case 'string' :\n            return String;\n        case 'boolean' :\n            return Boolean;\n        case 'undefined' :\n            return void 0;\n        case 'object' :\n            return value ? <any> value.constructor : Object;\n    }\n}\n\n\n\n/** WEBPACK FOOTER **\n ** ./src/record/typespec.ts\n **/","import { Record } from './transaction.ts' \nimport { GenericAttribute } from './attribute.ts'\nimport { Owner, free, aquire, Transactional, TransactionOptions, TransactionalConstructor } from '../transactions.ts' \n\nexport class TransactionalType extends GenericAttribute {\n    type : TransactionalConstructor\n\n    canBeUpdated( prev : Transactional, next : any ) : boolean {\n        // If an object already exists, and new value is of incompatible type, let object handle the update.\n        return prev && next && !( next instanceof this.type );\n    }\n\n    convert( value : any, options : TransactionOptions, record : Record ) : Transactional {\n        // Invoke class factory to handle abstract classes\n        return value == null || value instanceof this.type ? value : this.type.create( value, options, record );\n    }\n\n    create() : Transactional {\n        return new (<any>this.type)(); // this the subclass of Transactional here.\n    }\n\n    handleChange( next : Transactional, prev : Transactional, record : Record ){\n        prev && free( record, prev );\n        next && aquire( record, next, this.name );\n    }\n}\n\nRecord._attribute = TransactionalType;\n\n\n/** WEBPACK FOOTER **\n ** ./src/record/nestedTypes.ts\n **/","import { GenericAttribute } from './attribute.ts'\nimport { parseDate } from '../objectplus/index.ts'\n\n// Default attribute type for all constructor functions...\nclass ConstructorType extends GenericAttribute {\n    type : new ( value : any ) => {}\n\n    convert( value ) {\n        return value == null || value instanceof this.type ? value : new this.type( value );\n    }\n\n    clone( value, options ) {\n        // delegate to clone function or deep clone through serialization\n        return value.clone ? value.clone( value, options ) : this.convert( JSON.parse( JSON.stringify( value ) ) );\n    }\n}\n\nFunction.prototype._attribute = ConstructorType;\n\n// Date Attribute\nclass DateType extends GenericAttribute {\n    convert( value ) {\n        return value == null || value instanceof Date ? value :\n               new Date( typeof value === 'string' ? parseDate( value ) : value );\n    }\n\n    validate( model, value, name ) {\n        if( isNaN( +value ) ) return name + ' is Invalid Date';\n    }\n\n    toJSON( value ) { return value && value.toJSON(); }\n\n    isChanged( a, b ) { return ( a && +a ) !== ( b && +b ); }\n\n    clone( value ) { return value && new Date( +value ); }\n}\n\nDate._attribute = DateType;\n\n// Primitive Types.\nexport class PrimitiveType extends GenericAttribute {\n    type : NumberConstructor | StringConstructor | BooleanConstructor\n\n    create() { return this.type(); }\n\n    toJSON( value ) { return value; }\n\n    convert( value ) { return value == null ? value : this.type( value ); }\n\n    isChanged( a, b ) { return a !== b; }\n\n    clone( value ) { return value; }\n}\n\nBoolean._attribute = String._attribute = PrimitiveType;\n\n// Number type with special validation algothim. \nexport class NumericType extends PrimitiveType {\n    type : NumberConstructor\n\n    validate( model, value, name ) {\n        // Whatever is not symmetrically serializable to JSON, is not valid by default.\n        if( !isFinite( value ) ) {\n            return name + ' is not valid number';\n        }\n    }\n}\n\nNumber._attribute = NumericType;\n\n// Add global Integer data type\ndeclare global {\n    interface Window {\n        Integer : Function\n    }\n}\n\nif( window ){\n    window.Integer = function( x ){ return x ? Math.round( x ) : 0; }\n    window.Integer._attribute = NumericType;\n}\n\n// Compatibility wrapper for Array type.\nexport class ArrayType extends GenericAttribute {\n    toJSON( value ) { return value; }\n\n    convert( value ) {\n        // Fix incompatible constructor behaviour of Array...\n        if( value == null || Array.isArray( value ) ) return value;\n\n        // todo: log an error.\n        return [];\n    }\n}\n\nArray._attribute = ArrayType;\n\n\n/** WEBPACK FOOTER **\n ** ./src/record/basicTypes.ts\n **/","import { define, omit, log, assign, EventMap, EventsDefinition, Mixable, MessengerDefinition, defaults } from '../objectplus/index.ts'\nimport { begin, commit, markAsDirty, Transactional, Transaction, TransactionOptions, Owner } from '../transactions.ts'\nimport { Record, TransactionalType } from '../record/index.ts'\n\nimport { IdIndex, sortElements, dispose, Elements, CollectionCore, addIndex, removeIndex, Comparator, CollectionTransaction } from './commons.ts'\nimport { addTransaction } from './add.ts'\nimport { setTransaction, emptySetTransaction } from './set.ts'\nimport { removeOne, removeMany } from './remove.ts'\n\nconst { trigger2 } = Transactional;\n\nlet _count = 0;\n\nconst silentOptions = { silent : true };\n\nexport type GenericComparator = string | ( ( x : Record ) => number ) | ( ( a : Record, b : Record ) => number ); \n\n\ninterface CollectionOptions extends TransactionOptions {\n    comparator? : GenericComparator\n    model? : typeof Record\n}\n\ninterface CollectionDefinition extends MessengerDefinition {\n    elementsEvents? : EventsDefinition\n    _elementsEvents? : EventMap\n}\n\n@define({\n    // Default client id prefix \n    cidPrefix : 'c',\n    model : Record,\n    _changeEventName : 'changes' \n})\nexport class Collection extends Transactional implements CollectionCore {\n    static predefine() : typeof Collection { return this; }\n    \n    static define( protoProps? : CollectionDefinition, staticProps? ){\n        const spec : CollectionDefinition = omit( protoProps, 'elementsEvents', 'localEvents' );\n\n        if( protoProps.elementsEvents ){\n            const eventsMap = new EventMap( this.prototype._elementsEvents );\n            eventsMap.addEventsMap( protoProps.elementsEvents );\n            spec._elementsEvents = eventsMap; \n        }\n\n        return Transactional.define.call( this, spec, staticProps );\n    }\n    \n    _elementsEvents : EventMap\n\n    /***********************************\n     * Core Members\n     */\n    // Array of the records\n    models : Record[]\n\n    // Index by id and cid\n    _byId : IdIndex\n\n    set comparator( x : GenericComparator ){\n        let compare;\n\n        switch( typeof x ){\n            case 'string' :\n                this._comparator = ( a, b ) => {\n                    const aa = a[ <string>x ], bb = b[ <string>x ];\n                    if( aa === bb ) return 0;\n                    return aa < bb ? -1 : + 1;\n                } \n                break;\n            case 'function' :\n                if( x.length === 1 ){\n                    this._comparator = ( a, b ) => {\n                        const aa = (<any>x).call( this, a ), bb = (<any>x).call( this, b );\n                        if( aa === bb ) return 0;\n                        return aa < bb ? -1 : + 1;\n                    }\n                }\n                else{\n                    this._comparator = ( a, b ) => (<any>x).call( this, a, b );\n                }\n                break;\n                \n            default :\n                this._comparator = null;\n        }\n    }\n    \n    get comparator(){ return this._comparator; }\n    _comparator : ( a : Record, b : Record ) => number\n\n    _onChildrenChange( record : Record, options : TransactionOptions = {} ){\n        const isRoot = begin( this ),\n              { idAttribute } = this;\n\n        if( record.hasChanged( idAttribute ) ){\n            const { _byId } = this;\n            delete _byId[ record.previous( idAttribute ) ];\n\n            const { id } = record;\n            id == null || ( _byId[ id ] = record );\n        }\n\n        if( markAsDirty( this, options ) ){\n            // Forward change event from the record.\n            trigger2( this, 'change', record, options )\n        }\n\n        isRoot && commit( this );\n    }\n\n    get( objOrId : string | Record | Object ) : Record {\n        if( objOrId == null ) return;\n\n        if( typeof objOrId === 'object' ){\n            const id = objOrId[ this.idAttribute ];\n            return ( id !== void 0 && this._byId[ id ] ) || this._byId[ (<Record>objOrId).cid ];\n        }\n        else{\n            return this._byId[ objOrId ];\n        }        \n    }\n\n    each( iteratee : ( val : Record, key : number ) => void, context? : any ){\n        const fun = arguments.length === 2 ? ( v, k ) => iteratee.call( context, v, k ) : iteratee,\n            { models } = this;\n\n        for( let i = 0; i < models.length; i++ ){\n            fun( models[ i ], i ); \n        }\n    }\n\n    _validateNested( errors : {} ) : number {\n        let count = 0;\n\n        this.each( record => {\n            const error = record.validationError;\n            if( error ){\n                errors[ record.cid ] = error;\n                count++;\n            }\n        });\n\n        return count;\n    }\n\n    model : typeof Record\n\n    // idAttribute extracted from the model type.\n    idAttribute : string\n\n\n    constructor( records? : ( Record | {} )[], options : CollectionOptions = {} ){\n        super( _count++ );\n        this.models = [];\n        this._byId = {};\n        this.model      = options.model || this.model;\n        this.idAttribute = this.model.prototype.idAttribute;\n        if( options.comparator !== void 0 ){\n            this.comparator = options.comparator;\n        }\n        else{\n            // Make sure this property is initialized, to keep the same hidden class.\n            this._comparator = this._comparator;\n        }\n\n        if( records ){\n            const elements = toElements( this, records, options );\n            emptySetTransaction( this, elements, options, true );\n        }\n\n        this.initialize.apply( this, arguments );\n        if( this._localEvents ) this._localEvents.subscribe( this, this );\n    }\n\n    initialize(){}\n\n    get length() : number { return this.models.length; }\n    first() : Record { return this.models[ 0 ]; }\n    last() : Record { return this.models[ this.models.length - 1 ]; }\n    at( a_index : number ) : Record {\n        const index = a_index < 0 ? a_index + this.models.length : a_index;    \n        return this.models[ index ];\n    }\n\n    // Deeply clone collection, optionally setting new owner.\n    clone( owner? : any ) : this {\n        var models = this.map( model => model.clone() );\n        return new (<any>this.constructor)( models, { model : this.model, comparator : this.comparator }, owner );\n    }\n\n    toJSON() : Object[] {\n        return this.models.map( model => model.toJSON() );\n    }\n\n    // Apply bulk in-place object update in scope of ad-hoc transaction \n    set( elements : ElementsArg = [], options : TransactionOptions = {} ) : this {\n        if( (<any>options).add !== void 0 ){\n            log.error(\"Collection.set doesn't support 'add' option, behaving as if options.add === true.\");\n        }\n\n        // Handle reset option here - no way it will be populated from the top as nested transaction.\n        if( options.reset ){\n            this.reset( elements, options )\n        }\n        else{\n            const transaction = this._createTransaction( elements, options );\n            transaction && transaction.commit();\n        } \n\n        return this;    \n    }\n\n    reset( a_elements : ElementsArg, options : TransactionOptions = {} ) : Record[] {\n        const previousModels = dispose( this );\n\n        // Make all changes required, but be silent.\n        if( a_elements ){            \n            emptySetTransaction( this, toElements( this, a_elements, options ), options, true );\n        }\n\n        options.silent || trigger2( this, 'reset', this, defaults( { previousModels : previousModels }, options ) );\n\n        return this.models;\n    }\n\n    // Add elements to collection.\n    add( a_elements : ElementsArg , options : TransactionOptions = {} ){\n        const elements = toElements( this, a_elements, options ),\n              transaction = this.models.length ?\n                    addTransaction( this, elements, options ) :\n                    emptySetTransaction( this, elements, options );\n\n        if( transaction ){\n            transaction.commit();\n            return transaction.added;\n        } \n    }\n\n    // Remove elements. \n    remove( recordsOrIds : any, options : TransactionOptions = {} ) : Record[] | Record {\n        if( recordsOrIds ){\n            return Array.isArray( recordsOrIds ) ?\n                        removeMany( this, recordsOrIds, options ) :\n                        removeOne( this, recordsOrIds, options );\n        }\n\n        return [];\n    }\n\n    // Apply bulk object update without any notifications, and return open transaction.\n    // Used internally to implement two-phase commit.   \n    _createTransaction( a_elements : ElementsArg, options : TransactionOptions = {} ) : CollectionTransaction {\n        const elements = toElements( this, a_elements, options );\n\n        if( this.models.length ){\n            return options.remove === false ?\n                        addTransaction( this, elements, options ) :\n                        setTransaction( this, elements, options );\n        }\n        else{\n            return emptySetTransaction( this, elements, options );\n        }\n    }\n\n    static _attribute = TransactionalType;\n\n    /***********************************\n     * Collection manipulation methods\n     */\n\n    pluck( key : string ) : any[] {\n        return this.models.map( model => model[ key ] );\n    }\n\n    sort( options : TransactionOptions = {} ) : this {\n        if( sortElements( this, options ) ){\n            const isRoot = begin( this );\n            \n            if( markAsDirty( this, options ) ){\n                trigger2( this, 'sort', this, options );\n            }\n\n            isRoot && commit( this );\n        }\n\n        return this;\n    }\n\n    // Add a model to the end of the collection.\n    push(model, options) {\n      return this.add(model, assign({at: this.length}, options));\n    }\n\n    // Remove a model from the end of the collection.\n    pop(options) {\n      var model = this.at(this.length - 1);\n      this.remove(model, options);\n      return model;\n    }\n\n    // Add a model to the beginning of the collection.\n    unshift(model, options) {\n      return this.add(model, assign({at: 0}, options));\n    }\n\n    // Remove a model from the beginning of the collection.\n    shift( options? : CollectionOptions ) : Record {\n      var model = this.at(0);\n      this.remove( model, options );\n      return model;\n    }\n\n    // Slice out a sub-array of models from the collection.\n    slice() : Record[] {\n      return slice.apply(this.models, arguments);\n    }\n\n    indexOf( modelOrId : any ) : number {\n        const record = this.get( modelOrId );\n        return this.models.indexOf( record );\n    }\n\n    modelId( attrs : {} ) : any {\n        return attrs[ this.model.prototype.idAttribute ];\n    }\n}\n\ntype ElementsArg = Object | Record | Object[] | Record[];\n\nfunction toElements( collection : Collection, elements : ElementsArg, options : CollectionOptions ) : Elements {\n    const parsed = options.parse ? collection.parse( elements ) : elements; \n    return Array.isArray( parsed ) ? parsed : [ parsed ];\n}\n\nconst slice = Array.prototype.slice;\n\nRecord.Collection = <any>Collection;\n\n\n/** WEBPACK FOOTER **\n ** ./src/collection/index.ts\n **/","import { Record } from '../record/index.ts'\nimport { Owner, aquire as _aquire, free as _free, Transaction, markAsDirty,\n        TransactionOptions, Transactional, commit } from '../transactions.ts'\n\nimport { EventMap } from '../objectplus/index.ts'\n\nconst { trigger2, trigger3 } = Transactional;        \n\nexport interface CollectionCore extends Transactional, Owner {\n    _byId : IdIndex\n    models : Record[]\n    model : typeof Record\n    idAttribute : string // TODO: Refactor inconsistent idAttribute usage\n    _comparator : Comparator\n    get( objOrId : string | Record | Object ) : Record    \n    _elementsEvents? : EventMap\n}\n\n// Collection's manipulation methods elements\nexport type Elements = ( Object | Record )[];\n\nexport interface CollectionOptions extends TransactionOptions {\n    sort? : boolean\n}\n\nexport type Comparator = ( a : Record, b : Record ) => number;  \n\nexport function dispose( collection : CollectionCore ) : Record[]{\n    const models = collection.models;\n\n    collection.models = [];\n    collection._byId  = {};\n\n    freeAll( collection, models );\n    return models;\n}\n\n\nexport function aquire( owner : CollectionCore, child : Record ) : void {\n    _aquire( owner, child );\n\n    const { _elementsEvents } = owner;\n    _elementsEvents && _elementsEvents.subscribe( owner, child );\n}\n\nexport function free( owner : CollectionCore, child : Record ) : void {\n    _free( owner, child );\n\n    const { _elementsEvents } = owner;\n    _elementsEvents && _elementsEvents.unsubscribe( owner, child );\n}\n\nexport function freeAll( collection : CollectionCore, children : Record[] ) : Record[] {\n    for( let child of children ){\n        free( collection, child );\n    }\n\n    return children;\n}\n\n// Silently sort collection, if its required. Returns true if sort happened.  \nexport function sortElements( collection : CollectionCore, options : CollectionOptions ) : boolean {\n    let { _comparator } = collection;\n    if( _comparator && options.sort !== false ){\n        collection.models.sort( _comparator );\n        return true;\n    }\n\n    return false;\n}\n\n/**********************************\n * Collection Index \n */\n\n// Index data structure\nexport interface IdIndex {\n    [ id : string ] : Record\n}\n\n// Add record\nexport function addIndex( index : IdIndex, model : Record ) : void {\n    index[ model.cid ] = model;\n    var id             = model.id;\n    \n    if( id != null ){\n        index[ id ] = model;\n    }\n}\n\n// Remove record\nexport function removeIndex( index : IdIndex, model : Record ) : void {\n    delete index[ model.cid ];\n    var id = model.id;\n    if( id != null ){\n        delete index[ id ];\n    }\n}\n\n// convert argument to model. Return false if fails.\nexport function toModel( collection : CollectionCore, attrs, options ){\n    const { model } = collection;\n    return attrs instanceof model ? attrs : model.create( attrs, options, collection );\n}\n\nexport function convertAndAquire( collection : CollectionCore, attrs, options ){\n    const { model } = collection,\n    \t  record = attrs instanceof model ? attrs : model.create( attrs, options, collection );\n\n    aquire( collection, record );\n    return record;\n}\n\n/***\n * In Collections, transactions appears only when\n * add remove or change events might be emitted.\n * reset doesn't require transaction.\n * \n * Transaction holds information regarding events, and knows how to emit them.\n * \n * Two major optimization cases.\n * 1) Population of an empty collection\n * 2) Update of the collection (no or little changes) - it's crucial to reject empty transactions.\n */\n\n\n// Transaction class. Implements two-phase transactions on object's tree. \nexport class CollectionTransaction implements Transaction {\n    // open transaction\n    constructor(    public object : CollectionCore,\n                    public isRoot : boolean,\n                    public added : Record[],\n                    public removed : Record[],\n                    public nested : Transaction[],\n                    public sorted : boolean ){}\n\n    // commit transaction\n    commit( isNested? : boolean ){\n        const { nested, object } = this,\n              { _isDirty } = object;\n\n        // Commit all nested transactions...\n        for( let transaction of nested ){\n            transaction.commit( true );\n        }\n\n        // Just trigger 'change' on collection, it must be already triggered for models during nested commits.\n        // ??? TODO: do it in nested transactions loop? This way appears to be more correct. \n        for( let transaction of nested ){\n            trigger2( object, 'change', transaction.object, _isDirty );\n        }\n\n        // Notify listeners on attribute changes...\n        const { added, removed } = this;\n\n        // Trigger `add` events for both model and collection.\n        for( let record of added ){\n            trigger3( record, 'add', record, object, _isDirty );\n            trigger3( object, 'add', record, object, _isDirty );\n        }\n\n        // Trigger `remove` events for both model and collection.\n        for( let record of removed ){\n            trigger3( record, 'remove', record, object, _isDirty );\n            trigger3( object, 'remove', record, object, _isDirty );\n        }\n\n        if( this.sorted ){\n            trigger2( object, 'sort', object, _isDirty );\n        }\n\n        if( added.length || removed.length ){\n            trigger2( object, 'update', object, _isDirty );\n        }\n\n        this.isRoot && commit( object, isNested );\n    }\n}\n\n\n/** WEBPACK FOOTER **\n ** ./src/collection/commons.ts\n **/","import { Transaction, begin, commit, markAsDirty } from '../transactions.ts'\nimport { CollectionTransaction, sortElements, aquire, free, CollectionOptions, toModel, addIndex, CollectionCore } from './commons.ts'\nimport { Record } from '../record/index.ts'\n\ninterface AddOptions extends CollectionOptions {\n    at? : number \n}\n\nexport function addTransaction( collection : CollectionCore, items, options : AddOptions ){\n    const isRoot = begin( collection ),\n          nested = [];\n\n    var added = appendElements( collection, items, nested, options );\n\n    if( added.length || nested.length ){\n        let needSort = sortOrMoveElements( collection, added, options );\n        if( markAsDirty( collection, options ) ){\n            return new CollectionTransaction( collection, isRoot, added, [], nested, needSort );\n        }\n    }\n\n    // No changes...\n    isRoot && commit( collection );\n};\n\n// Handle sort or insert at options for add operation. Reurns true if sort happened. \nfunction sortOrMoveElements( collection : CollectionCore, added : Record[], options : AddOptions ) : boolean {\n    let at = options.at;\n\n    // if `at` option is given, it overrides sorting option...\n    if( at != null ){\n        // Take an original collection's length. \n        const length = collection.models.length - added.length;\n\n        // Crazy Backbone rules about `at` index. I don't know what that guys smoke.\n        at = Number( at );\n        if( at < 0 ) at += length + 1;\n        if( at < 0 ) at = 0;\n        if( at > length ) at = length;\n\n        // Move added elements to desired position. In place.\n        moveElements( collection.models, at, added );\n        return false;\n    }\n\n    return sortElements( collection, options );\n}\n\nfunction moveElements( source : any[], at : number, added : any[] ) : void {\n    for( var j = source.length - 1, i = j - added.length; i >= at; i--, j-- ){\n        source[ j ] = source[ i ];\n    }\n\n    for( i = 0, j = at; i < added.length; i++, j++ ){\n        source[ j ] = added[ i ];\n    }\n}\n\n// append data to model and index\nfunction appendElements( collection : CollectionCore, a_items, nested : Transaction[], a_options ){\n    var models      = collection.models,\n        _byId       = collection._byId,\n        merge       = a_options.merge,\n        parse       = a_options.parse,\n        idAttribute = collection.model.prototype.idAttribute,\n        prevLength = models.length;\n\n    for( const item of a_items ){\n        let model = item ? _byId[ item[ idAttribute ] ] || _byId[ item.cid ] : null;\n\n        if( model ){\n            if( merge && item !== model ){\n                var attrs = item.attributes || item;\n                const transaction = model._createTransaction( attrs, a_options );\n                transaction && nested.push( transaction );\n            }\n        }\n        else{\n            model = toModel( collection, item, a_options );\n\n            models.push( model );\n            aquire( collection, model );\n            addIndex( _byId, model );\n        }\n    }\n\n    return models.slice( prevLength );\n}\n\n\n\n/** WEBPACK FOOTER **\n ** ./src/collection/add.ts\n **/","import { Transaction, begin, commit, markAsDirty } from '../transactions.ts'\nimport { CollectionTransaction, IdIndex, aquire, free, sortElements, CollectionOptions, toModel, addIndex, CollectionCore, Elements, freeAll } from './commons.ts'\nimport { Record } from '../record/index.ts'\n\n/*******\n * \n */\n\nconst silentOptions = { silent : true };\n\nexport function emptySetTransaction( collection : CollectionCore, items : Elements, options : CollectionOptions, silent? : boolean ){\n    const isRoot = begin( collection );\n\n    const added = _reallocateEmpty( collection, items, options );\n\n    if( added.length ){\n        const needSort = sortElements( collection, options );\n\n        if( markAsDirty( collection, silent ? silentOptions : options ) ){\n            // 'added' is the reference to this.models. Need to copy it.\n            return new CollectionTransaction( collection, isRoot, added.slice(), [], [], needSort );\n        }\n    }\n\n    // No changes...\n    isRoot && commit( collection );\n};\n\nexport function setTransaction( collection, items, options ){\n    const isRoot = begin( collection ),\n          nested = [];\n\n    var previous = collection.models,\n        added    = _reallocate( collection, items, nested, options );\n\n    const reusedCount = collection.models.length - added.length,\n          removed = reusedCount < previous.length ? (\n                        reusedCount ? _garbageCollect( collection, previous ) :\n                                        freeAll( collection, previous )\n                    ) : [];                    \n    \n    const addedOrChanged = nested.length || added.length,\n          sorted = ( addedOrChanged && sortElements( collection, options ) ) || added.length || options.sorted;\n\n    if( addedOrChanged || removed.length || sorted ){\n        if( markAsDirty( collection, options ) ){ \n            return new CollectionTransaction( collection, isRoot, added, removed, nested, sorted );\n        }\n    }\n\n    isRoot && commit( collection );\n};\n\n// Remove references to all previous elements, which are not present in collection.\n// Returns an array with removed elements.\nfunction _garbageCollect( collection : CollectionCore, previous : Record[] ) : Record[]{\n    const { _byId }  = collection,\n          removed = [];\n\n    // Filter out removed models and remove them from the index...\n    for( let record of previous ){\n        if( !_byId[ record.cid ] ){\n            removed.push( record );\n            free( collection, record );\n        }\n    }\n\n    return removed;\n}\n\n// reallocate model and index\nfunction _reallocate( collection : CollectionCore, source : any[], nested : Transaction[], options ){\n    var models      = Array( source.length ),\n        _byId : IdIndex = {},\n        merge       = options.merge == null ? true : options.merge,\n        _prevById   = collection._byId,\n        prevModels  = collection.models, \n        idAttribute = collection.model.prototype.idAttribute,\n        toAdd       = [],\n        orderKept   = true;\n\n    // for each item in source set...\n    for( var i = 0, j = 0; i < source.length; i++ ){\n        var item  = source[ i ],\n            model : Record = null;\n\n        if( item ){\n            var id  = item[ idAttribute ],\n                cid = item.cid;\n\n            if( _byId[ id ] || _byId[ cid ] ) continue;\n\n            model = _prevById[ id ] || _prevById[ cid ];\n        }\n\n        if( model ){\n            if( merge && item !== model ){\n                if( orderKept && prevModels[ j ] !== model ) orderKept = false;\n\n                var attrs = item.attributes || item;\n                const transaction = model._createTransaction( attrs, options );\n                transaction && nested.push( transaction );\n            }\n        }\n        else{\n            model = toModel( collection, item, options );\n            aquire( collection, model );\n            toAdd.push( model );\n        }\n\n        models[ j++ ] = model;\n        addIndex( _byId, model );\n    }\n\n    models.length = j;\n    collection.models   = models;\n    collection._byId    = _byId;\n\n    if( !orderKept ) options.sorted = true;\n\n    return toAdd;\n}\n\nfunction _reallocateEmpty( self, source, options ){\n    var len         = source ? source.length : 0,\n        models      = Array( len ),\n        _byId : IdIndex = {},\n        idAttribute = self.model.prototype.idAttribute;\n\n    for( var i = 0, j = 0; i < len; i++ ){\n        var src = source[ i ];\n\n        if( src && ( _byId[ src[ idAttribute ] ] || _byId[ src.cid ] ) ){\n            continue;\n        }\n\n        var model = toModel( self, src, options );\n\n        aquire( self, model );\n        models[ j++ ] = model;\n        addIndex( _byId, model );\n\n    }\n\n    models.length = j;\n    self._byId    = _byId;\n\n    return self.models = models;\n}\n\n\n/** WEBPACK FOOTER **\n ** ./src/collection/set.ts\n **/","/*************\n * Remove items from collections.\n * \n * Cannot be a part of two-phase transaction on object tree.\n * Can be executed in the scope of ad-hoc transaction or from the trigger, though.\n *\n * Implemented with low-level API. \n * Most frequent operation - single element remove. Thus, it have the fast-path.\n */\n\nimport { Record } from '../record/index.ts'\nimport { free, CollectionCore, CollectionTransaction, removeIndex } from './commons.ts'\nimport { Messenger } from '../objectplus/index.ts'\nimport { TransactionOptions, markAsDirty, begin, commit } from '../transactions.ts' \n\nconst { trigger2, trigger3 } = Messenger;\n\nexport function removeOne( collection : CollectionCore, el : Record | {} | string, options : TransactionOptions ) : Record {\n    var model : Record = collection.get( el );\n\n    if( model ){\n        const isRoot = begin( collection ),\n              models = collection.models;\n\n        // Remove model form the collection. \n        models.splice( models.indexOf( model ), 1 );\n        removeIndex( collection._byId, model );\n        \n        // Mark transaction as dirty. \n        const notify = markAsDirty( collection, options );\n\n        // Send out events.\n        if( notify ){\n            trigger3( model, 'remove', model, collection, options );\n            trigger3( collection, 'remove', model, collection, options );\n        } \n\n        free( collection, model );\n\n        notify && trigger2( collection, 'update', collection, options );\n\n        // Commit transaction.\n        isRoot && commit( collection );\n\n        return model;\n    }\n};\n\n/** Optimized for removing many elements\n * 1. Remove elements from the index, checking for duplicates\n * 2. Create new models array matching index\n * 3. Send notifications and remove references\n */\nexport function removeMany( collection : CollectionCore, toRemove : any[], options ){\n    const removed = _removeFromIndex( collection, toRemove );\n    if( removed.length ){\n        const isRoot = begin( collection );\n\n        _reallocate( collection, removed.length );\n\n        if( markAsDirty( collection, options ) ){\n            const transaction = new CollectionTransaction( collection, isRoot, [], removed, [], false );\n            transaction.commit();\n        }\n        else{\n            // Commit transaction.\n            isRoot && commit( collection );\n        }\n    }\n\n    return removed;\n};\n\n// remove models from the index...\nfunction _removeFromIndex( collection, toRemove ){\n    var removed = Array( toRemove.length ),\n        _byId   = collection._byId;\n\n    for( var i = 0, j = 0; i < toRemove.length; i++ ){\n        var model = collection.get( toRemove[ i ] );\n        if( model ){\n            removed[ j++ ] = model;\n            removeIndex( _byId, model );\n            free( collection, model );\n        }\n    }\n\n    removed.length = j;\n\n    return removed;\n}\n\n// Allocate new models array removing models not present in the index.\nfunction _reallocate( collection, removed ){\n    var prev   = collection.models,\n        models = collection.models = Array( prev.length - removed ),\n        _byId = collection._byId;\n\n    for( var i = 0, j = 0; i < prev.length; i++ ){\n        var model = prev[ i ];\n\n        if( _byId[ model.cid ] ){\n            models[ j++ ] = model;\n        }\n    }\n\n    models.length = j;\n}\n\n\n/** WEBPACK FOOTER **\n ** ./src/collection/remove.ts\n **/"],"sourceRoot":""}