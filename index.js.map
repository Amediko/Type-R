{"version":3,"sources":["webpack:///webpack/universalModuleDefinition","webpack:///webpack/bootstrap 3ef251236fe9ea7762bb","webpack:///./src/index.ts","webpack:///./src/objectplus/tools.ts","webpack:///./src/record/index.ts","webpack:///./src/record/transaction.ts","webpack:///./src/objectplus/index.ts","webpack:///./src/objectplus/mixins.ts","webpack:///./src/objectplus/events.ts","webpack:///./src/transactions.ts","webpack:///./src/validation.ts","webpack:///./src/references.ts","webpack:///./src/record/define.ts","webpack:///./src/record/attribute.ts","webpack:///./src/record/typespec.ts","webpack:///./src/record/nestedTypes.ts","webpack:///./src/record/basicTypes.ts","webpack:///./src/model.ts","webpack:///./src/collection/index.ts","webpack:///./src/collection/commons.ts","webpack:///./src/collection/add.ts","webpack:///./src/collection/set.ts","webpack:///./src/collection/remove.ts"],"names":[],"mappings":"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","file":"./index.js","sourcesContent":["(function webpackUniversalModuleDefinition(root, factory) {\n\tif(typeof exports === 'object' && typeof module === 'object')\n\t\tmodule.exports = factory();\n\telse if(typeof define === 'function' && define.amd)\n\t\tdefine([], factory);\n\telse if(typeof exports === 'object')\n\t\texports[\"Nested\"] = factory();\n\telse\n\t\troot[\"Nested\"] = factory();\n})(this, function() {\nreturn \n\n\n/** WEBPACK FOOTER **\n ** webpack/universalModuleDefinition\n **/"," \t// The module cache\n \tvar installedModules = {};\n\n \t// The require function\n \tfunction __webpack_require__(moduleId) {\n\n \t\t// Check if module is in cache\n \t\tif(installedModules[moduleId])\n \t\t\treturn installedModules[moduleId].exports;\n\n \t\t// Create a new module (and put it into the cache)\n \t\tvar module = installedModules[moduleId] = {\n \t\t\texports: {},\n \t\t\tid: moduleId,\n \t\t\tloaded: false\n \t\t};\n\n \t\t// Execute the module function\n \t\tmodules[moduleId].call(module.exports, module, module.exports, __webpack_require__);\n\n \t\t// Flag the module as loaded\n \t\tmodule.loaded = true;\n\n \t\t// Return the exports of the module\n \t\treturn module.exports;\n \t}\n\n\n \t// expose the modules object (__webpack_modules__)\n \t__webpack_require__.m = modules;\n\n \t// expose the module cache\n \t__webpack_require__.c = installedModules;\n\n \t// __webpack_public_path__\n \t__webpack_require__.p = \"\";\n\n \t// Load entry module and return exports\n \treturn __webpack_require__(0);\n\n\n\n/** WEBPACK FOOTER **\n ** webpack/bootstrap 3ef251236fe9ea7762bb\n **/","import * as tools from './objectplus/tools.ts'\nimport { ChainableAttributeSpec } from './record/index.ts'\nimport { Record as Model } from './model.ts' \n\nimport { Events } from './objectplus/events.ts'\nexport const { on, off, trigger, once, listenTo, stopListening, listenToOnce } = Events;\n\nimport { Collection } from './collection/index.ts'\n\nexport * from './objectplus/mixins.ts'\nexport * from './objectplus/events.ts'\n\nexport {\n    tools,\n    Model,\n    Collection,\n    transaction,\n    value\n}; \n\nfunction value( x ){\n    return new ChainableAttributeSpec({ value : x });\n}\n\nfunction transaction( method ){\n    return function( ...args ){\n        let result;\n        \n        this.transaction( () => {\n            result = method.apply( this, args );\n        });\n        \n        return result;\n    }\n}\n\n\n/** WEBPACK FOOTER **\n ** ./src/index.ts\n **/","/**\n * Simple overridable logging stubs\n *\n */\n\nclass Log {\n    level : Number = 2\n\n    error( ...args : any[] ) : void {\n        console.error.apply( console, args );\n    }\n\n    warn( ...args : any[] ) : void {\n        if( this.level > 0 ) console.warn.apply( console, args );\n    }\n\n    info(){\n        if( this.level > 1 ) console.info.apply( console, arguments );\n    }\n\n    debug(){\n        if( this.level > 2 ) console.log.apply( console, arguments );\n    }\n}\n\nexport let log = new Log();\n\n// Check if value is valid JSON.\nexport function isValidJSON( value : any ) : boolean {\n    if( value === null ){\n        return true;\n    }\n\n    switch( typeof value ){\n    case 'number' :\n    case 'string' :\n    case 'boolean' :\n        return true;\n\n    case 'object':\n        var proto = Object.getPrototypeOf( value );\n\n        if( proto === Object.prototype || proto === Array.prototype ){\n            return every( value, isValidJSON );\n        }\n    }\n\n    return false;\n}\n\n/**\n * Object manipulation helpers...\n */\n\nexport function getBaseClass( Class : Function ){\n    return Object.getPrototypeOf( Class.prototype ).constructor\n}\n\nexport function isEmpty( obj : {} ) : boolean {\n    if( obj ){\n        for( let key in obj ){\n            if( obj.hasOwnProperty( key ) ){\n                return false;\n            }\n        }\n    }\n\n    return true;\n}\n\ntype Iteratee = ( value : any, key? : string | number ) => any;\n\nfunction someArray( arr : any[], fun : Iteratee ) : any {\n    let result;\n\n    for( let i = 0; i < arr.length; i++ ){\n        if( result = fun( arr[ i ], i ) ){\n            return result;\n        }\n    }\n}\n\nfunction someObject( obj : {}, fun : Iteratee ) : any {\n    let result;\n\n    for( let key in obj ){\n        if( obj.hasOwnProperty( key ) ){\n            if( result = fun( obj[ key ], key ) ){\n                return result;\n            }\n        }\n    }\n}\n\nexport function some( obj, fun : Iteratee ) : any {\n    if( Object.getPrototypeOf( obj ) === ArrayProto ){\n        return someArray( obj, fun );\n    }\n    else{\n        return someObject( obj, fun );\n    }\n}\n\nexport function every( obj : { }, predicate : Iteratee ) : boolean {\n    return !some( obj, x => !predicate( x ) );\n}\n\nexport function getPropertyDescriptor( obj : {}, prop : string ) : PropertyDescriptor {\n    let desc : PropertyDescriptor;\n\n    for( let proto = obj; !desc && proto; proto = Object.getPrototypeOf( proto ) ) {\n        desc = Object.getOwnPropertyDescriptor( obj, prop );\n    }\n\n    return desc;\n}\n\nexport function omit( source : {}, ...rest : string[] ) : {}\nexport function omit( source ) : {} {\n    const dest = {}, discard = {};\n\n    for( let i = 1; i < arguments.length; i ++ ){\n        discard[ arguments[ i ] ] = true;\n    }\n\n    for( var name in source ) {\n        if( !discard[ name ] && source.hasOwnProperty( name ) ) {\n            dest[ name ] = source[ name ];\n        }\n    }\n\n    return dest;\n}\n\nexport function transform< A, B >( dest : { [ key : string ] : A }, source : { [ key : string ] : B }, fun : ( value : B, key : string ) => A | void ) : { [ key : string ] : A } {\n    for( var name in source ) {\n        if( source.hasOwnProperty( name ) ) {\n            var value = fun( source[ name ], name );\n            value === void 0 || ( dest[ name ] = < A >value );\n        }\n    }\n\n    return dest;\n}\n\nexport function fastAssign( dest : {}, source : {} ) : void {\n    for( var name in source ) {\n        dest[ name ] = source[ name ];\n    }\n}\n\nexport function fastDefaults( dest : {}, source : {} ) : void {\n    for( var name in source ) {\n        if( dest[ name ] === void 0 ){\n            dest[ name ] = source[ name ];\n        }\n    }\n}\n\nfunction forAllArgs( fun ) {\n    return function< T >( dest : T, ...sources ) : T {\n        for( var i = 0; i < sources.length; i++ ) {\n            const source = sources[ i ];\n            source && fun( dest, source );\n        }\n\n        return dest;\n    }\n}\n\nexport const assign = forAllArgs( ( dest, source ) => {\n    for( var name in source ) {\n        if( source.hasOwnProperty( name ) ) {\n            dest[ name ] = source[ name ];\n        }\n    }\n} );\n\nexport const defaults = forAllArgs( ( dest, source ) => {\n    for( var name in source ) {\n        if( source.hasOwnProperty( name ) && dest[ name ] === void 0 ) {\n             dest[ name ] = source[ name ];\n        }\n    }\n} );\n \nexport function once( func : Function ) : Function {\n    var memo, first = true;\n    return function() {\n        if ( first ) {\n            first = false;\n            memo = func.apply(this, arguments);\n            func = null;\n        }\n        return memo;\n    };\n}\n\n/**\n * notEqual( a, b ) function, for deep JSON comparison\n * Optimized for primitive types\n */\n\nconst ArrayProto = Array.prototype,\n      DateProto = Date.prototype,\n      ObjectProto = Object.prototype;\n\nexport function notEqual( a : any, b : any) : boolean {\n    if( a === b ) return false;\n\n    if( a && b && typeof a == 'object' && typeof b == 'object' ) {\n        const protoA = Object.getPrototypeOf( a );\n\n        if( protoA !== Object.getPrototypeOf( b ) ) return true;\n\n        switch( protoA ){\n            case DateProto   : return +a !== +b;\n            case ArrayProto  : return arraysNotEqual( a, b );\n            case ObjectProto :\n            case null:\n                return objectsNotEqual( a, b );\n        }\n    }\n\n    return true;\n}\n\nfunction objectsNotEqual( a, b ) {\n    const keysA = Object.keys( a );\n\n    if( keysA.length !== Object.keys( b ).length ) return true;\n\n    for( let i = 0; i < keysA.length; i++ ) {\n        const key = keysA[ i ];\n\n        if( !b.hasOwnProperty( key ) || notEqual( a[ key ], b[ key ] ) ) {\n            return true;\n        }\n    }\n\n    return false;\n}\n\nfunction arraysNotEqual( a, b ) {\n    if( a.length !== b.length ) return true;\n\n    for( let i = 0; i < a.length; i++ ) {\n        if( notEqual( a[ i ], b[ i ] ) ) return true;\n    }\n\n    return false;\n}\n\n\nvar numericKeys    = [ 1, 4, 5, 6, 7, 10, 11 ],\n    msDatePattern  = /\\/Date\\(([0-9]+)\\)\\//,\n    isoDatePattern = /^(\\d{4}|[+\\-]\\d{6})(?:-(\\d{2})(?:-(\\d{2}))?)?(?:T(\\d{2}):(\\d{2})(?::(\\d{2})(?:\\.(\\d{3}))?)?(?:(Z)|([+\\-])(\\d{2})(?::(\\d{2}))?)?)?$/;\n\nexport function parseDate( date ) {\n    var msDate, timestamp, struct, minutesOffset = 0;\n\n    if( msDate = msDatePattern.exec( date ) ) {\n        timestamp = Number( msDate[ 1 ] );\n    }\n    else if( ( struct = isoDatePattern.exec( date )) ) {\n        // avoid NaN timestamps caused by undefined values being passed to Date.UTC\n        for( var i = 0, k; ( k = numericKeys[ i ] ); ++i ) {\n            struct[ k ] = +struct[ k ] || 0;\n        }\n\n        // allow undefined days and months\n        struct[ 2 ] = (+struct[ 2 ] || 1) - 1;\n        struct[ 3 ] = +struct[ 3 ] || 1;\n\n        if( struct[ 8 ] !== 'Z' && struct[ 9 ] !== undefined ) {\n            minutesOffset = struct[ 10 ] * 60 + struct[ 11 ];\n\n            if( struct[ 9 ] === '+' ) {\n                minutesOffset = 0 - minutesOffset;\n            }\n        }\n\n        timestamp =\n            Date.UTC( struct[ 1 ], struct[ 2 ], struct[ 3 ], struct[ 4 ], struct[ 5 ] + minutesOffset, struct[ 6 ],\n                      struct[ 7 ] );\n    }\n    else {\n        timestamp = Date.parse( date );\n    }\n\n    return timestamp;\n}\n\n\n\n/** WEBPACK FOOTER **\n ** ./src/objectplus/tools.ts\n **/","import { Record, RecordDefinition, AttributeDescriptorMap } from './transaction.ts'\nimport { assign, defaults, omit, Class, ClassDefinition } from '../objectplus/index.ts'\nimport { compile, AttributesSpec } from './define.ts'\nimport { ChainableAttributeSpec } from './typespec.ts'\n\nimport { TransactionalType } from './nestedTypes.ts'\nimport './basicTypes.ts'\n\nRecord.define = function( protoProps : RecordDefinition, staticProps ){\n    const baseProto : Record = Object.getPrototypeOf( this.prototype ),\n            BaseConstructor = < typeof Record >baseProto.constructor;\n\n    if( protoProps ) {\n        // Compile attributes spec, creating definition mixin.\n        const definition = compile( getAttributes( protoProps ), <AttributesSpec> baseProto._attributes );\n\n        // Explicit 'properties' declaration overrides auto-generated attribute properties.\n        if( protoProps.properties === false ){\n            definition.properties = {};\n        }\n\n        assign( definition.properties, protoProps.properties || {} );\n\n        // Merge in definition.\n        defaults( definition, omit( protoProps, 'attributes', 'collection' ) );            \n        Class.define.call( this, definition, staticProps );\n    }\n\n    return this;\n}\n\nRecord._attribute = TransactionalType;\n\nfunction getAttributes({ defaults, attributes } : RecordDefinition ) : AttributeDescriptorMap {\n    return typeof defaults === 'function' ? (<any>defaults)() : attributes || defaults;\n}\n\nexport { Record, ChainableAttributeSpec }\n\n\n/** WEBPACK FOOTER **\n ** ./src/record/index.ts\n **/","/**\n * Record core implementing transactional updates.\n * The root of all definitions. \n */\n\nimport { isEmpty, EventHandlers, Class, ClassDefinition, Constructor, trigger3, log, define } from '../objectplus/index.ts'\n\nimport { begin as _begin, markAsDirty as _markAsDirty, commit, Transactional, Transaction, TransactionOptions, Owner } from '../transactions.ts'\nimport { ChildrenErrors } from '../validation.ts'\n\n/***************************************************************\n * Record Definition as accepted by Record.define( definition )\n */\n\nexport interface RecordDefinition extends ClassDefinition {\n    attributes? : AttributeDescriptorMap\n    defaults? : AttributeDescriptorMap | ( () => AttributeDescriptorMap )\n    collection? : typeof Transactional | {}\n}\n\nexport interface AttributeDescriptorMap {\n    [ name : string ] : AttributeDescriptor\n}\n\nexport interface AttributeDescriptor {\n    type? : Constructor< any >\n    value? : any\n\n    parse? : AttributeParse\n    toJSON? : AttributeToJSON\n   \n    getHooks? : GetHook[]\n    transforms? : Transform[]\n    changeHandlers? : ChangeHandler[]\n\n    _onChange? : ChangeAttrHandler\n}\n\nexport type GetHook = ( value : any, key : string ) => any;\n\nexport type ChangeAttrHandler = ( ( value : any, attr : string ) => void ) | string;\nexport type Transform = ( next : any, options : TransactionOptions, prev : any, record : Record ) => any;\nexport type ChangeHandler = ( next : any, prev : any, record : Record ) => void;\n\nexport type AttributeToJSON = ( value : any, key : string ) => any\nexport type AttributeParse = ( value : any, key : string ) => any\n\n/*************************************\n * Attribute definitions\n */\nexport interface AttributesValues {\n    [ key : string ] : any\n}\n\nexport type CloneAttributesCtor = new ( x : AttributesValues ) => AttributesValues\n\nexport interface AttributesSpec {\n    [ key : string ] : Attribute\n}\n\nexport interface Attribute extends AttributeUpdatePipeline, AttributeSerialization {\n    clone( value : any ) : any\n    create() : any\n    validate( record : Record, value : any, key : string )\n}\n\nexport interface AttributeUpdatePipeline{\n    canBeUpdated( prev : any, next : any ) : boolean\n    transform : Transform\n    isChanged( a : any, b : any ) : boolean\n    handleChange : ChangeHandler\n}\n\nexport interface AttributeSerialization {\n    toJSON : AttributeToJSON\n    parse : AttributeParse\n}\n\n/*******************************************************\n * Record core implementation\n */\n\ninterface ConstructorOptions extends TransactionOptions{\n    clone? : boolean\n}\n\n// Client unique id counter\nlet _cidCounter : number = 0;\n\n@define({\n    // Default client id prefix \n    cidPrefix : 'm',\n\n    // Default id attribute name\n    idAttribute : 'id'\n})\nexport class Record extends Transactional implements Owner {\n    // Implemented at the index.ts to avoid circular dependency. Here we have just proper singature.\n    static define( protoProps : RecordDefinition, staticProps? ) : typeof Record { return <any>Transactional.define( protoProps, staticProps ); }\n    static predefine : () => typeof Record\n    static Collection : typeof Transactional\n    \n    /***********************************\n     * Core Members\n     */\n    // Previous attributes\n    _previousAttributes : {}\n\n    // Current attributes    \n    attributes : AttributesValues\n\n    // Lazily evaluated changed attributes hash\n    _changedAttributes : AttributesValues\n\n    get changed(){\n        let changed = this._changedAttributes;\n\n        if( !changed ){\n            const prev = this._previousAttributes;\n            changed = {};\n\n            this.forEachAttr( this.attributes, ( value, key, attribute ) => { \n                if( attribute.isChanged( value, prev[ key ] ) ){\n                    changed[ key ] = value;\n                }\n            } );\n\n            this._changedAttributes = changed;\n        }\n\n        return changed;    \n    }\n\n    hasChanged( key : string ) : boolean {\n        const { _previousAttributes } = this;\n        if( !_previousAttributes ) return false;\n\n        return key ?\n                this._attributes[ key ].isChanged( this.attributes[ key ], _previousAttributes[ key ] ) :\n                !isEmpty( this.changed );\n    }\n\n    previous( key : string ) : any {\n        if( key ){\n            const { _previousAttributes } = this;\n            if( _previousAttributes ) return _previousAttributes[ key ];\n        }\n        \n        return null;\n    }\n\n    // Returns Record owner skipping collections. TODO: Move out\n    getOwner() : Owner {\n        const owner : any = this._owner;\n\n        // If there are no key, owner must be transactional object, and it's the collection.\n        // We don't expect that collection can be the member of collection, so we're skipping just one level up. An optimization.\n        return this._ownerKey ? owner : owner && owner._owner;\n    }\n\n    /***********************************\n     * Identity managements\n     */\n\n    // Id attribute name ('id' by default)\n    idAttribute : string;\n\n    // Fixed 'id' property pointing to id attribute\n    get id() : string | number { return this.attributes[ this.idAttribute ]; }\n    set id( x : string | number ){ setAttribute( this, this.idAttribute, x ); }\n\n    /***********************************\n     * Dynamically compiled stuff\n     */\n\n    // Attributes specifications \n    _attributes : AttributesSpec\n    \n    // Attributes object copy constructor\n    Attributes : CloneAttributesCtor\n\n    // forEach function for traversing through attributes, with protective default implementation\n    // Overriden by dynamically compiled loop unrolled function in define.ts\n    forEachAttr( attrs : {}, iteratee : ( value : any, key? : string, spec? : Attribute ) => void ) : void {\n        const { _attributes } = this;\n\n        for( let name in attrs ){\n            const spec = _attributes[ name ];\n\n            if( spec ){\n                iteratee( attrs[ name ], name, spec );\n            }\n            else{\n                log.warn( '[Unknown Attribute]', this, 'Unknown record attribute \"' + name + '\" is ignored:', attrs );\n            }\n        }\n    }\n\n    each( iteratee : ( value? : any, key? : string ) => void, context? : any ){\n        const fun = arguments.length === 2 ? ( v, k ) => iteratee.call( context, v, k ) : iteratee,\n            { attributes } = this;\n\n        for( const key in attributes ){\n            const value = attributes[ key ];\n            if( value !== void 0 ) fun( value, key );\n        }\n    }\n\n    // Attributes-level serialization\n    _toJSON(){ return {}; }\n\n    // Attributes-level parse\n    _parse( data ){ return data; }\n\n    // Create record default values, optionally augmenting given values.\n    defaults( values? : {} ){ return {}; }\n\n    // Event map for change:attribute events. \n    _listenToSelf : EventHandlers\n\n    /***************************************************\n     * Record construction\n     */\n    // Create record, optionally setting an owner\n    constructor( a_values? : {}, a_options? : ConstructorOptions, owner? : Owner ){\n        super( _cidCounter++, owner );\n\n        const options = a_options || {},\n              values = ( options.parse ? this.parse( a_values ) :  a_values ) || {};\n\n        // TODO: type error for wrong object.\n\n        const attributes = options.clone ? cloneAttributes( this, values ) : this.defaults( values ); \n\n        this.forEachAttr( attributes, ( value : any, key : string, attr : AttributeUpdatePipeline ) => {\n            const next = attributes[ key ] = attr.transform( value, options, void 0, this );\n                  attr.handleChange( next, void 0, this );\n        });\n\n        this.attributes = this._previousAttributes = attributes;\n\n        this.initialize( a_values, a_options );\n\n        if( this._listenToSelf ) this.listenTo( this, this._listenToSelf );\n    }\n\n    // Initialization callback, to be overriden by the subclasses \n    initialize( values?, options? ){}\n\n    // Deeply clone record, optionally setting new owner.\n    clone( owner? : any ) : this {\n        return new (<any>this.constructor)( this.attributes, { clone : true }, owner );\n    }\n\n    // Validate attributes.\n    _validateNested( errors : ChildrenErrors ) : number {\n        var length    = 0;\n\n        this.forEachAttr( this.attributes, ( value, name, attribute ) => {\n            const error = attribute.validate( this, value, name );\n\n            if( error ){\n                errors[ name ] = error;\n                length++;\n            }\n        } );\n\n        return length;\n    }\n\n    // Get attribute by key\n    get( key : string ) : any {\n        return this[ key ];\n    }\n\n    /**\n     * Serialization control\n     */\n\n    // Default record-level serializer, to be overriden by subclasses \n    toJSON() : Object {\n        const json = {};\n\n        this.forEachAttr( this.attributes, ( value, key : string, { toJSON } : AttributeSerialization ) =>{\n            // If attribute serialization is not disabled, and its value is not undefined...\n            if( toJSON && value !== void 0 ){\n                // ...serialize it according with its spec.\n                json[ key ] = toJSON.call( this, value, key );\n            }\n        });\n\n        return json;\n    }\n    \n    // Default record-level parser, to be overriden by the subclasses.\n    parse( data ){\n        // Call dynamically compiled loop-unrolled attribute-level parse function.\n        return this._parse( data );\n    }\n\n    /**\n     * Transactional control\n     */\n\n    // Polimorphic set method.\n    set( key : string, value : any, options? : TransactionOptions ) : this\n    set( attrs : {}, options? : TransactionOptions ) : this\n    set( a, b?, c? ) : this {\n        if( typeof a === 'string' ){\n            if( c ){\n                return <this> super.set({ [ a ] : b }, c );\n            }\n            else{\n                setAttribute( this, a, b );\n                return this;\n            } \n        }\n        else{\n            return <this> super.set( a, b );\n        }\n    }\n\n    // TODO: make transaction brackets polymorphic\n    transaction( fun : ( self : this ) => void, options : TransactionOptions = {} ) : void{\n        const isRoot = begin( this );\n        fun.call( this, this );\n        isRoot && commit( this, options );\n    }\n    \n    // Create transaction. TODO: Move to transaction constructor\n    _createTransaction( a_values : {}, options : TransactionOptions = {} ) : Transaction {\n        const isRoot = begin( this ),\n              changes : string[] = [],\n              nested : RecordTransaction[]= [],\n              { attributes } = this,\n              values = options.parse ? this.parse( a_values ) : a_values,\n              merge = !options.reset;\n\n        if( Object.getPrototypeOf( values ) === Object.prototype ){\n            this.forEachAttr( values, ( value, key : string, attr : AttributeUpdatePipeline ) => {\n                const prev = attributes[ key ];\n\n                // handle deep update...\n                if( merge && attr.canBeUpdated( prev, value ) ) { // todo - skip empty updates.\n                    const nestedTransaction = prev._createTransaction( value, options );\n                    if( nestedTransaction ){\n                        nested.push( nestedTransaction );\n                        changes.push( key );\n                    }\n\n                    return;\n                }\n\n                // cast and hook...\n                const next = attr.transform( value, options, prev, this );\n\n                if( attr.isChanged( next, prev ) ) {\n                    attributes[ key ] = next;\n                    changes.push( key );\n\n                    // Do the rest of the job after assignment\n                    attr.handleChange( next, prev, this );\n                }\n            } );\n        }\n        else{\n            log.error( '[Type Error]', this, 'Record update rejected (', values, '). Incompatible type.' );\n        }\n\n        if( nested.length || changes.length ){\n            return new RecordTransaction( this, isRoot, nested, changes );\n        }\n        \n        // No changes\n        isRoot && commit( this, options );\n    }\n\n    // Handle nested changes\n    _onChildrenChange( child : Transactional, options : TransactionOptions ) : void {        \n        this.forceAttributeChange( child._ownerKey, options );\n    }\n\n    // Simulate attribute change \n    forceAttributeChange( key : string, options : TransactionOptions = {} ){\n        // Touch an attribute in bounds of transaction\n        const isRoot = begin( this );\n\n        markAsDirty( this );\n        \n        options.silent || trigger3( this, 'change:' + key, this, this.attributes[ key ], options );\n\n        isRoot && commit( this, options );\n    }\n\n    // Returns owner without the key (usually it's collection)\n    get collection() : any {\n        return this._ownerKey ? null : this._owner;\n    }\n\n    // Dispose object and all childrens\n    dispose(){\n        this.forEachAttr( this.attributes, ( value, key ) => {\n            if( value && this === value._owner ){\n                value.dispose();\n            }\n        });\n\n        super.dispose();\n    }\n};\n\n/***********************************************\n * Helper functions\n */\n\nfunction begin( record : Record ){\n    if( _begin( record ) ){\n        record._previousAttributes = new record.Attributes( record.attributes );\n        return true;\n    }\n    \n    return false;\n}\n\nfunction markAsDirty( record ){\n    _markAsDirty( record );\n    record._changedAttributes = null;\n}\n\n// Deeply clone record attributes\nfunction cloneAttributes( record : Record, a_attributes : AttributesValues ) : AttributesValues {\n    const attributes = new record.Attributes( a_attributes );\n\n    record.forEachAttr( attributes, function( value, name, attr : Attribute ){\n        attributes[ name ] = attr.clone( value ); //TODO: Add owner?\n    } );\n\n    return attributes;\n}\n\n // Optimized single attribute transactional update. To be called from attributes setters\n // options.silent === false, parse === false. \nexport function setAttribute( record : Record, name : string, value : any ) : void {\n    const isRoot  = begin( record ),\n          options = {},\n        { attributes } = record,\n          spec = record._attributes[ name ],\n          prev = attributes[ name ];\n\n    // handle deep update...\n    if( spec.canBeUpdated( prev, value ) ) {\n        const nestedTransaction = ( <Transactional> prev )._createTransaction( value, options );\n        if( nestedTransaction ){\n            nestedTransaction.commit( options, true );\n            markAsDirty( record );\n            trigger3( record, 'change:' + name, record, prev, options );\n        }\n    }\n    else {\n        // cast and hook...\n        const next = spec.transform( value, options, prev, record );\n\n        if( spec.isChanged( next, prev ) ) {\n            attributes[ name ] = next;\n\n            // Do the rest of the job after assignment\n            spec.handleChange( next, prev, record );\n\n            markAsDirty( record );\n            trigger3( record, 'change:' + name, record, next, options );\n\n        }\n    }\n\n    isRoot && commit( record, options );\n}\n\n// Transaction class. Implements two-phase transactions on object's tree. \nclass RecordTransaction implements Transaction {\n    // open transaction\n    constructor( public object : Record, public isRoot : boolean, public nested : Transaction[], public changes : string[] ){\n        markAsDirty( object );\n    }\n\n    // commit transaction\n    commit( options : TransactionOptions = {}, isNested? : boolean ) : void {\n        const { nested, object, changes } = this;\n\n        // Commit all pending nested transactions...\n        for( let transaction of nested ){ \n            transaction.commit( options, true );\n        }\n\n        // Notify listeners on attribute changes...\n        if( !options.silent ){\n            const { attributes } = object;\n            for( let key of changes ){\n                trigger3( object, 'change:' + key, object, attributes[ key ], options );\n            }\n        }\n\n        this.isRoot && commit( object, options, isNested ); // Do not tell parent to update.\n    }\n}\n\n\n/** WEBPACK FOOTER **\n ** ./src/record/transaction.ts\n **/","export * from './tools.ts'\nexport * from './mixins.ts'\nexport * from './events.ts'\n\n\n/** WEBPACK FOOTER **\n ** ./src/objectplus/index.ts\n **/","/**\n * Mixins and @define metaprogramming class extensions\n * \n * Vlad Balin & Volicon, (c) 2016\n */\nimport { log, assign, omit, getPropertyDescriptor, getBaseClass, defaults, transform } from './tools.ts'\n\ntype MergeRule = 'merge' | 'pipe' | 'sequence' | 'reverse' | 'every' | 'some'\n\ninterface IMixinRules {\n    [ propertyName : string ] : MergeRule | IMixinRules\n}\n\ninterface PropertyMap {\n    [ name : string ] : Property\n}\n\ntype Property = PropertyDescriptor | ( () => any )\n\nexport interface ClassDefinition {\n    properties? : PropertyMap | boolean\n    mixins? : Array< Object >\n    mixinRules? : IMixinRules\n    [ name : string ] : any\n}\n\ndeclare function __extends( a, b )\n\nexport interface Constructor< T >{\n    new ( ...args : any[] ) : T\n}\n\nexport interface ExtendableConstructor< T > extends Constructor< T >{\n    prototype : Class\n    create( a : any, b? : any, c? : any ) : Class\n    mixins( ...mixins : ( Constructor<any> | {} )[] ) : ExtendableConstructor< T >\n    mixinRules( mixinRules : IMixinRules ) : ExtendableConstructor< T >\n    mixTo( ...args : Constructor<any>[] ) : ExtendableConstructor< T >\n    define( definition : ClassDefinition, staticProps? : {} ) : ExtendableConstructor< T >\n    extend(spec? : ClassDefinition, statics? : {} ) : ExtendableConstructor< T >\n    predefine() : ExtendableConstructor< T >\n}\n\ntype ClassConstructor = ExtendableConstructor< Class >\n\n// Base class, holding metaprogramming class extensions\n// Supports mixins, and Class.define metaprogramming method.\nexport class Class {\n\n    // Generic class factory. May be overridden for abstract classes. Not inherited.\n    static create( a : any, b? : any, c? : any ) : Class {\n        return new (<any>this)( a, b, c );\n    }\n\n    protected static _mixinRules : IMixinRules = { properties : 'merge' };\n\n    /**\n     * Attach mixins to class prototype.\n     */\n    static mixins( ...mixins : ( Function | {} )[] ) : typeof Class {\n        const proto      = this.prototype,\n              mergeRules : IMixinRules = this._mixinRules || {};\n\n        for( var i = mixins.length - 1; i >= 0; i-- ) {\n            const mixin = mixins[ i ];\n            if( mixin instanceof Array ) {\n                Class.mixins.apply( this, mixin );\n            }\n            else if( typeof mixin === 'function' ){\n                defaults( this, mixin );\n                mergeProps( proto, (<Function>mixin).prototype, mergeRules );\n            }\n            else {\n                mergeProps( proto, mixin, mergeRules );\n            }\n        }\n\n        return this;\n    }\n\n    // Inversion of control version of Class.mixin.\n    static mixTo< T >( ...args : Function[] ) : typeof Class {\n        for( let Ctor of args ) {\n            Class.mixins.call( Ctor, this );\n        }\n\n        return this;\n    }\n\n    // Members merging policy is controlled by MyClass.mixinRules property.\n    // mixinRules are properly inherited and merged.\n    static mixinRules( mixinRules : IMixinRules ) : ExtendableConstructor< Class > {\n        const Base = Object.getPrototypeOf( this.prototype ).constructor;\n\n        if( Base._mixinRules ) {\n            mergeProps( mixinRules, Base._mixinRules );\n        }\n\n        this._mixinRules = mixinRules;\n        return this;\n    }\n\n    // Autobinding helper to be used from constructors\n    bindAll( ...names : string [] ) : void\n    bindAll() {\n        for( var i = 0; i < arguments.length; i++ ) {\n            const name = arguments[ i ];\n\n            this[ name ] = this[ name ].bind( this );\n        }\n    }\n\n    /**\n     * Main metaprogramming method. May be overriden in subclasses to customize the behavior.   \n     * - Merge definition to the prototype.\n     * - Add native properties with descriptors from spec.properties to the prototype.\n     * - Prevents inheritance of 'create' factory method.\n     * - Assign mixinRules static property, and merge it with parent.\n     * - Adds mixins.\n     */\n    static define( definition : ClassDefinition = {}, staticProps? : {} ) : typeof Class {\n        // That actually might happen when we're using @define decorator... \n        if( !this.define ){\n            log.error( \"[Class.define] Class must have class extensions to use @define decorator. Use '@extendable' before @define, or extend the base class with class extensions.\", definition );\n            return this;\n        }\n\n        this.predefine();\n\n        // Obtain references to prototype and base class.\n        const proto = this.prototype;\n\n        // Extract prototype properties from the definition.\n        const protoProps = omit( definition, 'properties', 'mixins', 'mixinRules' ),\n            { properties = <PropertyMap> {}, mixins, mixinRules } = definition;\n\n        // Update prototype and statics.\n        assign( proto, protoProps );\n        assign( this, staticProps );\n\n        // Define native properties.\n        properties && Object.defineProperties( proto, transform( {}, <PropertyMap>properties, toPropertyDescriptor ) );\n\n        // Apply mixins and mixin rules.\n        mixinRules && this.mixinRules( mixinRules );\n        mixins && this.mixins( mixins );\n\n        return this;\n    }\n\n    // Backbone-compatible extend method to be used in ES5 and for backward compatibility\n    static extend(spec? : ClassDefinition, statics? : {} ) : typeof Class {\n        let Subclass : typeof Class;\n\n        // 1. Create the subclass (ES5 compatibility shim).\n        // If constructor function is given...\n        if( spec && spec.hasOwnProperty( 'constructor' ) ){\n            // ...we need to manually call internal TypeScript __extend function. Hack! Hack!\n            Subclass = <any>spec.constructor; \n            __extends( Subclass, this );\n        }\n        // Otherwise, create the subclall in usual way.\n        else{\n            Subclass = class Subclass extends this {};\n        }\n\n        // 2. Apply definitions\n        return spec ? Subclass.define( spec, statics ) : Subclass.predefine();\n    }\n\n    // Do the magic necessary for forward declarations.\n    // Must be written in the way that it's safe to call twice.\n    static predefine() : typeof Class {\n        const BaseClass : typeof Class = getBaseClass( this );\n\n        // Make sure we don't inherit class factories.\n        if( BaseClass.create === this.create ) {\n            this.create = Class.create;\n        }\n\n        return this;\n    }\n}\n\nfunction toPropertyDescriptor( x : Property ) : PropertyDescriptor {\n    if( x ){\n        return typeof x === 'function' ? { get : < () => any >x } : <PropertyDescriptor> x;\n    }\n}\n\n// @mixinRules({ ... }) decorator\nexport function mixinRules( rules : IMixinRules ) {\n    return createDecorator( 'mixinRules', rules );\n}\n\n// @mixins( A, B, C ) decorator\nexport function mixins( ...list : {}[] ) {\n    return createDecorator( 'mixins', list );\n}\n\n// @extendable decorator. Convert class to be an ExtendableConstructor.\nexport function extendable( Type : Function ) : void {\n    Class.mixTo( Type );\n}\n\n// @predefine decorator for forward definitions. \nexport function predefine( Constructor : ExtendableConstructor< any > ) : void {\n    Constructor.predefine();\n}\n\n// @define decorator for metaprogramming magic.\nexport function define( spec : ClassDefinition ){\n    return createDecorator( 'define', spec );\n} \n\n// Create ES7 class decorator forwarding call to the static class member.\n// If there is no such a member, forward the call to Class.\nfunction createDecorator( name : string, spec : {} ){\n    return function( Ctor : Function ) : void {\n        if( Ctor[ name ] ) {\n            Ctor[ name ]( spec );\n        }\n        else {\n            Class[ name ].call( Ctor, spec );\n        }\n    }\n}\n\n/***********************\n * Mixins helpers\n */\nfunction mergeObjects( a : {}, b : {}, rules? : IMixinRules ) : {} {\n    const x = assign( {}, a );\n    return mergeProps( x , b, rules );\n}\n\ninterface IMergeFunctions {\n    [ name : string ] : ( a : Function, b : Function ) => Function\n}\n\nconst mergeFunctions : IMergeFunctions = {\n    pipe< A, B, C >( a: ( x : B ) => C, b : ( x : A ) => B ) : ( x : A ) => C {\n        return function( x : A ) : C {\n            return a.call( this, b.call( this, x ) );\n        }\n    },\n\n    sequence( a : Function, b : Function ){\n        return function() : void {\n            a.apply( this, arguments );\n            b.apply( this, arguments );\n        }\n    },\n\n    reverse( a : Function, b : Function ){\n        return function() : void {\n            b.apply( this, arguments );\n            a.apply( this, arguments );\n        }\n    },\n\n    every( a : Function, b : Function ){\n        return function() {\n            return a.apply( this, arguments ) && b.apply( this, arguments );\n        }\n    },\n\n    some( a : Function, b : Function ){\n        return function() {\n            return a.apply( this, arguments ) || b.apply( this, arguments );\n        }\n    }\n};\n\nfunction mergeProps< T extends {} >( target : T, source : {}, rules : IMixinRules = {}) : T {\n    for( let name of Object.keys( source ) ) {\n        const sourceProp = Object.getOwnPropertyDescriptor( source, name ),\n              destProp   = getPropertyDescriptor( target, name ); // Shouldn't be own\n\n        if( destProp ) {\n            const rule  = rules[ name ],\n                  value = destProp.value;\n\n            if( rule && value ) {\n                target[ name ] = typeof rule === 'object' ?\n                    mergeObjects( value, sourceProp.value, rule ) :(\n                        rule === 'merge' ?\n                            mergeObjects( value, sourceProp.value ) :\n                            mergeFunctions[ rule ]( value, sourceProp.value )\n                    );\n            }\n        }\n        else {\n            Object.defineProperty( target, name, sourceProp );\n        }\n    }\n\n    return target;\n}\n\n\n/** WEBPACK FOOTER **\n ** ./src/objectplus/mixins.ts\n **/","import { once } from './tools.ts'\nimport { Class, mixins, define, extendable } from './mixins.ts'\n\n/************\n * JIT-Optimized monomorphic functions to trigger single event \n */\nexport function trigger0( self : Messenger, name : string ) : void {\n    const { _events } = self;\n    if( _events ){\n        const { all } = _events;\n        _fireEvent0( _events[ name ] );\n        _fireEvent1( all, name );\n    }\n};\n\nexport function trigger1( self : Messenger, name : string, a : any ) : void {\n    const { _events } = self;\n    if( _events ){\n        const { all } = _events;\n        _fireEvent1( _events[ name ], a );\n        _fireEvent2( all, name, a );\n    }\n};\n\nexport function trigger2( self : Messenger, name : string, a, b ) : void {\n    const { _events } = self;\n    if( _events ){\n        const { all } = _events;\n        _fireEvent2( _events[ name ], a, b );\n        _fireEvent3( all, name, a, b );\n    }\n};\n\nexport function trigger3( self : Messenger, name : string, a, b, c ) : void{\n    const { _events } = self;\n    if( _events ){\n        const { all } = _events;\n        _fireEvent3( _events[ name ], a, b, c );\n        _fireEvent4( all, name, a, b, c );\n    }\n};\n\n// Backbone.Events\n// ---------------\n\n// A module that can be mixed in to *any object* in order to provide it with\n// a custom event channel. You may bind a callback to an event with `on` or\n// remove with `off`; `trigger`-ing an event fires all callbacks in\n// succession.\n//\n//     var object = {};\n//     _.extend(object, Backbone.Events);\n//     object.on('expand', function(){ alert('expanded'); });\n//     object.trigger('expand');\n//\n\n// Regular expression used to split event strings.\nvar eventSplitter = /\\s+/;\n\n// Iterates over the standard `event, callback` (as well as the fancy multiple\n// space-separated events `\"change blur\", callback` and jQuery-style event\n// maps `{event: callback}`).\nvar eventsApi = function(iteratee, events, name, callback, opts) {\n    var i = 0, names;\n    if (name && typeof name === 'object') {\n        // Handle event maps.\n        if (callback !== void 0 && 'context' in opts && opts.context === void 0) opts.context = callback;\n        for (names = keys(name); i < names.length ; i++) {\n            events = eventsApi(iteratee, events, names[i], name[names[i]], opts);\n        }\n    } else if (name && eventSplitter.test(name)) {\n        // Handle space separated event names by delegating them individually.\n        for (names = name.split(eventSplitter); i < names.length; i++) {\n            events = iteratee(events, names[i], callback, opts);\n        }\n    } else {\n        // Finally, standard events.\n        events = iteratee(events, name, callback, opts);\n    }\n    return events;\n};\n\nfunction isEmpty( obj : {} ) : boolean {\n    for( var i in obj ){\n        return false;\n    }\n\n    return true;\n}\n\nlet _idCount = 0;\nfunction uniqueId(){\n    return 'l' + _idCount++;\n}\n\nclass ListeningTo {\n    count : number = 0\n    constructor( public obj, public objId, public id, public listeningTo ){}\n}\n\ninterface ListeningToMap {\n    [ id : string ] : ListeningTo\n}\n\ninterface Listeners {\n    [ id : string ] : Messenger\n}\n\nexport interface EventHandlers {\n    [ events : string ] : Function | string\n}\n\n/*************************\n * Messenger is extendable class with capabilities of sending and receiving messages.\n * This class itself can serve as both mixin and base class\n */\n\n// Attach default cid prefix to the prototype.\n@define({\n    cidPrefix : 'l'\n})\n@extendable\nexport abstract class Messenger implements Class {\n    bindAll : ( ...names : string [] ) => void\n\n    _events : EventsMap = void 0;\n    _listeners : Listeners = void 0;\n    _listeningTo : ListeningToMap = void 0;\n    cidPrefix : string\n    cid : string\n\n    static create : ( a : any, b? : any, c? : any ) => Messenger\n    static define : ( a : any, b? : any ) => typeof Messenger\n    static extend : ( a? : any, b? : any ) => typeof Messenger\n\n    constructor( cid : string | number ){\n        this.cid = this.cidPrefix + cid;\n    }\n\n    // Bind an event to a `callback` function. Passing `\"all\"` will bind\n    // the callback to all events fired.\n    on(name, callback, context) {\n        return internalOn(this, name, callback, context);\n    }\n    // Remove one or many callbacks. If `context` is null, removes all\n    // callbacks with that function. If `callback` is null, removes all\n    // callbacks for the event. If `name` is null, removes all bound\n    // callbacks for all events.\n    off(name? : string, callback? : Function, context? ) {\n        if (!this._events) return this;\n        this._events = eventsApi(offApi, this._events, name, callback,\n                                new OffOptions(\n                                    context,\n                                    this._listeners )\n                                );\n        return this;\n    }\n\n    // Tell this object to stop listening to either specific events ... or\n    // to every object it's currently listening to.\n    stopListening( obj? : Messenger, name? : string, callback? : Function ) {\n        var listeningTo = this._listeningTo;\n        if (!listeningTo) return this;\n\n        var ids = obj ? [obj.cid] : keys(listeningTo);\n\n        for (var i = 0; i < ids.length; i++) {\n            var listening = listeningTo[ids[i]];\n\n            // If listening doesn't exist, this object is not currently\n            // listening to obj. Break out early.\n            if (!listening) break;\n\n            listening.obj.off(name, callback, this);\n        }\n        if (isEmpty(listeningTo)) this._listeningTo = void 0;\n\n        return this;\n    }\n\n    // Inversion-of-control versions of `on`. Tell *this* object to listen to\n    // an event in another object... keeping track of what it's listening to\n    // for easier unbinding later.\n    listenTo(obj : Messenger, name, callback? ) {\n        if (!obj) return this;\n        var id = obj.cid || (obj.cid = uniqueId());\n        var listeningTo = this._listeningTo || (this._listeningTo = {});\n        var listening = listeningTo[id];\n\n        // This object is not listening to any other events on `obj` yet.\n        // Setup the necessary references to track the listening callbacks.\n        if (!listening) {\n            var thisId = this.cid || (this.cid = uniqueId());\n            listening = listeningTo[id] = new ListeningTo( obj, id, thisId, listeningTo );\n        }\n\n        // Bind callbacks on obj, and keep track of them on listening.\n        internalOn(obj, name, callback, this, listening);\n        return this;\n    }\n\n    // Bind an event to only be triggered a single time. After the first time\n    // the callback is invoked, its listener will be removed. If multiple events\n    // are passed in using the space-separated syntax, the handler will fire\n    // once for each event, not once for a combination of all events.\n    once(name, callback, context) {\n        // Map the event into a `{event: once}` object.\n        var events = eventsApi(onceMap, {}, name, callback, this.off.bind( this ));\n        return this.on(events, void 0, context);\n    }\n\n    // Inversion-of-control versions of `once`.\n    listenToOnce(obj : Messenger, name, callback) {\n        // Map the event into a `{event: once}` object.\n        var events = eventsApi(onceMap, {}, name, callback, this.stopListening.bind( this, obj ) );\n        return this.listenTo(obj, events);\n    }\n\n    // Trigger one or many events, firing all bound callbacks. Callbacks are\n    // passed the same arguments as `trigger` is, apart from the event name\n    // (unless you're listening on `\"all\"`, which will cause your callback to\n    // receive the true name of the event as the first argument).\n    trigger(name : string, a?, b?, c? ) : this {\n        switch( arguments.length ){\n            // Forward call to monomorphic fast-path functions.\n            case 1 : trigger0( this, name ); break;\n            case 2 : trigger1( this, name, a ); break;\n            case 3 : trigger2( this, name, a, b ); break;\n            case 4 : trigger3( this, name, a, b, c ); break;\n            \n            // Trigger event with more than 3 arguments.\n            default :\n                // Passing arguments around killing performance. Convert it to array.\n                const allArgs = Array( arguments.length );\n                \n                for( let i = 0; i < allArgs.length; i++ ){\n                    allArgs[ i ] = arguments[ i ];\n                }\n\n                // Send events.\n                const { _events } = this;\n\n                if( _events ){\n                    _fireEventAll( _events[ name ], allArgs.splice( 0, 1 ) );\n                    _fireEventAll( _events.all, allArgs );\n                }                      \n        }\n\n        return this;\n    }\n\n    dispose() : void {\n        this.stopListening();\n        this.off();\n    }\n}\n\nconst slice = Array.prototype.slice;\n\nexport const Events = Messenger.prototype;\n\n// Guard the `listening` argument from the public API.\nvar internalOn = function(obj : Messenger, name, callback, context, listening? ) : Messenger {\n    obj._events = eventsApi(onApi, obj._events || {}, name,\n                            callback, new Handler( context, obj, listening));\n\n    if (listening) {\n        var listeners = obj._listeners || (obj._listeners = {});\n        listeners[listening.id] = listening;\n    }\n\n    return obj;\n};\n\ninterface Callback extends Function{\n    _callback? : any\n}\n\nclass Handler {\n    constructor( public context, public ctx, public listening : ListeningTo, public callback? : Callback ){\n    }\n\n    clone( callback ){\n        const { context, listening } = this;\n        if (listening) listening.count++;\n        return new Handler( context, context || this.ctx, listening, callback );\n    }\n}\n\ninterface EventsMap {\n    all? : Handler[]\n    [ name : string ] : Handler[]\n}\n\n// The reducing API that adds a callback to the `events` object.\nvar onApi = function(events : EventsMap, name : string, callback : Function, options) : EventsMap {\n    if (callback) {\n        var handlers = events[name],\n            toAdd = [ options.clone( callback ) ];\n            \n        events[name] = handlers ? handlers.concat( toAdd ) : toAdd;\n    }\n    \n    return events;\n};\n\nclass OffOptions {\n    constructor( public context, public listeners : Listeners ){}\n}\n\nfunction keys( o : any ) : string[]{\n    return o ? Object.keys( o ) : [];\n}\n\n// The reducing API that removes a callback from the `events` object.\nvar offApi = function(events : EventsMap, name, callback, options : OffOptions ) {\n    if (!events) return;\n\n    var i = 0, listening;\n    var context = options.context, listeners = options.listeners;\n\n    // Delete all events listeners and \"drop\" events.\n    if (!name && !callback && !context) {\n        var ids = keys(listeners);\n        for (; i < ids.length; i++) {\n            listening = listeners[ids[i]];\n            delete listeners[listening.id];\n            delete listening.listeningTo[listening.objId];\n        }\n        return;\n    }\n\n    var names = name ? [name] : keys(events);\n    for (; i < names.length; i++) {\n        name = names[i];\n        var handlers = events[name];\n\n        // Bail out if there are no events stored.\n        if (!handlers) break;\n\n        // Replace events if there are any remaining.  Otherwise, clean up.\n        var remaining = [];\n        for (var j = 0; j < handlers.length; j++) {\n            var handler = handlers[j];\n            if (\n                callback && callback !== handler.callback &&\n                callback !== handler.callback._callback ||\n                context && context !== handler.context\n            ) {\n                remaining.push(handler);\n            } else {\n                listening = handler.listening;\n                if (listening && --listening.count === 0) {\n                    delete listeners[listening.id];\n                    delete listening.listeningTo[listening.objId];\n                }\n            }\n        }\n\n        // Update tail event if the list has any events.  Otherwise, clean up.\n        if (remaining.length) {\n            events[name] = remaining;\n        } else {\n            delete events[name];\n        }\n    }\n    if (!isEmpty(events)) return events;\n};\n\n\ninterface Once extends Function {\n    _callback? : Function\n}\n\n// Reduces the event callbacks into a map of `{event: onceWrapper}`.\n// `offer` unbinds the `onceWrapper` after it has been called.\nvar onceMap = function(map, name, callback, offer) {\n    if (callback) {\n        var _once : Once = map[name] = once(function() {\n            offer(name, _once);\n            callback.apply(this, arguments);\n        });\n        _once._callback = callback;\n    }\n    return map;\n};\n\n// Specialized functions with events triggering loops.\n// JS JIT loves these small functions and code duplication.\nfunction _fireEvent0( events : Handler[] ) : void {\n    if( events )\n        for( let ev of events )\n            ev.callback.call( ev.ctx );\n}\n\nfunction _fireEvent1( events : Handler[], a ) : void {\n    if( events )\n        for( let ev of events )\n            ev.callback.call( ev.ctx, a );\n}\n\nfunction _fireEvent2( events : Handler[], a, b ) : void {\n    if( events )\n        for( let ev of events )\n            ev.callback.call( ev.ctx, a, b );\n}\n\nfunction _fireEvent3( events : Handler[], a, b, c ) : void {\n    if( events )\n        for( let ev of events )\n            ev.callback.call( ev.ctx, a, b, c );\n}\n\nfunction _fireEvent4( events : Handler[], a, b, c, d ) : void {\n    if( events )\n        for( let ev of events )\n            ev.callback.call( ev.ctx, a, b, c, d );\n}\n\nfunction _fireEventAll( events : Handler[], args : any[] ) : void {\n    if( events )\n        for( let ev of events )\n            ev.callback.apply( ev.ctx, args );\n}\n\n\n/** WEBPACK FOOTER **\n ** ./src/objectplus/events.ts\n **/","import { Messenger, trigger2, trigger3, assign, define, Constructor, ExtendableConstructor } from './objectplus/index.ts'\nimport { ValidationError, Validatable, ChildrenErrors } from './validation.ts'\nimport { Traversable, resolveReference } from './references.ts'\n/***\n * Abstract class implementing ownership tree, tho-phase transactions, and validation. \n * 1. createTransaction() - apply changes to an object tree, and if there are some events to send, transaction object is created.\n * 2. transaction.commit() - send and process all change events, and close transaction.\n */\n\nexport type TransactionalConstructor = ExtendableConstructor< Transactional >;\n\n// Transactional object interface\n@define({\n    _changeEventName : 'change'\n})\nexport abstract class Transactional extends Messenger implements Validatable, Traversable {\n    // Unique version token replaced on change\n    _changeToken : {} = {}\n\n    // true while inside of the transaction\n    _transaction : boolean = false;\n\n    // true, when in the middle of transaction and there're changes but is an unsent change event\n    _isDirty  : boolean = false;\n\n    // Backreference set by owner (Record, Collection, or other object)\n    _owner : Owner\n\n    // Key supplied by owner. Used by record to identify attribute key.\n    // Only collections doesn't set the key, which is used to distinguish collections.  \n    _ownerKey : string\n\n    // Name of the change event\n    _changeEventName : string\n\n    constructor( cid : string | number, owner? : Owner, ownerKey? : string ){\n        super( cid );\n        this._owner = owner;\n        this._ownerKey = ownerKey;\n    }\n\n    // Deeply clone ownership subtree, optionally setting the new owner\n    // (TODO: Do we really need it? Record must ignore events with empty keys)\n    // 'Pin store' shall assign this._defaultStore = this.getStore();\n    abstract clone( options? : { owner? : Owner, key? : string, pinStore? : boolean }) : this\n    \n    // Execute given function in the scope of ad-hoc transaction.\n    transaction( fun : ( self : this ) => void, options : TransactionOptions = {} ) : void{\n        const isRoot = begin( this );\n        fun.call( this, this );\n        isRoot && commit( this, options );\n    }\n\n    // Loop through the members in the scope of transaction.\n    // Transactional version of each()\n    updateEach( iteratee : ( val : any, key : string ) => void, options? : TransactionOptions ){\n        const isRoot = begin( this );\n        this.each( iteratee );\n        isRoot && commit( this, options );\n    }\n\n    // Apply bulk in-place object update in scope of ad-hoc transaction \n    set( values : any, options? : TransactionOptions ) : this {\n        if( values ){ \n            const transaction = this._createTransaction( values, options );\n            transaction && transaction.commit( options, true );\n        } \n\n        return this;\n    }\n\n    // Apply bulk object update without any notifications, and return open transaction.\n    // Used internally to implement two-phase commit.\n    // Returns null if there are no any changes.  \n    abstract _createTransaction( values : any, options? : TransactionOptions ) : Transaction\n    \n    // Parse function applied when 'parse' option is set for transaction.\n    parse( data : any ) : any { return data }\n\n    // Convert object to the serializable JSON structure\n    abstract toJSON() : {}\n\n    /*******************\n     * Traversals and member access\n     */\n    \n    // Get object member by its key.\n    abstract get( key : string ) : any\n\n    // Get object member by symbolic reference.\n    deepGet( reference : string ) : any {\n        return resolveReference( this, reference, ( object, key ) => object.get( key ) );\n    }\n\n    //_isCollection : boolean\n\n    // Return owner skipping collections.\n    getOwner() : Owner {\n        return this._owner;\n    }\n\n    // Store used when owner chain store lookup failed. Static value in the prototype. \n    _defaultStore : Transactional\n\n    // Locate the closest store. Store object stops traversal by overriding this method. \n    getStore() : Transactional {\n        const { _owner } = this;\n        return _owner ? <Transactional> _owner.getStore() : this._defaultStore;\n    }\n\n\n    /***************************************************\n     * Iteration API\n     */\n\n    // Loop through the members. Must be efficiently implemented in container class.\n    abstract each( iteratee : ( val : any, key : string | number ) => void, context? : any )\n\n    // Map members to an array\n    map<T>( iteratee : ( val : any, key : string ) => T, context? : any ) : T[]{\n        const arr : T[] = [],\n              fun = arguments.length === 2 ? ( v, k ) => iteratee.call( context, v, k ) : iteratee;\n        \n        this.each( ( val, key ) => {\n            const result = fun( val, key );\n            if( result !== void 0 ) arr.push( result );\n        } );\n\n        return arr;\n    }\n\n    // Map members to an object\n    mapObject<T>( iteratee : ( val : any, key : string | number ) => T, context? : any ) : { [ key : string ] : T }{\n        const obj : { [ key : string ] : T } = {},\n            fun = arguments.length === 2 ? ( v, k ) => iteratee.call( context, v, k ) : iteratee;\n        \n        this.each( ( val, key ) => {\n            const result = iteratee( val, key );\n            if( result !== void 0 ) obj[ key ] = result;\n        } );\n\n        return obj;\n    }\n\n    // Get array of attribute keys (Record) or record ids (Collection) \n    keys() : string[] {\n        return this.map( ( value, key ) => {\n            if( value !== void 0 ) return key;\n        });\n    }\n\n    // Get array of attribute values (Record) or records (Collection)\n    values() : any[] {\n        return this.map( value => value );\n    }\n    \n    /*********************************\n     * Validation API\n     */\n\n    // Lazily evaluated validation error\n    _validationError : ValidationError = void 0\n\n    // Validate ownership tree and return valudation error \n    get validationError() : ValidationError {\n        return this._validationError || ( this._validationError = new ValidationError( this ) );\n    }\n\n    // Validate nested members. Returns errors count.\n    abstract _validateNested( errors : ChildrenErrors ) : number\n\n    // Object-level validator. Returns validation error.\n    validate( obj? : Transactional ) : any {}\n\n    // Return validation error (or undefined) for nested object with the given key. \n    getValidationError( key : string ) : any {\n        var error = this.validationError;\n        return ( key ? error && error.nested[ key ] : error ) || null;\n    }\n\n    // Get validation error for the given symbolic reference.\n    deepValidationError( reference : string ) : any {\n        return resolveReference( this, reference, ( object, key ) => object.getValidationError( key ) );\n    }\n\n    // Iterate through all validation errors across the ownership tree.\n    eachValidationError( iteratee : ( error : any, key : string, object : Transactional ) => void ) : void {\n        const { validationError } = this;\n        validationError && validationError.eachError( iteratee, this );\n    }\n\n    // Check whenever member with a given key is valid. \n    isValid( key : string ) : boolean {\n        return !this.getValidationError( key );\n    }\n}\n\n// Owner must accept children update events. It's an only way children communicates with an owner.\nexport interface Owner extends Traversable {\n    _onChildrenChange( child : Transactional, options : TransactionOptions ) : void;\n    getOwner() : Owner\n    getStore() : Transactional\n}\n\n// Transaction object used for two-phase commit protocol.\n// Must be implemented by subclasses.\nexport interface Transaction {\n    // Object transaction is being made on.\n    object : Transactional\n\n    // Send out change events, process update triggers, and close transaction.\n    // Nested transactions must be marked with isNested flag (it suppress owner notification).\n    commit( options? : TransactionOptions, isNested? : boolean )\n}\n\n// Options for distributed transaction  \nexport interface TransactionOptions {\n    // Invoke parsing \n    parse? : boolean\n\n    // Suppress change notifications and update triggers\n    silent? : boolean\n\n    // Update existing transactional members in place, or skip the update (ignored by models)\n    merge? : boolean // =true\n\n    // Should collections remove elements in set (ignored by models)  \n    remove? : boolean // =true\n\n    // Always replace enclosed objects with new instances\n    reset? : boolean // = false\n\n    validate? : boolean\n}\n\n/**\n * Low-level transactions API. Must be used like this:\n * const isRoot = begin( record );\n * ...\n * isRoot && commit( record, options );\n * \n * When committing nested transaction, the flag must be set to true. \n * commit( object, options, isNested ) \n */\n\n// Start transaction. Return true if it's the root one.\nexport function begin( object : Transactional ) : boolean {\n    return object._transaction ? false : ( object._transaction = true );  \n}\n\n// Mark transactional object as dirty, so change event will be sent on commit.\nexport function markAsDirty( object : Transactional ){\n    object._isDirty  = true;\n    object._changeToken = {};\n    object._validationError = void 0;\n}\n\n// Commit transaction. Send out change event and notify owner. Returns true if there were changes.\n// Should be executed for the root transaction only.\nexport function commit( object : Transactional, options : TransactionOptions, isNested? : boolean ){\n    const wasDirty = object._isDirty;\n\n    if( options.silent ){\n        object._isDirty  = false;\n    }\n    else{\n        while( object._isDirty ){\n            object._isDirty = false; \n            trigger2( object, object._changeEventName, object, options );\n        }\n    }\n    \n    object._transaction = false;\n\n    // Don't notify owner for the case of nested transaction, it already knows if there were changes  \n    if( !isNested && wasDirty && object._owner ){\n        object._owner._onChildrenChange( object, options );\n    }\n}\n\n/************************************\n * Ownership management\n */\n\n// Add reference to the record.\nexport function aquire( owner : Owner, child : Transactional, key? : string ) : void {\n    if( !child._owner ){\n        child._owner = owner;\n        child._ownerKey = key;\n    }\n}\n\n// Remove reference to the record.\nexport function free( owner : Owner, child : Transactional ) : void {\n    if( owner === child._owner ){\n        child._owner = void 0;\n        child._ownerKey = void 0;\n    }\n}\n\n\n/** WEBPACK FOOTER **\n ** ./src/transactions.ts\n **/","export interface ChildrenErrors {\n    [ key : string ] : ValidationError | any\n} \n\nexport interface Validatable {\n    _validateNested( errors : ChildrenErrors ) : number;\n    validate( self : any ) : any\n    get( key : string ) : any\n}\n\n// Validation error object.\nexport class ValidationError {\n    // Invalid nested object keys \n    nested : ChildrenErrors \n    length : number\n\n    // Local error\n    error : any\n\n    constructor( obj : Validatable ){\n        this.length = obj._validateNested( this.nested = {} );\n\n        if( this.error = obj.validate( obj ) ){\n            this.length++;\n        }\n    }\n\n    each( iteratee : ( value : any, key : string ) => void ){\n        const { error, nested } = this;\n\n        if( error ) iteratee( error, null );\n\n        for( const key in nested ){\n            iteratee( nested[ key ], key );\n        }\n    }\n\n    eachError( iteratee : ( error : any, key : string, object : Validatable ) => void, object : Validatable ){\n        this.each( ( value, key ) => {\n            if( value instanceof ValidationError ){\n                value._traverse( iteratee, object.get( key ) );\n            }\n            else{\n                iteratee( value, key, object );\n            }\n        });\n    }\n}\n\n\n/** WEBPACK FOOTER **\n ** ./src/validation.ts\n **/","/**\n * Some sketches for reference resolution.\n *\n * \n * a : Model.from( '~collection' )\n * \n * We need two functions. One for get, and one for compile. \n */\nexport interface Traversable {\n    getStore() : Traversable\n    getOwner() : Traversable\n    get( key : string ) : any \n}\n\nconst referenceMask =  /\\~|\\^|([^.]+)/g;\n\n// Compile reference to function\n\nexport class CompiledReference {\n    resolve : ( root : Traversable ) => any\n    tail : string\n    local : boolean\n\n    constructor( reference : string, splitTail : boolean = false ){\n        const path = reference\n                        .match( referenceMask )\n                        .map( key => key === '~' ? 'getStore()' : ( key === '^' ? 'getOwner()' : key ) );\n               \n        this.tail = splitTail && path.pop();\n        this.local = !path.length;\n\n        path.unshift( 'self' );\n        \n        this.resolve = <any> new Function( 'self', `return ${ path };` );\n    }\n}\n\nexport function resolveReference( root : Traversable, reference : string, action : ( object, key : string ) => any ) : any {\n    const path = reference.match( referenceMask ),\n          skip = path.length - 1;\n    \n    let self = root;\n\n    for( var i = 0; i < skip; i++ ){\n        const key = path[ i ];\n        switch( key ){\n            case '~' : self = self.getStore(); break;\n            case '^' : self = self.getOwner(); break;\n            default  : self = self.get( key );\n        }\n\n        // Do nothing if object on the path doesn't exist.\n        if( !self ) return;\n    }\n\n    action( self, path[ skip ] );\n    return self;\n}\n\n// Construct object reference { a : { b : { c : 0 } } }\nexport function referenceToObject( reference, value ){\n    const path = reference.split( '.' ),\n          root = {},\n          last = path.length - 1;\n    let current = root;\n\n    for( let i = 0; i < last; i++ ){\n        current = current[ path[ i ] ] = {};\n    }\n\n    current[ path[ last ] ] = value;\n\n    return root;\n}\n\n\n/** WEBPACK FOOTER **\n ** ./src/references.ts\n **/","import { GenericAttribute } from './attribute.ts';\nimport { Attribute, AttributesValues, AttributeDescriptorMap, CloneAttributesCtor } from './transaction.ts'\nimport { defaults, isValidJSON, transform, log, EventHandlers } from '../objectplus/index.ts'\nimport { toAttributeDescriptor } from './typespec.ts'\n\nimport { CompiledReference } from '../references.ts'\n\nexport interface DynamicMixin {\n    _attributes : AttributesSpec\n    Attributes : CloneAttributesCtor\n    properties : PropertyDescriptorMap\n    forEachAttr? : ForEach\n    defaults : Defaults\n    _toJSON : ToJSON\n    _parse : Parse\n    _listenToSelf : EventHandlers\n}\n\n// Refine AttributesSpec definition.\nexport interface AttributesSpec {\n    [ key : string ] : GenericAttribute\n}\n\ntype ForEach   = ( obj : {}, iteratee : ( val : any, key? : string, spec? : Attribute ) => void ) => void;\ntype Defaults  = ( attrs? : {} ) => {}\ntype Parse     = ( data : any ) => any;\ntype ToJSON    = () => any;\n\n// Compile attributes spec\nexport function compile( rawSpecs : AttributeDescriptorMap, baseAttributes : AttributesSpec ) : DynamicMixin {\n    const myAttributes = transform( <AttributesSpec>{}, rawSpecs, createAttribute ),\n          allAttributes = defaults( <AttributesSpec>{}, myAttributes, baseAttributes ),\n          Attributes = createCloneCtor( allAttributes ),\n          mixin : DynamicMixin = {\n            Attributes : Attributes,\n            _attributes : new Attributes( allAttributes ),\n            properties : transform( <PropertyDescriptorMap>{}, myAttributes, x => x.createPropertyDescriptor() ),\n            defaults : createDefaults( allAttributes ),\n            _toJSON : createToJSON( allAttributes ), // <- TODO: profile and check if there is any real benefit. I doubt it. \n            _parse : createParse( myAttributes, allAttributes ),\n            _listenToSelf : createEventMap( allAttributes )\n         };\n\n    // Enable optimized forEach if warnings are disabled.\n    if( !log.level ){\n        mixin.forEachAttr = createForEach( allAttributes );\n    }\n\n    return mixin;\n}\n\n// Create attribute from the type spec.\nfunction createAttribute( spec, name ){\n    return GenericAttribute.create( toAttributeDescriptor( spec ), name );\n}\n\n// Build events map for attribute change events.\nfunction createEventMap( attrSpecs : AttributesSpec ) : EventHandlers {\n    var events : EventHandlers = null;\n\n    for( var key in attrSpecs ){\n        const attribute = attrSpecs[ key ],\n            { _onChange } = attribute.options; \n\n        if( _onChange ){\n            events || ( events = {} );\n\n            events[ 'change:' + key ] =\n                typeof _onChange === 'string' ?\n                    createWatcherFromRef( _onChange, key ) : \n                    wrapWatcher( _onChange, key );\n        }\n    }\n\n    return events;\n}\n\nfunction wrapWatcher( watcher, key ){\n    return function( record, value ){\n        watcher.call( record, value, key );\n    } \n}\n\nfunction createWatcherFromRef( ref : string, key : string ){\n    const { local, resolve, tail } = new CompiledReference( ref, true );\n    return local ?\n        function( record, value ){\n            record[ tail ]( value, key );\n        } :\n        function( record, value ){\n            resolve( record )[ tail ]( value, key );\n        }\n}\n\nexport function createForEach( attrSpecs : AttributesSpec ) : ForEach {\n    let statements = [ 'var v, _a=this._attributes;' ];\n\n    for( let name in attrSpecs ){\n        statements.push( `( v = a.${name} ) === void 0 || f( v, \"${name}\", _a.${name} );` );\n    }\n\n    return <ForEach> new Function( 'a', 'f', statements.join( '' ) );\n}\n\nexport function createCloneCtor( attrSpecs : AttributesSpec ) : CloneAttributesCtor {\n    var statements = [];\n\n    for( let name in attrSpecs ){\n        statements.push( `this.${name} = x.${name};` );\n    }\n\n    var CloneCtor = new Function( \"x\", statements.join( '' ) );\n    CloneCtor.prototype = Object.prototype;\n    return <CloneAttributesCtor> CloneCtor;\n}\n\n// Create optimized model.defaults( attrs, options ) function\nfunction createDefaults( attrSpecs : AttributesSpec ) : Defaults {\n    let assign_f = ['var v;'], create_f = [];\n\n    function appendExpr( name, expr ){\n        assign_f.push( `this.${name} = ( v = a.${name} ) === void 0 ? ${expr} : v;` );\n        create_f.push( `this.${name} = ${expr};` );\n    }\n\n    // Compile optimized constructor function for efficient deep copy of JSON literals in defaults.\n    for( let name in attrSpecs ){\n        const attrSpec = attrSpecs[ name ],\n              { value, type } = attrSpec;\n\n        if( value === void 0 && type ){\n            // if type with no value is given, create an empty object\n            appendExpr( name, `i.${name}.create()` );//TODO: consider adding owner reference\n        }\n        else{\n            // If value is given, type casting logic will do the job later, converting value to the proper type.\n            if( isValidJSON( value ) ){\n                // JSON literals must be deep copied.\n                appendExpr( name, JSON.stringify( value ) );\n            }\n            else if( value === void 0 ){\n                // handle undefined value separately. Usual case for model ids.\n                appendExpr( name, 'void 0' );\n            }\n            else{\n                // otherwise, copy value by reference.\n                appendExpr( name, `i.${name}.value` );\n            }\n        }\n    }\n\n    const CreateDefaults : any = new Function( 'i', create_f.join( '' ) ),\n          AssignDefaults : any = new Function( 'a', 'i', assign_f.join( '' ) );\n\n    CreateDefaults.prototype = AssignDefaults.prototype = Object.prototype;\n\n    // Create model.defaults( attrs, options ) function\n    // 'attrs' will override default values, options will be passed to nested backbone types\n    return function( attrs? : {} ){ //TODO: Consider removing of the CreateDefaults. Currently is not used. May be used in Record costructor, though.\n        return attrs ? new AssignDefaults( attrs, this._attributes ) : new CreateDefaults( this._attributes );\n    }\n}\n\nfunction createParse( allAttrSpecs : AttributesSpec, attrSpecs : AttributesSpec ) : Parse {\n    var statements = [ 'var a=this._attributes;' ],\n        create     = false;\n\n    for( let name in allAttrSpecs ){\n        const local = attrSpecs[ name ];\n\n        // Is there any 'parse' option in local model definition?\n        if( local && local.parse ) create = true;\n\n        // Add statement for each attribute with 'parse' option.\n        if( allAttrSpecs[ name ].parse ){\n            const s = `r.${name} === void 0 ||( r.${name} = a.${name}.parse.call( this, r.${name}, \"${name}\") );`;\n            statements.push( s );\n        }\n    }\n\n    if( create ){\n        statements.push( 'return r;' );\n        return <any> new Function( 'r', statements.join( '' ) );\n    }\n }\n\nfunction createToJSON( attrSpecs : AttributesSpec ) : ToJSON {\n    let statements = [ `var json = {},v=this.attributes,a=this._attributes;` ];\n\n    for( let key in attrSpecs ){\n        const toJSON = attrSpecs[ key ].toJSON;\n\n        if( toJSON ){\n            statements.push( `json.${key} = a.${key}.toJSON.call( this, v.${ key }, '${key}' );` );\n        }\n    }\n\n    statements.push( `return json;` );\n\n    return <any> new Function( statements.join( '' ) );\n}\n\n\n\n/** WEBPACK FOOTER **\n ** ./src/record/define.ts\n **/","import { setAttribute, Record, Attribute, Transform, ChangeHandler, AttributeDescriptor } from './transaction.ts'\nimport { notEqual, assign, Constructor } from '../objectplus/index.ts'\n\nimport { Owner, Transactional, TransactionOptions } from '../transactions.ts'\n\ntype GetHook = ( value : any, key : string ) => any;\nexport type ChangeAttrHandler = ( ( value : any, attr : string ) => void ) | string;\n\ndeclare global {\n    interface Function {\n        _attribute : typeof GenericAttribute\n    }\n}\n\n// TODO: interface differs from options, do something obout it\nexport class GenericAttribute implements Attribute {\n    // Factory method to create attribute from options \n    static create( options : AttributeDescriptor, name : string ) : GenericAttribute {\n        const type = options.type,\n              AttributeCtor = type ? type._attribute : GenericAttribute;\n\n        return new AttributeCtor( name, options );\n    }\n    /**\n     * Update pipeline functions\n     * =========================\n     *\n     * Stage 0. canBeUpdated( value )\n     * - presence of this function implies attribute's ability to update in place.\n     */\n     canBeUpdated( prev, next ) : boolean {\n         return false;\n     }\n\n    /**\n     * Stage 1. Transform stage\n     */\n    transform( value, options, prev, model ) { return value; }\n\n    // convert attribute type to `this.type`\n    convert( value, options, model ) { return value; }\n\n    /**\n     * Stage 2. Check if attr value is changed\n     */\n    isChanged( a, b ) {\n        return notEqual( a, b );\n    }\n\n    /**\n     * Stage 3. Handle attribute change\n     */\n    handleChange( next, prev, model ) {}\n\n    /**\n     * End update pipeline definitions.\n     */\n\n    // create empty object passing backbone options to constructor...\n    create() { return new ( <any>this.type )(); }\n\n    // generic clone function for typeless attributes\n    // Must be overriden in sublass\n    clone( value, options : { deep? : boolean } = {} ) {\n        if( value && typeof value === 'object' ) {\n            // delegate to object's clone(), if it exist...\n            if( value.clone ) {\n                return value.clone( options );\n            }\n\n            if( options.deep ){\n                const proto = Object.getPrototypeOf( value );\n\n                // attempt to deep copy raw objects, assuming they are JSON\n                if( proto === Object.prototype || proto === Array.prototype ){\n                    return JSON.parse( JSON.stringify( value ) );\n                }\n            }\n        }\n\n        return value;\n    }\n\n    validate( record : Record, value : any, key : string ){}\n\n    toJSON( value, key ) {\n        return value && value.toJSON ? value.toJSON() : value;\n    }\n\n    createPropertyDescriptor() : PropertyDescriptor | void {\n        const { name, getHook } = this;\n\n        if( name !== 'id' ){\n            return {\n                // call to optimized set function for single argument.\n                set( value ){\n                    setAttribute( <any>this, name, value );\n                },\n\n                // attach get hook to the getter function, if present\n                get : getHook ?\n                      function() {\n                          return getHook.call( this, this.attributes[ name ], name );\n                      } :\n                      function() {\n                          return this.attributes[ name ];\n                      }\n            }\n        }\n    }\n\n    value : any\n    type : Constructor< any >\n\n    parse : ( value, key : string ) => any\n\n    initialize( name : string, options ){}\n\n    constructor( public name : string, public options : AttributeDescriptor ) {\n        const {\n                  value, type, parse, toJSON,\n                  getHooks = [],\n                  transforms = [],\n                  changeHandlers = []\n              } = options;\n\n        this.value = value;\n        this.type  = type;\n\n        this.parse  = parse;\n        this.toJSON = toJSON === void 0 ? this.toJSON : toJSON;\n\n        /**\n         * Assemble pipelines...\n         */\n\n        // `convert` is default transform, which is always present...\n        transforms.unshift( this.convert );\n\n        // Get hook from the attribute will be used first...\n        if( this.get ) getHooks.unshift( this.get );\n\n        // let subclasses configure the pipeline...\n        this.initialize.apply( this, arguments );\n\n        // let attribute spec configure the pipeline...\n        if( getHooks.length ){\n            this.getHook = getHooks.reduce( chainGetHooks );\n        }\n        \n        if( transforms.length ){\n            this.transform = transforms.reduce( chainTransforms );\n        }\n        \n        if( changeHandlers.length ){\n            this.handleChange = changeHandlers.reduce( chainChangeHandlers );\n        }\n    }\n\n    getHook : ( value, key : string ) => any = null\n    get : ( value, key : string ) => any\n}\n\nRecord.prototype._attributes = { id : GenericAttribute.create({ value : void 0 }, 'id' )};\n\nfunction chainChangeHandlers( prevHandler : ChangeHandler, nextHandler : ChangeHandler ) : ChangeHandler {\n    return function( next, prev, model ) {\n        prevHandler.call( this, next, prev, model );\n        nextHandler.call( this, next, prev, model );\n    }\n}\n\nfunction chainGetHooks( prevHook : GetHook, nextHook : GetHook ) : GetHook {\n    return function( value, name ) {\n        return nextHook.call( prevHook.call( value, name ), name );\n    }\n}\n\nfunction chainTransforms( prevTransform : Transform, nextTransform : Transform ) : Transform {\n    return function( value, options, prev, model ) {\n        return nextTransform.call( this, prevTransform.call( this, value, options, prev, model ), options, prev, model );\n    }\n}\n\n\n/** WEBPACK FOOTER **\n ** ./src/record/attribute.ts\n **/","/**\n * Type spec engine. Declare attributes using chainable syntax,\n * and returns object with spec.\n */\n\nimport { ChangeAttrHandler } from './attribute.ts'\nimport { AttributeDescriptor, Record } from './transaction.ts'\nimport { assign, EventHandlers, Constructor } from '../objectplus/index.ts'\n\nexport class ChainableAttributeSpec {\n    options : AttributeDescriptor;\n\n    constructor( options : AttributeDescriptor = {} ) {\n        this.options = { getHooks : [], transforms : [], changeHandlers : []};\n        assign( this.options, options );\n    }\n\n    triggerWhenChanged( events ) : this {\n        // TODO: not clear\n        return this;\n    }\n\n    watcher( ref : string | ( ( value : any, key : string ) => void ) ) : this {\n        this.options._onChange = ref;\n        return this;\n    }\n\n    parse( fun ) : this {\n        this.options.parse = fun;\n        return this;\n    }\n\n    toJSON( fun ) : this{\n        this.options.toJSON = fun;\n        return this;\n    }\n\n    // Attribute get hook.\n    get( fun ) : this {\n        this.options.getHooks.push( fun );\n\n        return this;\n    }\n\n    // Attribute set hook.\n    set( fun ) : this {\n        this.options.transforms.push( function( next, options, prev, model ) {\n            if( this.isChanged( next, prev ) ) {\n                var changed = fun.call( model, next, name );\n                return changed === void 0 ? prev : changed;\n            }\n\n            return prev;\n        } );\n\n        return this;\n    }\n\n    // Subsribe to events from an attribute.\n    events( map : EventHandlers ) : this {\n        this.options.changeHandlers.push( function( next, prev, record : Record ){\n                prev && record.stopListening( prev );\n\n                next && record.listenTo( next, map );\n            });\n\n        return this;\n    }\n\n    get has() : this { return this; }\n\n    /*\n    get isRequired() {\n        this.options.isRequired = true;\n        return this;\n    }*/\n\n    value( x ) : this {\n        this.options.value = x;\n        return this;\n    }\n}\n\ndeclare global {\n    interface Function{\n        value : ( x : any ) => ChainableAttributeSpec;\n        isRequired : ChainableAttributeSpec;\n        has : ChainableAttributeSpec;\n    }\n}\n\nFunction.prototype.value = function( x ) {\n    return new ChainableAttributeSpec( { type : this, value : x } );\n};\n\n/*\nObject.defineProperty( Function.prototype, 'isRequired', {\n    get() {\n        return new ChainableAttributeSpec( { type : this, isRequired : true } );\n    } \n});*/\n\nObject.defineProperty( Function.prototype, 'has', {\n    get() {\n        // workaround for sinon.js and other libraries overriding 'has'\n        return this._has || new ChainableAttributeSpec( { type : this } );\n    },\n\n    set( value ) { this._has = value; }\n} );\n\nexport function toAttributeDescriptor( spec : any ) : AttributeDescriptor {\n    if( typeof spec === 'function' ) {\n        return { type : <any> spec };\n    }\n\n    if( spec && spec instanceof ChainableAttributeSpec ) {\n        return spec.options;\n    }\n \n    return {\n        type : inferType( spec ),\n        value : spec\n    }\n}\n\nfunction inferType( value : {} ) : Constructor<any> {\n    switch( typeof value ) {\n        case 'number' :\n            return Number;\n        case 'string' :\n            return String;\n        case 'boolean' :\n            return Boolean;\n        case 'undefined' :\n            return void 0;\n        case 'object' :\n            return value ? <any> value.constructor : Object;\n    }\n}\n\n\n\n/** WEBPACK FOOTER **\n ** ./src/record/typespec.ts\n **/","import { Record } from './transaction.ts' \nimport { GenericAttribute } from './attribute.ts'\nimport { Owner, Transactional, TransactionOptions, TransactionalConstructor } from '../transactions.ts' \n\nexport class TransactionalType extends GenericAttribute {\n    type : TransactionalConstructor\n\n    canBeUpdated( prev : Transactional, next : any ) : boolean {\n        // If an object already exists, and new value is of incompatible type, let object handle the update.\n        return prev && next && !( next instanceof this.type );\n    }\n\n    convert( value : any, options : TransactionOptions, record : Record ) : Transactional {\n        // Invoke class factory to handle abstract classes\n        return value == null || value instanceof this.type ? value : this.type.create( value, options, record );\n    }\n\n    create() : Transactional {\n        return new (<any>this.type)(); // this the subclass of Transactional here.\n    }\n\n    handleChange( next : Transactional, prev : Transactional, record : Record ){\n        // Remove reference to self\n        if( prev && prev._owner === record ){\n            prev._ownerKey = prev._owner = null;\n        } \n\n        // Take ownership if possible\n        if( next && !next._owner ){\n            next._owner = record;\n            next._ownerKey = this.name;\n        }\n    }\n}\n\nRecord._attribute = TransactionalType;\n\n\n/** WEBPACK FOOTER **\n ** ./src/record/nestedTypes.ts\n **/","import { GenericAttribute } from './attribute.ts'\nimport { parseDate } from '../objectplus/index.ts'\n\n// Default attribute type for all constructor functions...\nclass ConstructorType extends GenericAttribute {\n    type : new ( value : any ) => {}\n\n    convert( value ) {\n        return value == null || value instanceof this.type ? value : new this.type( value );\n    }\n\n    clone( value, options ) {\n        // delegate to clone function or deep clone through serialization\n        return value.clone ? value.clone( value, options ) : this.convert( JSON.parse( JSON.stringify( value ) ) );\n    }\n}\n\nFunction.prototype._attribute = ConstructorType;\n\n// Date Attribute\nclass DateType extends GenericAttribute {\n    convert( value ) {\n        return value == null || value instanceof Date ? value :\n               new Date( typeof value === 'string' ? parseDate( value ) : value );\n    }\n\n    validate( model, value, name ) {\n        if( isNaN( +value ) ) return name + ' is Invalid Date';\n    }\n\n    toJSON( value ) { return value && value.toJSON(); }\n\n    isChanged( a, b ) { return ( a && +a ) !== ( b && +b ); }\n\n    clone( value ) { return value && new Date( +value ); }\n}\n\nDate._attribute = DateType;\n\n// Primitive Types.\nexport class PrimitiveType extends GenericAttribute {\n    type : NumberConstructor | StringConstructor | BooleanConstructor\n\n    create() { return this.type(); }\n\n    toJSON( value ) { return value; }\n\n    convert( value ) { return value == null ? value : this.type( value ); }\n\n    isChanged( a, b ) { return a !== b; }\n\n    clone( value ) { return value; }\n}\n\nBoolean._attribute = String._attribute = PrimitiveType;\n\n// Number type with special validation algothim. \nexport class NumericType extends PrimitiveType {\n    type : NumberConstructor\n\n    validate( model, value, name ) {\n        // Whatever is not symmetrically serializable to JSON, is not valid by default.\n        if( !isFinite( value ) ) {\n            return name + ' is not valid number';\n        }\n    }\n}\n\nNumber._attribute = NumericType;\n\n// Add global Integer data type\ndeclare global {\n    interface Window {\n        Integer : Function\n    }\n}\n\nif( window ){\n    window.Integer = function( x ){ return x ? Math.round( x ) : 0; }\n    window.Integer._attribute = NumericType;\n}\n\n// Compatibility wrapper for Array type.\nexport class ArrayType extends GenericAttribute {\n    toJSON( value ) { return value; }\n\n    convert( value ) {\n        // Fix incompatible constructor behaviour of Array...\n        if( value == null || Array.isArray( value ) ) return value;\n\n        // todo: log an error.\n        return [];\n    }\n}\n\nArray._attribute = ArrayType;\n\n\n/** WEBPACK FOOTER **\n ** ./src/record/basicTypes.ts\n **/","import { Record, RecordDefinition, AttributeDescriptorMap } from './record/transaction.ts'\nimport { assign, defaults, omit, Class, ClassDefinition, getBaseClass } from './objectplus/index.ts'\nimport { compile, AttributesSpec } from './record/define.ts'\nimport { ChainableAttributeSpec } from './record/typespec.ts'\n\nimport { TransactionalType } from './record/nestedTypes.ts'\nimport './record/basicTypes.ts'\n\nimport { Collection } from './collection/index.ts'\n\nRecord.define = function( protoProps : RecordDefinition, staticProps ){\n    const BaseConstructor : typeof Record = getBaseClass( this ),\n          baseProto : Record = BaseConstructor.prototype;\n\n    if( protoProps ) {\n        // Compile attributes spec, creating definition mixin.\n        const definition = compile( getAttributes( protoProps ), <AttributesSpec> baseProto._attributes );\n\n        // Explicit 'properties' declaration overrides auto-generated attribute properties.\n        if( protoProps.properties === false ){\n            definition.properties = {};\n        }\n\n        assign( definition.properties, protoProps.properties || {} );\n\n        // Merge in definition.\n        defaults( definition, omit( protoProps, 'attributes', 'collection' ) );            \n        Class.define.call( this, definition, staticProps );\n        defineCollection.call( this, protoProps && protoProps.collection );\n    }\n\n    return this;\n}\n\nRecord.predefine = function(){\n    Class.predefine.call( this );\n\n    this.Collection = getBaseClass( this ).Collection.extend();\n    this.Collection.prototype.model = this;\n\n    return this;\n}\n\nCollection._attribute = Record._attribute = TransactionalType;\nRecord.Collection = <any>Collection;\n\nfunction getAttributes({ defaults, attributes } : RecordDefinition ) : AttributeDescriptorMap {\n    return typeof defaults === 'function' ? (<any>defaults)() : attributes || defaults;\n}\n\nexport { Record, ChainableAttributeSpec }\n\nfunction defineCollection( collection : {} ){\n    const BaseCollection : typeof Collection = getBaseClass( this ).Collection;\n\n    let CollectionConstructor : typeof Collection;\n\n    // If collection constructor is specified, just take it. \n    if( typeof collection === 'function' ) {\n        CollectionConstructor = <typeof Collection> collection;\n    } \n    // Same when Collection is specified as static class member.  \n    else if( this.Collection !== BaseCollection ){\n        CollectionConstructor = this.Collection;\n        if( collection ) (<any>CollectionConstructor).mixins( collection );\n    } \n    // Otherwise we need to create new Collection type...\n    else{\n        // ...which must extend Collection of our base Record.\n        CollectionConstructor = <any> BaseCollection.extend( collection );\n    }\n\n    // Link collection with the record\n    CollectionConstructor.prototype.model = this;\n    this.Collection = CollectionConstructor;\n}\n\n\n/** WEBPACK FOOTER **\n ** ./src/model.ts\n **/","import { define, Class, ClassDefinition, defaults, trigger2 } from '../objectplus/index.ts'\nimport { begin, commit, markAsDirty, Transactional, Transaction, TransactionOptions, Owner } from '../transactions.ts'\nimport { Record } from '../record/index.ts'\n\nimport { IdIndex, dispose, Elements, CollectionCore, addIndex, removeIndex, Comparator, CollectionTransaction } from './commons.ts'\nimport { addTransaction } from './add.ts'\nimport { setTransaction, emptySetTransaction } from './set.ts'\nimport { removeOne, removeMany } from './remove.ts'\n\nlet _count = 0;\n\nconst silentOptions = { silent : true };\n\n@define({\n    // Default client id prefix \n    cidPrefix : 'c'\n})\nexport class Collection extends Transactional implements CollectionCore {\n    static predefine() : typeof Collection { return this; }\n    /***********************************\n     * Core Members\n     */\n    // Array of the records\n    models : Record[]\n\n    // Index by id and cid\n    _byId : IdIndex\n\n    set comparator( x : any ){\n        let compare;\n\n        switch( typeof x ){\n            case 'string' :\n                this._comparator = ( a, b ) => {\n                    const aa = a[ x ], bb = b[ x ];\n                    if( aa === bb ) return 0;\n                    return aa < bb ? -1 : + 1;\n                } \n                break;\n            case 'function' :\n                if( x.length === 1 ){\n                    this._comparator = ( a, b ) => {\n                        const aa = x( a ), bb = x( b );\n                        if( aa === bb ) return 0;\n                        return aa < bb ? -1 : + 1;\n                    }\n                }\n                else{\n                    this._comparator = x;\n                }\n        }\n\n        // TBD: sort?\n    }\n    get comparator(){ return this._comparator; }\n    _comparator : ( a : Record, b : Record ) => number\n\n    _onChildrenChange( record : Record, options? ){\n        const isRoot = begin( this ),\n              { idAttribute } = this;\n\n        if( record.hasChanged( idAttribute ) ){\n            const { _byId } = this;\n            removeIndex( _byId, record.previous( idAttribute ) );\n            addIndex( _byId, record[ idAttribute ] );\n        }\n\n        markAsDirty( this );\n\n        options.silent || trigger2( this, 'change', record, options );\n\n        isRoot && commit( this, options );\n    }\n\n    get( objOrId : string | Record | Object ) : Record {\n        return objOrId ? (\n            this._byId[ typeof objOrId === 'object' ? ( <Record> objOrId ).cid || objOrId[ this.idAttribute ] : objOrId ]\n        ) : null;\n    }\n\n    each( iteratee : ( val : Record, key : number ) => void, context? : any ){\n        const fun = arguments.length === 2 ? ( v, k ) => iteratee.call( context, v, k ) : iteratee,\n            { models } = this;\n\n        for( let i = 0; i < models.length; i++ ){\n            fun( models[ i ], i ); \n        }\n    }\n\n    _validateNested( errors : {} ) : number {\n        let count = 0;\n\n        this.each( record => {\n            const error = record.validationError;\n            if( error ){\n                errors[ record.cid ] = error;\n                count++;\n            }\n        });\n\n        return count;\n    }\n\n    model : typeof Record\n\n    // idAttribute extracted from the model type.\n    idAttribute : string\n\n    constructor( records? : ( Record | {} )[], options : TransactionOptions = {} ){\n        super( _count++ );\n        this.models = [];\n        this._byId = {};\n        this.idAttribute = this.model.prototype.idAttribute;\n\n        if( records ){\n            const elements : Elements = options.parse ? this.parse( records ) : records;\n            emptySetTransaction( this, records, options ).commit( silentOptions );\n        }\n\n        this.initialize.apply( this, arguments );\n    }\n\n    initialize(){}\n\n    get length() : number { return this.models.length; }\n    first() : Record { return this.models[ 0 ]; }\n\n    // Deeply clone collection, optionally setting new owner.\n    clone( owner? : any ) : this {\n        return new (<any>this.constructor)( this.models, { clone : true }, owner );\n    }\n\n    toJSON() : Object[] {\n        return this.models.map( model => model.toJSON() );\n    }\n\n    // Apply bulk in-place object update in scope of ad-hoc transaction \n    set( elements : ( {} | Record )[], options : TransactionOptions = {} ) : this {\n        // Handle reset option here - no way it will be populated from the top as nested transaction. \n        if( options.reset ){\n            this.reset( elements, options )\n        }\n        else{\n            const transaction = this._createTransaction( elements, options );\n            transaction && transaction.commit( options );\n        } \n\n        return this;    \n    }\n\n    reset( a_elements : ( {} | Record )[], options : TransactionOptions = {} ) : Record[] {\n        const previousModels = dispose( this );\n\n        // Make all changes required, but be silent.\n        if( a_elements ){\n            const elements : Elements = options.parse ? this.parse( a_elements ) : a_elements;\n            emptySetTransaction( this, elements, options ).commit( silentOptions );\n        }\n\n        options.silent || trigger2( this, 'reset', this, defaults( { previousModels : previousModels }, options ) );\n\n        return this.models;\n    }\n\n    // Add elements to collection.\n    add( something : Elements | {} | Record , options : TransactionOptions = {} ){\n        const parsed : Elements = options.parse ? this.parse( something ) : something,\n              elements : Elements = Array.isArray( parsed ) ? parsed : [ parsed ],\n              transaction = this.models.length ?\n                    addTransaction( this, elements, options ) :\n                    emptySetTransaction( this, elements, options );\n\n        if( transaction ){\n            transaction.commit( options );\n            return transaction.added;\n        }\n\n        return []; \n    }\n\n    // Remove elements. \n    remove( recordsOrIds : any, options : TransactionOptions = {} ) : Record[] | Record {\n        if( recordsOrIds ){\n            return Array.isArray( recordsOrIds ) ?\n                        removeMany( this, recordsOrIds, options ) :\n                        removeOne( this, recordsOrIds, options );\n        }\n\n        return [];\n    }\n\n    // Apply bulk object update without any notifications, and return open transaction.\n    // Used internally to implement two-phase commit.   \n    _createTransaction( a_elements : Elements, options : TransactionOptions = {} ) : CollectionTransaction {\n        const elements = options.parse ? this.parse( a_elements ) : a_elements;\n\n        if( this.models.length ){\n            return options.remove === false ?\n                        addTransaction( this, elements, options ) :\n                        setTransaction( this, elements, options );\n        }\n        else{\n            return emptySetTransaction( this, elements, options );\n        }\n    }\n}\n\nCollection.prototype.model = Record;\n\n\n/** WEBPACK FOOTER **\n ** ./src/collection/index.ts\n **/","import { Record } from '../record/index.ts'\nimport { Owner, aquire, free, Transaction, markAsDirty,\n        TransactionOptions, Transactional, commit } from '../transactions.ts'\n\nimport { trigger2, trigger3 } from '../objectplus/index.ts'        \n\nexport interface CollectionCore extends Transactional, Owner {\n    _byId : IdIndex\n    models : Record[]\n    model : typeof Record\n    _comparator : Comparator\n    get( objOrId : string | Record | Object ) : Record    \n}\n\n// Collection's manipulation methods elements\nexport type Elements = ( Object | Record )[];\n\nexport interface CollectionOptions extends TransactionOptions {\n    sort? : boolean\n}\n\nexport type Comparator = ( a : Record, b : Record ) => number;  \n\nexport function dispose( collection : CollectionCore ) : Record[]{\n    const models = collection.models;\n\n    collection.models = [];\n    collection._byId  = {};\n\n    freeAll( collection, models );\n    return models;\n}\n\nexport function freeAll( collection : CollectionCore, children : Record[] ) : Record[] {\n    for( let child of children ){\n        free( collection, child );\n    }\n\n    return children;\n}\n\n// Silently sort collection, if its required. Returns true if sort happened.  \nexport function sortElements( collection : CollectionCore, options : CollectionOptions ) : boolean {\n    let { _comparator } = collection;\n    if( _comparator && options.sort !== false ){\n        collection.models.sort( ( a, b ) => _comparator.call( collection, a, b ) )\n        return true;\n    }\n\n    return false;\n}\n\n/**********************************\n * Collection Index \n */\n\n// Index data structure\nexport interface IdIndex {\n    [ id : string ] : Record\n}\n\n// Add record\nexport function addIndex( index : IdIndex, model : Record ) : void {\n    index[ model.cid ] = model;\n    var id             = model.id;\n    \n    if( id != null ){\n        index[ id ] = model;\n    }\n}\n\n// Remove record\nexport function removeIndex( index : IdIndex, model : Record ) : void {\n    delete index[ model.cid ];\n    var id = model.id;\n    if( id != null ){\n        delete index[ id ];\n    }\n}\n\n// convert argument to model. Return false if fails.\nexport function toModel( collection : CollectionCore, attrs, options ){\n    const { model } = collection;\n    return attrs instanceof model ? attrs : model.create( attrs, options, collection );\n}\n\nexport function convertAndAquire( collection : CollectionCore, attrs, options ){\n    const { model } = collection,\n    \t  record = attrs instanceof model ? attrs : model.create( attrs, options, collection );\n\n    aquire( collection, record );\n    return record;\n}\n\n/***\n * In Collections, transactions appears only when\n * add remove or change events might be emitted.\n * reset doesn't require transaction.\n * \n * Transaction holds information regarding events, and knows how to emit them.\n * \n * Two major optimization cases.\n * 1) Population of an empty collection\n * 2) Update of the collection (no or little changes) - it's crucial to reject empty transactions.\n * 3) \n */\n\n\n// Transaction class. Implements two-phase transactions on object's tree. \nexport class CollectionTransaction implements Transaction {\n    // open transaction\n    constructor(    public object : CollectionCore,\n                    public isRoot : boolean,\n                    public added : Record[],\n                    public removed : Record[],\n                    public nested : Transaction[],\n                    public sorted : boolean ){\n        markAsDirty( object );\n    }\n\n    // commit transaction\n    commit( options : TransactionOptions = {}, isNested? : boolean ){\n        const { nested, object } = this;\n\n        // Commit all nested transactions...\n        for( let transaction of nested ){\n            transaction.commit( options, true );\n        }\n\n        // Notify listeners on attribute changes...\n        if( !options.silent ){\n            const { added, removed } = this;\n\n            for( let record of added ){\n                trigger3( object, 'add', record, object, options );\n            }\n\n            for( let record of removed ){\n                trigger3( object, 'remove', record, object, options );\n            }\n\n            for( let transaction of nested ){\n                trigger2( object, 'change', transaction.object, options );\n            }\n\n            if( this.sorted ){\n                trigger2( object, 'sort', object, options );\n            }\n\n            if( added.length || removed.length ){\n                trigger2( object, 'update', object, options );\n            }\n        }\n\n        this.isRoot && commit( object, options, isNested );\n    }\n}\n\n\n/** WEBPACK FOOTER **\n ** ./src/collection/commons.ts\n **/","import { Transaction, begin, commit, aquire, free } from '../transactions.ts'\nimport { CollectionTransaction, sortElements, CollectionOptions, toModel, addIndex, CollectionCore } from './commons.ts'\nimport { Record } from '../record/index.ts'\n\ninterface AddOptions extends CollectionOptions {\n    at? : number \n}\n\nexport function addTransaction( collection : CollectionCore, items, options : AddOptions ){\n    const isRoot = begin( collection ),\n          nested = [];\n\n    var added = appendElements( collection, items, nested, options );\n\n    if( added.length || nested.length ){\n        let needSort = sortOrMoveElements( collection, added, options );\n        return new CollectionTransaction( collection, isRoot, added, [], nested, needSort );\n    }\n\n    // No changes...\n    isRoot && commit( collection, options );\n};\n\n// Handle sort or insert at options for add operation. Reurns true if sort happened. \nfunction sortOrMoveElements( collection : CollectionCore, added : Record[], options : AddOptions ) : boolean {\n    let at = options.at;\n    if( at != null ){\n        // if at is given, it overrides sorting option...\n        const { length } = collection.models;\n        at = +at;\n        if( at < 0 ) at += length + 1;\n        if( at < 0 ) at = 0;\n        if( at > length ) at = length;\n\n        moveElements( collection.models, at, added );\n        return false;\n    }\n\n    return sortElements( collection, options );\n}\n\nfunction moveElements( source : any[], at : number, added : any[] ) : void {\n    for( var j = source.length - 1, i = j - added.length; i >= at; i--, j-- ){\n        source[ j ] = source[ i ];\n    }\n\n    for( i = 0, j = at; i < added.length; i++, j++ ){\n        source[ j ] = added[ i ];\n    }\n}\n\n// append data to model and index\nfunction appendElements( collection : CollectionCore, a_items, nested : Transaction[], a_options ){\n    var models      = collection.models,\n        _byId       = collection._byId,\n        merge       = a_options.merge,\n        parse       = a_options.parse,\n        idAttribute = collection.model.prototype.idAttribute,\n        prevLength = models.length;\n\n    for( const item of a_items.length ){\n        let model = item ? _byId[ item[ idAttribute ] ] || _byId[ item.cid ] : null;\n\n        if( model ){\n            if( merge && item !== model ){\n                var attrs = item.attributes || item;\n                const transaction = model._createTransaction( attrs, a_options );\n                transaction && nested.push( transaction );\n            }\n        }\n        else{\n            model = toModel( collection, item, a_options );\n\n            models.push( model );\n            aquire( collection, model );\n            addIndex( _byId, model );\n        }\n    }\n\n    return models.slice( prevLength );\n}\n\n\n\n/** WEBPACK FOOTER **\n ** ./src/collection/add.ts\n **/","import { Transaction, begin, commit, aquire, free } from '../transactions.ts'\nimport { CollectionTransaction, IdIndex, sortElements, CollectionOptions, toModel, addIndex, CollectionCore, Elements, freeAll } from './commons.ts'\nimport { Record } from '../record/index.ts'\n\n/*******\n * \n */\n\nexport function emptySetTransaction( collection : CollectionCore, items : Elements, options : CollectionOptions, silent? : boolean ){\n    const isRoot = begin( collection );\n\n    const added = _reallocateEmpty( collection, items, options );\n\n    if( added.length ){\n        const needSort = sortElements( collection, options );\n        return new CollectionTransaction( collection, isRoot, added, [], [], needSort );\n    }\n\n    // No changes...\n    isRoot && commit( collection, options );\n};\n\nexport function setTransaction( collection, items, options ){\n    const isRoot = begin( collection ),\n          nested = [];\n\n    var previous = collection.models,\n        added    = _reallocate( collection, items, nested, options );\n\n    const reusedCount = collection.models.length - added.length,\n          removed = reusedCount < previous.length ? (\n                        reusedCount ? _garbageCollect( collection, previous ) :\n                                        freeAll( collection, previous )\n                    ) : [];                    \n    \n    const addedOrChanged = nested.length || added.length,\n          needSort = addedOrChanged && sortElements( collection, options );\n\n    if( addedOrChanged || removed.length ){\n        return new CollectionTransaction( collection, isRoot, added, removed, nested, needSort );\n    }\n\n    isRoot && commit( collection, options );\n};\n\n// Remove references to all previous elements, which are not present in collection.\n// Returns an array with removed elements.\nfunction _garbageCollect( collection : CollectionCore, previous : Record[] ) : Record[]{\n    const { _byId }  = collection,\n          removed = [];\n\n    // Filter out removed models and remove them from the index...\n    for( let record of previous ){\n        if( !_byId[ record.cid ] ){\n            removed.push( record );\n            free( collection, record );\n        }\n    }\n\n    return removed;\n}\n\n// reallocate model and index\nfunction _reallocate( collection : CollectionCore, source, nested : Transaction[], options ){\n    var models      = Array( source.length ),\n        _byId : IdIndex = {},\n        merge       = options.merge == null ? true : options.merge,\n        _prevById   = collection._byId,\n        idAttribute = collection.model.prototype.idAttribute,\n        toAdd       = [];\n\n    // for each item in source set...\n    for( var i = 0, j = 0; i < source.length; i++ ){\n        var item  = source[ i ],\n            model : Record = null;\n\n        if( item ){\n            var id  = item[ idAttribute ],\n                cid = item.cid;\n\n            if( _byId[ id ] || _byId[ cid ] ) continue;\n\n            model = _prevById[ id ] || _prevById[ cid ];\n        }\n\n        if( model ){\n            if( merge && item !== model ){\n                var attrs = item.attributes || item;\n                const transaction = model._createTransaction( attrs, options );\n                transaction && nested.push( transaction );\n            }\n        }\n        else{\n            model = toModel( collection, item, options );\n            aquire( collection, model );\n            toAdd.push( model );\n        }\n\n        models[ j++ ] = model;\n        addIndex( _byId, model );\n    }\n\n    models.length = j;\n    collection.models   = models;\n    collection._byId    = _byId;\n\n    return toAdd;\n}\n\nfunction _reallocateEmpty( self, source, options ){\n    var len         = source ? source.length : 0,\n        models      = Array( len ),\n        _byId : IdIndex = {},\n        idAttribute = self.model.prototype.idAttribute;\n\n    for( var i = 0, j = 0; i < len; i++ ){\n        var src = source[ i ];\n\n        if( src && ( _byId[ src[ idAttribute ] ] || _byId[ src.cid ] ) ){\n            continue;\n        }\n\n        var model = toModel( self, src, options );\n\n        aquire( self, model );\n        models[ j++ ] = model;\n        addIndex( _byId, model );\n\n    }\n\n    models.length = j;\n    self._byId    = _byId;\n\n    return self.models = models;\n}\n\n\n/** WEBPACK FOOTER **\n ** ./src/collection/set.ts\n **/","/*************\n * Remove items from collections.\n * \n * Cannot be a part of two-phase transaction on object tree.\n * Can be executed in the scope of ad-hoc transaction or from the trigger, though.\n *\n * Implemented with low-level API. \n * Most frequent operation - single element remove. Thus, it have the fast-path.\n */\n\nimport { Record } from '../record/index.ts'\nimport { CollectionCore, CollectionTransaction, removeIndex } from './commons.ts'\nimport { trigger2, trigger3 } from '../objectplus/index.ts'\nimport { free, TransactionOptions, markAsDirty, begin, commit } from '../transactions.ts' \n\nexport function removeOne( collection : CollectionCore, el : Record | {} | string, options : TransactionOptions ) : Record {\n    var model : Record = collection.get( el );\n\n    if( model ){\n        const isRoot = begin( collection ),\n              models = collection.models,\n              silent = options.silent;\n\n        // Remove model form the collection. \n        models.splice( models.indexOf( model ), 1 );\n        removeIndex( collection._byId, model );\n        \n        // Mark transaction as dirty. \n        markAsDirty( collection );\n\n        // Send out events.\n        silent || trigger3( model, 'remove', model, collection, options );\n\n        free( collection, model );\n\n        silent || trigger2( collection, 'update', collection, options );\n\n        // Commit transaction.\n        isRoot && commit( collection, options );\n\n        return model;\n    }\n};\n\n/** Optimized for removing many elements\n * 1. Remove elements from the index, checking for duplicates\n * 2. Create new models array matching index\n * 3. Send notifications and remove references\n */\nexport function removeMany( collection : CollectionCore, toRemove : any[], options ){\n    const removed = _removeFromIndex( collection, toRemove );\n    if( removed.length ){\n        const isRoot = begin( collection );\n\n        _reallocate( collection, removed.length );\n\n        const transaction = new CollectionTransaction( collection, isRoot, null, removed, null, false );\n        transaction.commit( options );\n\n        return removed;\n    }\n};\n\n// remove models from the index...\nfunction _removeFromIndex( collection, toRemove ){\n    var removed = Array( toRemove.length ),\n        _byId   = collection._byId;\n\n    for( var i = 0, j = 0; i < toRemove.length; i++ ){\n        var model = collection.get( toRemove[ i ] );\n        if( model ){\n            removed[ j++ ] = model;\n            removeIndex( _byId, model );\n            free( collection, model );\n        }\n    }\n\n    removed.length = j;\n\n    return removed;\n}\n\n// Allocate new models array removing models not present in the index.\nfunction _reallocate( collection, removed ){\n    var prev   = collection.models,\n        models = collection.models = Array( prev.length - removed ),\n        _byId = collection._byId;\n\n    for( var i = 0, j = 0; i < prev.length; i++ ){\n        var model = prev[ i ];\n\n        if( _byId[ model.cid ] ){\n            models[ j++ ] = model;\n        }\n    }\n\n    models.length = j;\n}\n\n\n/** WEBPACK FOOTER **\n ** ./src/collection/remove.ts\n **/"],"sourceRoot":""}