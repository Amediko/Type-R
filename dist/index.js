!function(t,e){"object"==typeof exports&&"undefined"!=typeof module?e(exports):"function"==typeof define&&define.amd?define(["exports"],e):e(t.Nested={})}(this,function(t){"use strict";function e(t){if(null===t)return!0;switch(typeof t){case"number":case"string":case"boolean":return!0;case"object":var n=Object.getPrototypeOf(t);if(n===Object.prototype||n===Array.prototype)return a(t,e)}return!1}function n(t){return Object.getPrototypeOf(t.prototype).constructor}function r(t){if(t)for(var e in t)if(t.hasOwnProperty(e))return!1;return!0}function o(t,e){for(var n,r=0;r<t.length;r++)if(n=e(t[r],r))return n}function i(t,e){var n;for(var r in t)if(t.hasOwnProperty(r)&&(n=e(t[r],r)))return n}function s(t,e){return Object.getPrototypeOf(t)===Wt?o(t,e):i(t,e)}function a(t,e){return!s(t,function(t){return!e(t)})}function u(t){for(var e={},n={},r=1;r<arguments.length;r++)n[arguments[r]]=!0;for(var o in t)!n.hasOwnProperty(o)&&t.hasOwnProperty(o)&&(e[o]=t[o]);return e}function c(t,e,n){for(var r in e)if(e.hasOwnProperty(r)){var o=n(e[r],r);void 0===o||(t[r]=o)}return t}function p(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n]);if(arguments.length>2)for(var r=2;r<arguments.length;r++){var o=arguments[r];o&&p(t,o)}return t}function f(t,e){for(var n in e)e.hasOwnProperty(n)&&!t.hasOwnProperty(n)&&(t[n]=e[n]);if(arguments.length>2)for(var r=2;r<arguments.length;r++){var o=arguments[r];o&&f(t,o)}return t}function l(t){var e,n=!0;return function(){return n&&(n=!1,e=t.apply(this,arguments),t=null),e}}function h(t,e){if(t===e)return!1;if(t&&e&&"object"==typeof t&&"object"==typeof e){var n=Object.getPrototypeOf(t);if(n!==Object.getPrototypeOf(e))return!0;switch(n){case Kt:return+t!=+e;case Wt:return v(t,e);case Lt:case null:return d(t,e)}}return!0}function d(t,e){var n=Object.keys(t);if(n.length!==Object.keys(e).length)return!0;for(var r=0;r<n.length;r++){var o=n[r];if(!e.hasOwnProperty(o)||h(t[o],e[o]))return!0}return!1}function v(t,e){if(t.length!==e.length)return!0;for(var n=0;n<t.length;n++)if(h(t[n],e[n]))return!0;return!1}function y(t){var e=n(t);t.__super__=e.prototype,t.define||Xt.get(Qt).populate(t),Xt.get(t),t.onExtend&&t.onExtend(e)}function g(t){if("function"!=typeof t)return function(e){y(e),e.define(t)};y(t),t.define()}function _(t){return function(e){var n=Xt.get(e);n.definitionRules=f(t,n.definitionRules)}}function b(t,e){return function(n,r){Xt.get(n.constructor).mergeObject(n,(o={},o[t]=(i={},i[r]=e,i),o));var o,i}}function m(t,e){for(var n=Yt[typeof t],r=0,o=Object.getOwnPropertyNames(t);r<o.length;r++){var i=o[r];i in n||e(i)}}function w(t,e,n,r,o){if(t.hasOwnProperty(e)){var i=Object.getOwnPropertyDescriptor(t,e);i.configurable&&"value"in i&&(t[e]=o?O(n.value,i.value,r):O(i.value,n.value,r))}else Object.defineProperty(t,e,n)}function O(t,e,n){return void 0===t?e:n&&void 0!==e?n(t,e):t}function j(t){return oe[t]||(oe[t]=function(e,n,r,o,i){void 0===o&&void 0===i||I(this,t,e,n,r,o,i),void 0!==r?J(this,t,e,n,r):k(this,t,e,n)})}function C(t,e,n,r){for(var o,i,s=t[e],a=s;a;a=a.next)n&&n!==a.callback&&n!==a.callback._callback||r&&r!==a.context?(i=a,o||(o=a)):i&&(i.next=a.next);s!==o&&(t[e]=o)}function P(t,e,n){for(var r=t;r;r=r.next)r.callback.call(r.context,e,n)}function A(t,e,n,r){for(var o=t;o;o=o.next)o.callback.call(o.context,e,n,r)}function E(t,e,n,r,o){for(var i=t;i;i=i.next)i.callback.call(i.context,e,n,r,o)}function x(t,e,n,r,o,i){for(var s=t;s;s=s.next)s.callback.call(s.context,e,n,r,o,i)}function S(t,e,n,r,o,i,s){for(var a=t;a;a=a.next)a.callback.call(a.context,e,n,r,o,i,s)}function N(t,e,n,r){if(n){var o=t._events||(t._events=Object.create(null));o[e]=new ie(n,r,o[e])}}function D(t,e,n,r){if(n){var o=l(function(){R(t,e,o),n.apply(this,arguments)});o._callback=n,N(t,e,o,r)}}function R(t,e,n,r){var o=t._events;if(o)if(n||r)if(e)C(o,e,n,r);else for(var i in o)C(o,i,n,r);else e?o[e]=void 0:t._events=void 0}function T(t,e,n,r,o){if(se.test(n))for(var i=0,s=n.split(se);i<s.length;i++)t(e,s[i],r,o);else t(e,n,r,o)}function k(t,e,n,r){var o=t._events;if(o){var i=o[e],s=o.all;P(i,n,r),A(s,e,n,r)}}function J(t,e,n,r,o){var i=t._events;if(i){var s=i[e],a=i.all;A(s,n,r,o),E(a,e,n,r,o)}}function I(t,e,n,r,o,i,s){var a=t._events;if(a){var u=a[e],c=a.all;x(u,n,r,o,i,s),S(c,e,n,r,o,i,s)}}function M(){return"l"+ye++}function V(t){if(t)return"function"==typeof t?{get:t}:t}function H(t,e){(t._listeningTo||(t._listeningTo=Object.create(null)))[e.cid||(e.cid=M())]=e}function F(t,e,n){for(var r=e.match(we),o=r.length-1,i=t,s=0;s<o;s++){var a=r[s];switch(a){case"~":i=i.getStore();break;case"^":i=i.getOwner();break;default:i=i.get(a)}if(!i)return}return n(i,r[o])}function U(t,e,n){var r=z(t),o={};t._attributes[e].doUpdate(n,t,o)&&(q(t,o),Re(t,"change:"+e,t,t.attributes[e],o)),r&&De(t)}function z(t){return!!Se(t)&&(t._previousAttributes=new t.AttributesCopy(t.attributes),t._changedAttributes=null,!0)}function q(t,e){return t._changedAttributes&&(t._changedAttributes=null),Ne(t,e)}function B(t){var e=Object.keys(t),n=new Function("values","\n        "+e.map(function(t){return"\n            this."+t+" = values."+t+";\n        "}).join("")+"\n    ");n.prototype=Object.prototype;var r=new Function("record","values","options","\n        var _attrs = record._attributes;\n\n        "+e.map(function(t){return"\n            this."+t+" = _attrs."+t+".doInit( values."+t+", record, options );\n        "}).join("")+"\n    ");return r.prototype=Object.prototype,{Attributes:r,AttributesCopy:n}}function W(t,e){return!(!e||e.constructor!==Object)||(t._log("warn","update with non-object is ignored!",{values:e}),!1)}function K(t,e){return function(n,r){return e.call(this,t.call(this,n,r),r)}}function L(t,e){return function(n,r,o,i){return e.call(this,t.call(this,n,r,o,i),r,o,i)}}function Z(t,e){return function(n,r,o,i){t.call(this,n,r,o,i),e.call(this,n,r,o,i)}}function G(t){return function(e,n,r){return n?t.call(this,e,n,r):"Required"}}function $(){}function Q(t){var e;if("function"==typeof t)e=t.has;else if(t&&t instanceof Be)e=t;else{var n=X(t);e=n&&n.prototype instanceof Ee?n.shared.value(t):new Be({type:n,value:t,hasCustomDefault:!0})}return e.options}function X(t){switch(typeof t){case"number":return Number;case"string":return String;case"boolean":return Boolean;case"undefined":return;case"object":return t?t.constructor:void 0}}function Y(t){return!isNaN(new Date(t).getTime())}function tt(t){var e,n,r=0;if(n=Qe.exec(t)){for(var o,i=0;o=$e[i];++i)n[o]=+n[o]||0;n[2]=(+n[2]||1)-1,n[3]=+n[3]||1,"Z"!==n[8]&&void 0!==n[9]&&(r=60*n[10]+n[11],"+"===n[9]&&(r=0-r)),e=Date.UTC(n[1],n[2],n[3],n[4],n[5]+r,n[6],n[7])}else e=Date.parse(t);return e}function et(t){return t?Math.round(t):0}function nt(){}function rt(){}function ot(t,e){return Ve.create(Q(t),e)}function it(t){var e=Object.keys(t).filter(function(e){return t[e].parse});return e.length?{_parse:new Function("json","\n            var _attrs = this._attributes;\n\n            "+e.map(function(t){return"                \n                json."+t+" === void 0 || ( json."+t+" = _attrs."+t+".parse.call( this, json."+t+', "'+t+'" ) );\n            '}).join("")+"\n\n            return json;\n        ")}:{}}function st(t){return new Function("\n        var json = {},\n            v = this.attributes,\n            a = this._attributes;\n\n        "+Object.keys(t).map(function(e){if(t[e].toJSON)return"json."+e+" = a."+e+".toJSON.call( this, v."+e+", '"+e+"' );"}).join("\n")+"\n\n        return json;\n    ")}function at(t,e){t.hasOwnProperty("shared")||Object.defineProperty(t,"shared",{get:function(){return new Be({value:null,type:t,_attribute:e})}})}function ut(t){var e;for(var n in t){var r=t[n].options._onChange;r&&(e||(e=new ne),e.addEvent("change:"+n,"string"==typeof r?pt(r,n):ct(r,n)))}return e?{_localEvents:e}:{}}function ct(t,e){return function(n,r){t.call(n,r,e)}}function pt(t,e){var n=new Oe(t,!0),r=n.local,o=n.resolve,i=n.tail;return r?function(t,n){t[i](n,e)}:function(t,n){o(t)[i](n,e)}}function ft(t,e){if(W(t,e)){var n=t._attributes,r=void 0;for(var o in e)n[o]||(r||(r=[]),r.push("'"+o+"'"));r&&t._log("warn","undefined attributes "+r.join(", ")+" are ignored.",{values:e})}}function lt(t){var e=t.defaults,n=t.attributes,r=t.idAttribute,o=n||e||{};return!r||r in o||(o[r]=void 0),o}function ht(t){var e=t.models;return t.models=[],t._byId={},yt(t,e),e}function dt(t,e,n){var r,o=t.model;t._shared?(r=e instanceof o?e:o.create(e,n),t._shared&be.listen&&Tn(r,r._changeEventName,t._onChildrenChange,t)):(r=e instanceof o?n.merge?e.clone():e:o.create(e,n),In(t,r)||(t._aggregationError||(t._aggregationError=[])).push(r));var i=t._itemEvents;return i&&i.subscribe(t,r),r}function vt(t,e,n){t._shared?t._shared&be.listen&&kn(e,e._changeEventName,t._onChildrenChange,t):(Mn(t,e),n||e.dispose());var r=t._itemEvents;r&&r.unsubscribe(t,e)}function yt(t,e){for(var n=0,r=e;n<r.length;n++)vt(t,r[n]);return e}function gt(t,e){var n=t._comparator;return!(!n||!1===e.sort)&&(t.models.sort(n),!0)}function _t(t,e){t[e.cid]=e;var n=e.id;null!=n&&(t[n]=e)}function bt(t,e){delete t[e.cid];var n=e.id;null!=n&&delete t[n]}function mt(t,e){delete t[e.previous(e.idAttribute)];var n=e.id;null==n||(t[n]=e)}function wt(t){t._log("error","added records already have an owner",t._aggregationError),t._aggregationError=void 0}function Ot(t,e,n,r){var o=Hn(t),i=[],s=Pt(t,e,i,n,r);if(s.length||i.length){var a=jt(t,s,n);if(Un(t,n))return new Vn(t,o,s,[],i,a);t._aggregationError&&wt(t)}o&&Fn(t)}function jt(t,e,n){var r=n.at;if(null!=r){var o=t.models.length-e.length;return(r=Number(r))<0&&(r+=o+1),r<0&&(r=0),r>o&&(r=o),Ct(t.models,r,e),!1}return gt(t,n)}function Ct(t,e,n){for(var r=t.length-1,o=r-n.length;o>=e;o--,r--)t[r]=t[o];for(o=0,r=e;o<n.length;o++,r++)t[r]=n[o]}function Pt(t,e,n,r,o){for(var i=t._byId,s=t.models,a=(o||r.merge)&&!t._shared,u=(r.parse,t.model.prototype.idAttribute),c=s.length,p=0,f=e;p<f.length;p++){var l=f[p],h=l?i[l[u]]||i[l.cid]:null;if(h){if(a&&l!==h){var d=l.attributes||l,v=h._createTransaction(d,r);v&&n.push(v),h.hasChanged(u)&&mt(i,h)}}else h=dt(t,l,r),s.push(h),_t(i,h)}return s.slice(c)}function At(t,e,n,r){var o=zn(t),i=Nt(t,e,n);if(i.length){var s=gt(t,n);if(Bn(t,r?Wn:n))return new Vn(t,o,i.slice(),[],[],s);t._aggregationError&&wt(t)}o&&qn(t)}function Et(t,e,n){var r=zn(t),o=[],i=t.models,s=St(t,e,o,n),a=t.models.length-s.length,u=a<i.length?a?xt(t,i):yt(t,i):[],c=o.length||s.length,p=gt(t,n)&&c||s.length||n.sorted;if(c||u.length||p){if(Bn(t,n))return new Vn(t,r,s,u,o,p);t._aggregationError&&wt(t)}r&&qn(t)}function xt(t,e){for(var n=t._byId,r=[],o=0,i=e;o<i.length;o++){var s=i[o];n[s.cid]||(r.push(s),vt(t,s))}return r}function St(t,e,n,r){for(var o=Array(e.length),i={},s=(null==r.merge||r.merge)&&!t._shared,a=t._byId,u=t.models,c=t.model.prototype.idAttribute,p=[],f=!0,l=0,h=0;l<e.length;l++){var d=e[l],v=null;if(d){var y=d[c],g=d.cid;if(i[y]||i[g])continue;v=a[y]||a[g]}if(v){if(s&&d!==v){f&&u[h]!==v&&(f=!1);var _=d.attributes||d,b=v._createTransaction(_,r);b&&n.push(b)}}else v=dt(t,d,r),p.push(v);o[h++]=v,_t(i,v)}return o.length=h,t.models=o,t._byId=i,f||(r.sorted=!0),p}function Nt(t,e,n){for(var r=e?e.length:0,o=Array(r),i={},s=t.model.prototype.idAttribute,a=0,u=0;a<r;a++){var c=e[a];if(!c||!i[c[s]]&&!i[c.cid]){var p=dt(t,c,n);o[u++]=p,_t(i,p)}}return o.length=u,t._byId=i,t.models=o}function Dt(t,e,n){var r=t.get(e);if(r){var o=Gn(t),i=t.models;i.splice(i.indexOf(r),1),bt(t._byId,r);var s=Zn(t,n);return s&&(Ln(r,"remove",r,t,n),Ln(t,"remove",r,t,n)),vt(t,r,n.unset),s&&Kn(t,"update",t,n),o&&$n(t),r}}function Rt(t,e,n){var r=Tt(t,e);if(r.length){var o=Gn(t);kt(t,r.length),Zn(t,n)?new Vn(t,o,[],r,[],!1).commit():o&&$n(t)}return r}function Tt(t,e){for(var n=Array(e.length),r=t._byId,o=0,i=0;o<e.length;o++){var s=t.get(e[o]);s&&(n[i++]=s,bt(r,s),vt(t,s))}return n.length=i,n}function kt(t,e){for(var n=t.models,r=t.models=Array(n.length-e),o=t._byId,i=0,s=0;i<n.length;i++){var a=n[i];o[a.cid]&&(r[s++]=a)}r.length=s}function Jt(t,e,n){var r=n.parse?t.parse(e,n):e;return Array.isArray(r)?r:[r]}function It(t,e){return void 0!==e?function(n,r){return t.call(e,n,r)}:t}function Mt(t,e){return"object"==typeof t?function(e){for(var n in t)if(t[n]!==e[n])return!1;return!0}:It(t,e)}function Vt(t){switch(typeof t){case"function":return function(e){return t.call(e)};case"object":return function(){return t};case"string":return new Oe(t).resolve}}function Ht(t){return function(t){function e(e,n){var r=t.call(this,[],n,dr)||this;return r.resolvedWith=null,r.refs=zt(e),r}return lr(e,t),Object.defineProperty(e.prototype,"__inner_state__",{get:function(){return this.refs||this.models},enumerable:!0,configurable:!0}),e.prototype.add=function(e,n){var r=this.resolvedWith,o=zt(e);if(r)return t.prototype.add.call(this,Ft(r,o),n);if(o.length){var i=xe.begin(this);this.refs=this.refs?this.refs.concat(o):o,xe.markAsDirty(this,n),i&&xe.commit(this)}},e.prototype.reset=function(e,n){var r=this.resolvedWith,o=zt(e);return r?t.prototype.reset.call(this,Ft(r,o),n):Ut(this,o,n)||[]},e.prototype._createTransaction=function(e,n){var r=this.resolvedWith,o=zt(e);return r?t.prototype._createTransaction.call(this,Ft(r,o),n):Ut(this,o,n)},e.prototype.toJSON=function(){return this.refs?this.refs.map(function(t){return t.id||t}):this.models.map(function(t){return t.id})},e.prototype._validateNested=function(){return 0},e.prototype.clone=function(t){var e=new(0,this.constructor)([],{model:this.model,comparator:this.comparator});return this.resolvedWith?(e.resolvedWith=this.resolvedWith,e.reset(this.models,{silent:!0})):e.refs=this.refs,e},e.prototype.parse=function(t){return t},e.prototype.resolve=function(t){return t&&t.length&&(this.resolvedWith=t,this.refs&&(this.reset(this.refs,{silent:!0}),this.refs=null)),this},e.prototype.getModelIds=function(){return this.toJSON()},e.prototype.toggle=function(e,n){return t.prototype.toggle.call(this,this.resolvedWith.get(e),n)},e.prototype.addAll=function(){if(this.resolvedWith)return this.set(this.resolvedWith.models),this.models;throw new Error("Cannot add elemens because the subset collection is not resolved yet.")},e.prototype.toggleAll=function(){return this.length?this.reset():this.addAll()},e=hr([g],e)}(t)}function Ft(t,e){for(var n=[],r=0,o=e;r<o.length;r++){var i=o[r],s=t.get(i);s&&n.push(s)}return n}function Ut(t,e,n){if(h(t.refs,e)){var r=xe.begin(t);t.refs=e,xe.markAsDirty(t,n),r&&xe.commit(t)}}function zt(t){return Array.isArray(t)?t:[t]}var qt={none:0,error:1,warn:2,info:3,log:4,debug:5},Bt=function(t,e,n){var r,o,i,s=qt[t];if(void 0!==s||n?(r=e,i=t,o=n):(s=4,r=t,o=e,i="log"),s<=Bt.level){if(s<=Bt.throw||!Bt.logger){var a=new Error(r);throw a.props=o,a}Bt.logger(i,r,o),Bt.stop}};Bt.level="undefined"!=typeof process&&process.env&&"production"===process.env.NODE_ENV?1:2,Bt.throw=0,Bt.stop=0,"undefined"!=typeof console&&(Bt.logger=function(t,e,n){var r=[e];for(var o in n)r.push("\n\t"+o+":",n[o]);console[t].apply(console,r)}),Object.setPrototypeOf||(Object.setPrototypeOf=f);var Wt=Array.prototype,Kt=Date.prototype,Lt=Object.prototype,Zt=Object.freeze({log:Bt,isValidJSON:e,getBaseClass:n,assignToClassProto:function(t,e){for(var n=[],r=2;r<arguments.length;r++)n[r-2]=arguments[r];for(var o=0,i=n;o<i.length;o++){var s=i[o],a=e[s];void 0===a||(t.prototype[s]=a)}},isEmpty:r,some:s,every:a,getPropertyDescriptor:function(t,e){for(var n,r=t;!n&&r;r=Object.getPrototypeOf(r))n=Object.getOwnPropertyDescriptor(r,e);return n},omit:u,transform:c,fastAssign:function(t,e){for(var n in e)t[n]=e[n];return t},fastDefaults:function(t,e){for(var n in e)void 0===t[n]&&(t[n]=e[n]);return t},assign:p,defaults:f,keys:function(t){return t?Object.keys(t):[]},once:l,notEqual:h}),Gt=window&&window.__extends||function(){var t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])};return function(e,n){function r(){this.constructor=e}t(e,n),e.prototype=null===n?Object.create(n):(r.prototype=n.prototype,new r)}}(),$t=window&&window.__rest||function(t,e){var n={};for(var r in t)Object.prototype.hasOwnProperty.call(t,r)&&e.indexOf(r)<0&&(n[r]=t[r]);if(null!=t&&"function"==typeof Object.getOwnPropertySymbols)for(var o=0,r=Object.getOwnPropertySymbols(t);o<r.length;o++)e.indexOf(r[o])<0&&(n[r[o]]=t[r[o]]);return n},Qt=function(){function t(){}return t.define=function(t,e){void 0===t&&(t={});var r=n(this);e&&p(this,e);var o=t.mixins,i=$t(t,["mixins"]);return o&&this.mixins.merge(o),this.mixins.mergeObject(this.prototype,i,!0),this.mixins.mergeObject(this.prototype,this.mixins.getStaticDefinitions(r),!0),this.onDefine&&this.onDefine(this.mixins.definitions,r),this.mixins.mergeInheritedMembers(r),this},t.extend=function(t,e){var n;return t&&t.hasOwnProperty("constructor")?(n=t.constructor,Gt(n,this)):n=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return Gt(e,t),e}(this),y(n),t&&n.define(t,e),n},t}(),Xt=function(){function t(t){this.Class=t,this.definitions={};var e=n(t).mixins;this.mergeRules=e&&e.mergeRules||{},this.definitionRules=e&&e.definitionRules||{},this.appliedMixins=e&&e.appliedMixins||[]}return t.get=function(e){var n=e.mixins;return n&&e===n.Class?n:e.mixins=new t(e)},t.prototype.getStaticDefinitions=function(t){var e=this.Class;return c({},this.definitionRules,function(n,r){if(t[r]!==e[r])return e[r]})},t.prototype.merge=function(t){for(var e=this.Class.prototype,r=this.appliedMixins=this.appliedMixins.slice(),o=0,i=t;o<i.length;o++){var s=i[o];if(Array.isArray(s))this.merge(s);else if(r.indexOf(s)<0)if(r.push(s),"function"==typeof s){n(s)!==Object&&console.log("Mixin error"),this.mergeObject(this.Class,s);var a=s.mixins;a&&(this.mergeRules=f({},this.mergeRules,a.mergeRules),this.definitionRules=f({},this.definitionRules,a.definitionRules),this.appliedMixins=this.appliedMixins.concat(a.appliedMixins)),this.mergeObject(e,s.prototype)}else this.mergeObject(e,s)}},t.prototype.populate=function(){for(var e=[],n=0;n<arguments.length;n++)e[n]=arguments[n];for(var r=0,o=e;r<o.length;r++)t.get(o[r]).merge([this.Class])},t.prototype.mergeObject=function(t,e,n){var r=this;m(e,function(o){var i,s=Object.getOwnPropertyDescriptor(e,o);(i=r.definitionRules[o])&&w(r.definitions,o,s,i,n),i&&i!==ee.protoValue||w(t,o,s,r.mergeRules[o],n)})},t.prototype.mergeInheritedMembers=function(t){var e=this,n=e.mergeRules,r=e.Class;if(n){var o=r.prototype,i=t.prototype;for(var s in n){var a=n[s];o.hasOwnProperty(s)&&s in i&&(o[s]=O(o[s],i[s],a))}}},t}(),Yt={function:{length:!0,prototype:!0,caller:!0,arguments:!0,name:!0,__super__:!0},object:{constructor:!0}},te=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];return function(e){return Xt.get(e).merge(t)}},ee=function(t){return function(e){var n=Xt.get(e);n.mergeRules=f(t,n.mergeRules)}};ee.value=function(t,e){return t},ee.protoValue=function(t,e){return t},ee.merge=function(t,e){return f({},t,e)},ee.pipe=function(t,e){return function(n){return t.call(this,e.call(this,n))}},ee.defaults=function(t,e){return function(){return f(t.apply(this,arguments),e.apply(this,arguments))}},ee.classFirst=function(t,e){return function(){t.apply(this,arguments),e.apply(this,arguments)}},ee.classLast=function(t,e){return function(){e.apply(this,arguments),t.apply(this,arguments)}},ee.every=function(t,e){return function(){return t.apply(this,arguments)&&e.apply(this,arguments)}},ee.some=function(t,e){return function(){return t.apply(this,arguments)||e.apply(this,arguments)}};var ne=function(){function t(e){this.handlers=[],e&&(e instanceof t?this.handlers=e.handlers.slice():e&&this.addEventsMap(e))}return t.prototype.merge=function(t){this.handlers=this.handlers.concat(t.handlers)},t.prototype.addEventsMap=function(t){for(var e in t)this.addEvent(e,t[e])},t.prototype.bubbleEvents=function(t){for(var e=0,n=t.split(se);e<n.length;e++){var r=n[e];this.addEvent(r,j(r))}},t.prototype.addEvent=function(t,e){for(var n=this.handlers,r=0,o=t.split(se);r<o.length;r++){var i=o[r];n.push(new re(i,e))}},t.prototype.subscribe=function(t,e){for(var n=0,r=this.handlers;n<r.length;n++){var o=r[n];N(e,o.name,o.callback,t)}},t.prototype.unsubscribe=function(t,e){for(var n=0,r=this.handlers;n<r.length;n++){var o=r[n];R(e,o.name,o.callback,t)}},t}(),re=function(){return function(t,e){this.name=t,this.callback=!0===e?j(t):"string"==typeof e?function(){var t=this[e];t&&t.apply(this,arguments)}:e}}(),oe={},ie=function(){return function(t,e,n){void 0===n&&(n=null),this.callback=t,this.context=e,this.next=n}}(),se=/\s+/,ae=Object.freeze({EventMap:ne,EventDescriptor:re,EventHandler:ie,on:N,once:D,off:R,strings:T,trigger2:k,trigger3:J,trigger5:I}),ue=window&&window.__decorate||function(t,e,n,r){var o,i=arguments.length,s=i<3?e:null===r?r=Object.getOwnPropertyDescriptor(e,n):r;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)s=Reflect.decorate(t,e,n,r);else for(var a=t.length-1;a>=0;a--)(o=t[a])&&(s=(i<3?o(s):i>3?o(e,n,s):o(e,n))||s);return i>3&&s&&Object.defineProperty(e,n,s),s},ce=T,pe=N,fe=R,le=D,he=I,de=k,ve=J,ye=0,ge=function(){function t(){this._events=void 0,this._listeningTo=void 0,this.cid=M(),this.initialize.apply(this,arguments)}return t.onDefine=function(t,e){var n=t.localEvents,r=t._localEvents,o=t.properties;if(n||r){var i=new ne(this.prototype._localEvents);n&&i.addEventsMap(n),r&&i.merge(r),this.prototype._localEvents=i}o&&Object.defineProperties(this.prototype,c({},o,V))},t.prototype.initialize=function(){},t.prototype.on=function(t,e,n){if("string"==typeof t)ce(pe,this,t,e,n);else for(var r in t)ce(pe,this,r,t[r],n||e);return this},t.prototype.once=function(t,e,n){if("string"==typeof t)ce(le,this,t,e,n);else for(var r in t)ce(le,this,r,t[r],n||e);return this},t.prototype.off=function(t,e,n){if(t)if("string"==typeof t)ce(fe,this,t,e,n);else for(var r in t)ce(fe,this,r,t[r],n||e);else fe(this,void 0,e,n);return this},t.prototype.trigger=function(t,e,n,r,o,i){return void 0!==o||void 0!==i?he(this,t,e,n,r,o,i):void 0!==r?ve(this,t,e,n,r):de(this,t,e,n),this},t.prototype.listenTo=function(t,e,n){return t&&(H(this,t),t.on(e,n||"object"!=typeof e?n:this,this)),this},t.prototype.listenToOnce=function(t,e,n){return t&&(H(this,t),t.once(e,n||"object"!=typeof e?n:this,this)),this},t.prototype.stopListening=function(t,e,n){var r=this._listeningTo;if(r){var o=!(e||n),i=n||"object"!=typeof e?n:this;if(t){var s=r[t.cid];s&&(o&&delete r[t.cid],s.off(e,i,this))}else if(null==t){for(var a in r)r[a].off(e,i,this);o&&(this._listeningTo=void 0)}}return this},t.prototype.dispose=function(){this._disposed||(this.stopListening(),this.off(),this._disposed=!0)},t=ue([g,_({properties:ee.merge,localEvents:ee.merge})],t)}(),_e=u(ge.prototype,"constructor","initialize");Object.extend=function(t,e){return Qt.extend(t,e)},Object.assign||(Object.assign=p),Object.log=Bt;var be,me=function(){function t(t){this.length=t._validateNested(this.nested={}),(this.error=t.validate(t))&&this.length++}return t.prototype.each=function(t){var e=this,n=e.error,r=e.nested;n&&t(n,null);for(var o in r)t(r[o],o)},t.prototype.eachError=function(e,n){this.each(function(r,o){r instanceof t?r.eachError(e,n.get(o)):e(r,o,n)})},t}(),we=/\^|([^.]+)/g,Oe=function(){return function(t,e){void 0===e&&(e=!1);var n=t.match(we).map(function(t){return"^"===t?"getOwner()":"~"===t[0]?'getStore().get("'+t.substr(1)+'")':t});this.tail=e&&n.pop(),this.local=!n.length,n.unshift("self"),this.resolve=new Function("self","return "+n.join(".")+";")}}(),je=window&&window.__decorate||function(t,e,n,r){var o,i=arguments.length,s=i<3?e:null===r?r=Object.getOwnPropertyDescriptor(e,n):r;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)s=Reflect.decorate(t,e,n,r);else for(var a=t.length-1;a>=0;a--)(o=t[a])&&(s=(i<3?o(s):i>3?o(e,n,s):o(e,n))||s);return i>3&&s&&Object.defineProperty(e,n,s),s},Ce=J,Pe=N,Ae=R;!function(t){t[t.share=1]="share",t[t.listen=2]="listen",t[t.persistent=4]="persistent"}(be||(be={}));var Ee=function(){function t(t){this._events=void 0,this._changeToken={},this._transaction=!1,this._isDirty=null,this._owner=void 0,this._ownerKey=void 0,this._validationError=void 0,this.cid=this.cidPrefix+t}return e=t,t.onExtend=function(t){t.create===this.create&&(this.create=e.create)},t.create=function(t,e){return new this(t,e)},t.prototype.dispose=function(){this._disposed||(this._owner=void 0,this._ownerKey=void 0,this.off(),this.stopListening(),this._disposed=!0)},t.prototype.initialize=function(){},t.prototype.onChanges=function(t,e){Pe(this,this._changeEventName,t,e)},t.prototype.offChanges=function(t,e){Ae(this,this._changeEventName,t,e)},t.prototype.listenToChanges=function(t,e){this.listenTo(t,t._changeEventName,e)},t.prototype.transaction=function(t,e){void 0===e&&(e={});var n=xe.begin(this),r=t.call(this,this);r&&this.set(r),n&&xe.commit(this)},t.prototype.updateEach=function(t,e){var n=xe.begin(this);this.each(t),n&&xe.commit(this)},t.prototype.set=function(t,e){if(t){var n=this._createTransaction(t,e);n&&n.commit()}return this},t.prototype.assignFrom=function(t){return this.set(t.__inner_state__||t,{merge:!0})},t.prototype.parse=function(t,e){return t},t.prototype.deepGet=function(t){return F(this,t,function(t,e){return t.get?t.get(e):t[e]})},t.prototype.getOwner=function(){return this._owner},t.prototype.getStore=function(){var t=this._owner;return t?t.getStore():this._defaultStore},t.prototype.map=function(t,e){var n=[],r=void 0!==e?function(n,r){return t.call(e,n,r)}:t;return this.each(function(t,e){var o=r(t,e);void 0!==o&&n.push(o)}),n},t.prototype.mapObject=function(t,e){var n={};return this.each(function(e,r){var o=t(e,r);void 0!==o&&(n[r]=o)}),n},Object.defineProperty(t.prototype,"validationError",{get:function(){var t=this._validationError||(this._validationError=new me(this));return t.length?t:null},enumerable:!0,configurable:!0}),t.prototype.validate=function(t){},t.prototype.getValidationError=function(t){var e=this.validationError;return(t?e&&e.nested[t]:e)||null},t.prototype.deepValidationError=function(t){return F(this,t,function(t,e){return t.getValidationError(e)})},t.prototype.eachValidationError=function(t){var e=this.validationError;e&&e.eachError(t,this)},t.prototype.isValid=function(t){return!this.getValidationError(t)},t.prototype.valueOf=function(){return this.cid},t.prototype.toString=function(){return this.cid},t.prototype.getClassName=function(){var t=this.constructor.name;if("Subclass"!==t)return t},t=e=je([g,te(ge)],t);var e}(),xe={begin:function(t){return!t._transaction&&(t._transaction=!0)},markAsDirty:function(t,e){var n=!e.silent;return n&&(t._isDirty=e),t._changeToken={},t._validationError=void 0,n},commit:function(t,e){var n=t._isDirty;if(n){for(;t._isDirty;){var r=t._isDirty;t._isDirty=null,Ce(t,t._changeEventName,t,r,e)}t._transaction=!1;var o=t._owner;o&&o!==e&&o._onChildrenChange(t,n)}else t._isDirty=null,t._transaction=!1},aquire:function(t,e,n){return e._owner?e._owner===t:(e._owner=t,e._ownerKey=n,!0)},free:function(t,e){t===e._owner&&(e._owner=void 0,e._ownerKey=void 0)}},Se=xe.begin,Ne=xe.markAsDirty,De=xe.commit,Re=J,Te={transaction:function(t,e){void 0===e&&(e={});var n=z(this);t.call(this,this),n&&De(this)},_onChildrenChange:function(t,e){var n=t._ownerKey,r=this._attributes[n];r&&!r.propagateChanges||this.forceAttributeChange(n,e)},forceAttributeChange:function(t,e){void 0===e&&(e={});var n=z(this);q(this,e)&&Re(this,"change:"+t,this,this.attributes[t],e),n&&De(this)},_createTransaction:function(t,e){void 0===e&&(e={});var n,r=z(this),o=[],i=[],s=this._attributes,a=e.parse?this.parse(t,e):t;if(W(this,a))for(var u in a){var c=s[u];c?c.doUpdate(a[u],this,e,i)&&o.push(u):(n||(n=[]),n.push("'"+u+"'"))}if(o.length&&q(this,e))return new ke(this,r,i,o);for(var p=0,f=i;p<f.length;p++)f[p].commit(this);r&&De(this)}},ke=function(){function t(t,e,n,r){this.object=t,this.isRoot=e,this.nested=n,this.changes=r}return t.prototype.commit=function(t){for(var e=this,n=e.nested,r=e.object,o=e.changes,i=0,s=n;i<s.length;i++)s[i].commit(r);for(var a=r.attributes,u=r._isDirty,c=0,p=o;c<p.length;c++){var f=p[c];Re(r,"change:"+f,r,a[f],u)}this.isRoot&&De(r,t)},t}(),Je=h,Ie=p,Me={},Ve=function(){function t(t,n){this.name=t,this.getHook=null,this.options=n;var r=Ie({getHooks:[],transforms:[],changeHandlers:[]},n);r.getHooks=r.getHooks.slice(),r.transforms=r.transforms.slice(),r.changeHandlers=r.changeHandlers.slice();var o=r.value,i=r.type,s=r.parse,a=r.toJSON,u=r.changeEvents,c=r.validate,p=r.getHooks,f=r.transforms,l=r.changeHandlers;if(this.value=o,this.type=i,!r.hasCustomDefault&&i?this.defaultValue=this.create:e(o)?this.defaultValue=new Function("return "+JSON.stringify(o)+";"):this.defaultValue=this.defaultValue,this.propagateChanges=!1!==u,this.toJSON=void 0===a?this.toJSON:a,this.validate=c||this.validate,r.isRequired&&(this.validate=G(this.validate)),f.unshift(this.convert),this.parse=s||this.parse,this.get&&p.unshift(this.get),this.initialize.call(this,r),p.length){var h=this.getHook=p.reduce(K),d=this.validate;this.validate=function(t,e,n){return d.call(this,t,h.call(t,e,n),n)}}this.transform=f.length?f.reduce(L):this.transform,this.handleChange=l.length?l.reduce(Z):this.handleChange}return t.create=function(e,n){var r=e.type;return new(e._attribute||(r?r._attribute:t))(n,e)},t.prototype.canBeUpdated=function(t,e,n){},t.prototype.transform=function(t,e,n,r){return t},t.prototype.convert=function(t,e,n,r){return t},t.prototype.isChanged=function(t,e){return Je(t,e)},t.prototype.handleChange=function(t,e,n,r){},t.prototype.create=function(){},t.prototype.clone=function(t,e){return t},t.prototype.dispose=function(t,e){this.handleChange(void 0,e,t,Me)},t.prototype.validate=function(t,e,n){},t.prototype.toJSON=function(t,e){return t&&t.toJSON?t.toJSON():t},t.prototype.createPropertyDescriptor=function(){var t=this,e=t.name,n=t.getHook;if("id"!==e)return{set:function(t){U(this,e,t)},get:n?function(){return n.call(this,this.attributes[e],e)}:function(){return this.attributes[e]}}},t.prototype.initialize=function(t,e){},t.prototype.doInit=function(t,e,n){var r=void 0===t?this.defaultValue():t,o=this.transform(r,void 0,e,n);return this.handleChange(o,void 0,e,n),o},t.prototype.doUpdate=function(t,e,n,r){var o=this.name,i=e.attributes,s=i[o],a=this.transform(t,s,e,n);return i[o]=a,!!this.isChanged(a,s)&&(this.handleChange(a,s,e,n),!0)},t.prototype._log=function(t,e,n,r){Bt(t,"[Attribute Update Error] "+r.getClassName()+"."+this.name+": "+e,{Record:r,"Attribute definition":this,"Prev. value":r.attributes[this.name],"New value":n})},t.prototype.defaultValue=function(){return this.value},t}(),He=window&&window.__extends||function(){var t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])};return function(e,n){function r(){this.constructor=e}t(e,n),e.prototype=null===n?Object.create(n):(r.prototype=n.prototype,new r)}}(),Fe=xe.free,Ue=xe.aquire,ze=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return He(e,t),e.prototype.clone=function(t){return t?t.clone():t},e.prototype.toJSON=function(t){return t&&t.toJSON()},e.prototype.doInit=function(t,e,n){var r=n.clone?this.clone(t):void 0===t?this.defaultValue():t,o=this.transform(r,void 0,e,n);return this.handleChange(o,void 0,e,n),o},e.prototype.doUpdate=function(t,e,n,r){var o,i=this.name,s=e.attributes,a=s[i];if(o=this.canBeUpdated(a,t,n)){var u=a._createTransaction(o,n);return!(!u||(r?r.push(u):u.commit(e),!this.propagateChanges))}var c=this.transform(t,a,e,n);return s[i]=c,!!this.isChanged(c,a)&&(this.handleChange(c,a,e,n),!0)},e.prototype.canBeUpdated=function(t,e,n){if(t&&null!=e){if(!(e instanceof this.type))return e;if(n.merge)return e.__inner_state__}},e.prototype.convert=function(t,e,n,r){return null==t?t:t instanceof this.type?(!t._shared||t._shared&be.persistent||this._log("error","aggregated collection attribute is assigned with shared collection",t,n),r.merge?t.clone():t):this.type.create(t,r)},e.prototype.dispose=function(t,e){e&&this.handleChange(void 0,e,t,{})},e.prototype.validate=function(t,e){var n=e&&e.validationError;if(n)return n},e.prototype.create=function(){return this.type.create()},e.prototype.initialize=function(t){t.changeHandlers.unshift(this._handleChange)},e.prototype._handleChange=function(t,e,n){e&&(Fe(n,e),e.dispose()),t&&!Ue(n,t,this.name)&&this._log("error","aggregated attribute assigned with object already having an owner",t,n)},e}(Ve),qe=p,Be=function(){function t(t){this.options={getHooks:[],transforms:[],changeHandlers:[]},t&&qe(this.options,t)}return t.prototype.check=function(t,e){function n(n,r,o){if(!t.call(n,r,o)){var i=e||t.error||o+" is not valid";return"function"==typeof i?i.call(n,o):i}}var r=this.options.validate;return this.metadata({validate:r?function(t,e,o){return r(t,e,o)||n(t,e,o)}:n})},Object.defineProperty(t.prototype,"asProp",{get:function(){return b("attributes",this)},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"isRequired",{get:function(){return this.metadata({isRequired:!0})},enumerable:!0,configurable:!0}),t.prototype.watcher=function(t){return this.metadata({_onChange:t})},t.prototype.parse=function(t){return this.metadata({parse:t})},t.prototype.toJSON=function(t){return this.metadata({toJSON:"function"==typeof t?t:t?function(t){return t&&t.toJSON()}:$})},t.prototype.get=function(t){return this.metadata({getHooks:this.options.getHooks.concat(t)})},t.prototype.set=function(t){return this.metadata({transforms:this.options.transforms.concat(function(e,n,r,o){if(this.isChanged(e,n)){var i=t.call(r,e,this.name);return void 0===i?n:this.convert(i,n,r,o)}return n})})},t.prototype.changeEvents=function(t){return this.metadata({changeEvents:t})},t.prototype.events=function(t){var e=new ne(t);return this.metadata({changeHandlers:this.options.changeHandlers.concat(function(t,n,r){n&&n.trigger&&e.unsubscribe(r,n),t&&t.trigger&&e.subscribe(r,t)})})},Object.defineProperty(t.prototype,"has",{get:function(){return this},enumerable:!0,configurable:!0}),t.prototype.metadata=function(e){var n=new t(this.options);return qe(n.options,e),n},t.prototype.value=function(t){return this.metadata({value:t,hasCustomDefault:!0})},t}();Function.prototype.value=function(t){return new Be({type:this,value:t,hasCustomDefault:!0})},Object.defineProperty(Function.prototype,"isRequired",{get:function(){return this._isRequired||this.has.isRequired},set:function(t){this._isRequired=t}}),Object.defineProperty(Function.prototype,"asProp",{get:function(){return this.has.asProp}}),Object.defineProperty(Function.prototype,"has",{get:function(){return this._has||new Be({type:this,value:this._attribute.defaultValue,hasCustomDefault:void 0!==this._attribute.defaultValue})},set:function(t){this._has=t}});var We=window&&window.__extends||function(){var t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])};return function(e,n){function r(){this.constructor=e}t(e,n),e.prototype=null===n?Object.create(n):(r.prototype=n.prototype,new r)}}(),Ke=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return We(e,t),e.prototype.create=function(){return new Date},e.prototype.convert=function(t,e,n){if(null==t||t instanceof Date)return t;var r=new Date(t),o=r.getTime();return o!==o&&this._log("warn","assigned with Invalid Date",t,n),r},e.prototype.validate=function(t,e,n){if(null!=e){var r=e.getTime();if(r!==r)return n+" is Invalid Date"}},e.prototype.toJSON=function(t){return t&&t.toISOString()},e.prototype.isChanged=function(t,e){return(t&&t.getTime())!==(e&&e.getTime())},e.prototype.doInit=function(t,e,n){return this.transform(void 0===t?this.defaultValue():t,void 0,e,n)},e.prototype.doUpdate=function(t,e,n,r){var o=this.name,i=e.attributes,s=i[o];return this.isChanged(s,i[o]=this.transform(t,s,e,n))},e.prototype.clone=function(t){return t&&new Date(t.getTime())},e.prototype.dispose=function(){},e}(Ve);Date._attribute=Ke;var Le=/\/Date\(([0-9]+)\)\//,Ze=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return We(e,t),e.prototype.convert=function(t){if("string"==typeof t){var e=Le.exec(t);if(e)return new Date(Number(e[1]))}return Ke.prototype.convert.apply(this,arguments)},e.prototype.toJSON=function(t){return t&&"/Date("+t.getTime()+")/"},e}(Ke),Ge=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return We(e,t),e.prototype.toJSON=function(t){return t&&t.getTime()},e}(Ke);Object.defineProperties(Date,{microsoft:{get:function(){return new Be({type:Date,_attribute:Ze})}},timestamp:{get:function(){return new Be({type:Date,_attribute:Ge})}}}),Y("2011-11-29T15:52:30.5")&&Y("2011-11-29T15:52:30.52")&&Y("2011-11-29T15:52:18.867")&&Y("2011-11-29T15:52:18.867Z")&&Y("2011-11-29T15:52:18.867-03:30")||(Ke.prototype.convert=function(t){return null==t||t instanceof Date?t:new Date(tt(t))});var $e=[1,4,5,6,7,10,11],Qe=/^(\d{4}|[+\-]\d{6})(?:-(\d{2})(?:-(\d{2}))?)?(?:T(\d{2}):(\d{2})(?::(\d{2})(?:\.(\d{3}))?)?(?:(Z)|([+\-])(\d{2})(?::(\d{2}))?)?)?$/,Xe=window&&window.__extends||function(){var t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])};return function(e,n){function r(){this.constructor=e}t(e,n),e.prototype=null===n?Object.create(n):(r.prototype=n.prototype,new r)}}(),Ye=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return Xe(e,t),e.prototype.create=function(){return new this.type},e.prototype.convert=function(t){return null==t||t instanceof this.type?t:new this.type(t)},e.prototype.toJSON=function(t){return t&&t.toJSON?t.toJSON():t},e.prototype.clone=function(t){return new this.type(this.toJSON(t))},e.prototype.isChanged=function(t,e){return t!==e},e}(Ve);Function.prototype._attribute=Ye;var tn=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return Xe(e,t),e.prototype.dispose=function(){},e.prototype.create=function(){return this.type()},e.prototype.toJSON=function(t){return t},e.prototype.convert=function(t){return null==t?t:this.type(t)},e.prototype.isChanged=function(t,e){return t!==e},e.prototype.clone=function(t){return t},e.prototype.doInit=function(t,e,n){return this.transform(void 0===t?this.value:t,void 0,e,n)},e.prototype.doUpdate=function(t,e,n,r){var o=this.name,i=e.attributes,s=i[o];return s!==(i[o]=this.transform(t,s,e,n))},e.prototype.initialize=function(){this.options.hasCustomDefault||(this.value=this.type())},e}(Ve);Boolean._attribute=String._attribute=tn;var en=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return Xe(e,t),e.prototype.create=function(){return 0},e.prototype.convert=function(t,e,n){var r=null==t?t:this.type(t);return r!==r&&this._log("warn","assigned with Invalid Number",t,n),r},e.prototype.validate=function(t,e,n){if(null!=e&&!isFinite(e))return n+" is not valid number"},e}(tn);Number._attribute=en,et._attribute=en,Number.integer=et,"undefined"!=typeof window&&(window.Integer=Number.integer);var nn=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return Xe(e,t),e.prototype.toJSON=function(t){return t},e.prototype.dispose=function(){},e.prototype.create=function(){return[]},e.prototype.convert=function(t,e,n){return null==t||Array.isArray(t)?t:(this._log("warn","assignment of non-array to Array attribute is ignored",t,n),[])},e.prototype.clone=function(t){return t&&t.slice()},e}(Ve);Array._attribute=nn;var rn=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return Xe(e,t),e.prototype.create=function(){return{}},e.prototype.convert=function(t,e,n){return null==t||"object"==typeof t?t:(this._log("warn","assignment of non-object to Object attribute is ignored",t,n),{})},e}(Ve);Object._attribute=rn;var on=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return Xe(e,t),e.prototype.toJSON=function(t){},e.prototype.create=function(){return nt},e.prototype.convert=function(t,e,n){return null==t||"function"==typeof t?t:(this._log("warn","assigned with non-function",t,n),nt)},e.prototype.clone=function(t){return t},e}(Ve);Function._attribute=on;var sn=window&&window.__extends||function(){var t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])};return function(e,n){function r(){this.constructor=e}t(e,n),e.prototype=null===n?Object.create(n):(r.prototype=n.prototype,new r)}}(),an=N,un=R,cn=xe.free,pn=xe.aquire,fn=be.listen|be.share,ln=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return sn(e,t),e.prototype.doInit=function(t,e,n){var r=n.clone?this.clone(t,e):void 0===t?this.defaultValue():t,o=this.transform(r,void 0,e,n);return this.handleChange(o,void 0,e,n),o},e.prototype.doUpdate=function(t,e,n,r){var o,i=this.name,s=e.attributes,a=s[i];if(o=this.canBeUpdated(a,t,n)){var u=a._createTransaction(o,n);return!(!u||(r?r.push(u):u.commit(e),!this.propagateChanges))}var c=this.transform(t,a,e,n);return s[i]=c,!!this.isChanged(c,a)&&(this.handleChange(c,a,e,n),!0)},e.prototype.clone=function(t,e){if(!t||t._owner!==e)return t;var n=t.clone();return pn(e,n,this.name),n},e.prototype.toJSON=function(){},e.prototype.canBeUpdated=function(t,e,n){if(t&&null!=e&&!(e instanceof this.type))return e},e.prototype.convert=function(t,e,n,r){if(null==t||t instanceof this.type)return t;var o=new this.type(t,r,fn);return pn(n,o,this.name),o},e.prototype.validate=function(t,e,n){},e.prototype.create=function(){return null},e.prototype._handleChange=function(t,e,n){e&&(e._owner===n?(cn(n,e),e.dispose()):un(e,e._changeEventName,this._onChange,n)),t&&t._owner!==n&&an(t,t._changeEventName,this._onChange,n)},e.prototype.dispose=function(t,e){e&&this.handleChange(void 0,e,t,{})},e.prototype.initialize=function(t){var e=this;this._onChange=this.propagateChanges?function(t,n,r){this===r||this.forceAttributeChange(e.name,n)}:rt,t.changeHandlers.unshift(this._handleChange)},e}(Ve),hn=window&&window.__assign||Object.assign||function(t){for(var e,n=1,r=arguments.length;n<r;n++){e=arguments[n];for(var o in e)Object.prototype.hasOwnProperty.call(e,o)&&(t[o]=e[o])}return t},dn=function(t,e){var n=c({},t,ot),r=f({},n,e),o=B(r);return hn({},o,{_attributes:new o.AttributesCopy(r),_attributesArray:Object.keys(r).map(function(t){return r[t]}),properties:c({},n,function(t){return t.createPropertyDescriptor()}),_toJSON:st(r)},it(r),ut(n))},vn=window&&window.__extends||function(){var t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])};return function(e,n){function r(){this.constructor=e}t(e,n),e.prototype=null===n?Object.create(n):(r.prototype=n.prototype,new r)}}(),yn=window&&window.__assign||Object.assign||function(t){for(var e,n=1,r=arguments.length;n<r;n++){e=arguments[n];for(var o in e)Object.prototype.hasOwnProperty.call(e,o)&&(t[o]=e[o])}return t},gn=window&&window.__decorate||function(t,e,n,r){var o,i=arguments.length,s=i<3?e:null===r?r=Object.getOwnPropertyDescriptor(e,n):r;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)s=Reflect.decorate(t,e,n,r);else for(var a=t.length-1;a>=0;a--)(o=t[a])&&(s=(i<3?o(s):i>3?o(e,n,s):o(e,n))||s);return i>3&&s&&Object.defineProperty(e,n,s),s},_n=p,bn=r,mn=Bt,wn=0,On=function(t){function e(e,n){var r=t.call(this,wn++)||this;r.attributes={};var o=n||{},i=(o.parse?r.parse(e,o):e)||{};return mn.level>1&&ft(r,i),r.attributes=r._previousAttributes=new r.Attributes(r,i,o),r.initialize(e,n),r._localEvents&&r._localEvents.subscribe(r,r),r}return vn(e,t),e,e.onDefine=function(t,e){},e.defaults=function(t){return this.extend({attributes:t})},e.prototype.previousAttributes=function(){return new this.AttributesCopy(this._previousAttributes)},Object.defineProperty(e.prototype,"__inner_state__",{get:function(){return this.attributes},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"changed",{get:function(){var t=this._changedAttributes;if(!t){var e=this._previousAttributes;t={};for(var n=this,r=(n._attributes,n.attributes),o=0,i=this._attributesArray;o<i.length;o++){var s=i[o],a=s.name,u=r[a];s.isChanged(u,e[a])&&(t[a]=u)}this._changedAttributes=t}return t},enumerable:!0,configurable:!0}),e.prototype.changedAttributes=function(t){if(!t)return!!this.hasChanged()&&_n({},this.changed);var e,n=!1,r=this._transaction?this._previousAttributes:this.attributes,o=this._attributes;for(var i in t)o[i].isChanged(r[i],e=t[i])&&((n||(n={}))[i]=e);return n},e.prototype.hasChanged=function(t){var e=this._previousAttributes;return!!e&&(t?this._attributes[t].isChanged(this.attributes[t],e[t]):!bn(this.changed))},e.prototype.previous=function(t){if(t){var e=this._previousAttributes;if(e)return e[t]}return null},e.prototype.isNew=function(){return null==this.id},e.prototype.has=function(t){return void 0!=this[t]},e.prototype.unset=function(t,e){var n=this[t];return this.set((r={},r[t]=void 0,r),e),n;var r},e.prototype.clear=function(t){var e=this,n=t&&t.nullify;return this.transaction(function(){e.forEachAttr(e.attributes,function(t,r){return e[r]=n?null:void 0})},t),this},e.prototype.getOwner=function(){var t=this._owner;return this._ownerKey?t:t&&t._owner},Object.defineProperty(e.prototype,"id",{get:function(){return this.attributes[this.idAttribute]},set:function(t){U(this,this.idAttribute,t)},enumerable:!0,configurable:!0}),e.prototype.forEachAttr=function(t,e){var n,r=this._attributes;for(var o in t){var i=r[o];i?e(t[o],o,i):(n||(n=[]),n.push("'"+o+"'"))}n&&this._log("warn","attributes "+n.join(", ")+" are not defined",{attributes:t})},e.prototype.each=function(t,e){var n=void 0!==e?function(n,r){return t.call(e,n,r)}:t,r=this.attributes;for(var o in this.attributes){var i=r[o];void 0!==i&&n(i,o)}},e.prototype.keys=function(){var t=[];return this.each(function(e,n){return void 0===e||t.push(n)}),t},e.prototype.values=function(){return this.map(function(t){return t})},e.prototype._toJSON=function(){return{}},e.prototype._parse=function(t){return t},e.prototype.defaults=function(t){var e={},n=this._attributes;for(var r in n){var o=t[r];e[r]=void 0===o?n[r].defaultValue():o}return e},e.prototype.initialize=function(t,e){},e.prototype.clone=function(t){void 0===t&&(t={});var e=new this.constructor(this.attributes,{clone:!0});return t.pinStore&&(e._defaultStore=this.getStore()),e},e.prototype.deepClone=function(){return this.clone()},e.prototype._validateNested=function(t){var e=this,n=0;return this.forEachAttr(this.attributes,function(r,o,i){var s=i.validate(e,r,o);s&&(t[o]=s,n++)}),n},e.prototype.get=function(t){return this[t]},e.prototype.toJSON=function(){var t=this,e={};return this.forEachAttr(this.attributes,function(n,r,o){var i=o.toJSON;if(void 0!==n){var s=i.call(t,n,r);void 0!==s&&(e[r]=s)}}),e},e.prototype.parse=function(t,e){return this._parse(t)},e.prototype.deepSet=function(t,e,n){var r=this;return this.transaction(function(){for(var o=t.split("."),i=o.length-1,s=o[i],a=r,u=0;u<i;u++){var c=o[u],p=a.get?a.get(c):a[c];if(!p){var f=a._attributes;if(!f)return;var l=f[c].create();n&&n.nullify&&l._attributes&&l.clear(n),a[c]=p=l}a=p}a.set?a.set((h={},h[s]=e,h),n):a[s]=e;var h}),this},Object.defineProperty(e.prototype,"collection",{get:function(){return this._ownerKey?null:this._owner},enumerable:!0,configurable:!0}),e.prototype.dispose=function(){var e=this;this._disposed||(this.forEachAttr(this.attributes,function(t,n,r){r.dispose(e,t)}),t.prototype.dispose.call(this))},e.prototype._log=function(t,e,n){Bt(t,"[Record] "+e,yn({Record:this,"Attributes definition:":this._attributes},n))},e.prototype.getClassName=function(){return t.prototype.getClassName.call(this)||"Record"},e.prototype._createTransaction=function(t,e){},e=gn([g({cidPrefix:"m",_changeEventName:"change",idAttribute:"id"}),_({defaults:ee.merge,attributes:ee.merge,collection:ee.merge,Collection:ee.value,idAttribute:ee.protoValue})],e)}(Ee);_n(On.prototype,Te);var jn=function(){return function(t,e,n){this.id=e.id}}();On.prototype.Attributes=jn;var Cn=function(){return function(t){this.id=t.id}}();On.prototype.AttributesCopy=Cn;var Pn=Ve.create({value:void 0},"id");On.prototype._attributes={id:Pn},On.prototype._attributesArray=[Pn],On.prototype.defaults=function(t){return void 0===t&&(t={}),{id:t.id}},On._attribute=ze;var An=window&&window.__extends||function(){var t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])};return function(e,n){function r(){this.constructor=e}t(e,n),e.prototype=null===n?Object.create(n):(r.prototype=n.prototype,new r)}}(),En=window&&window.__decorate||function(t,e,n,r){var o,i=arguments.length,s=i<3?e:null===r?r=Object.getOwnPropertyDescriptor(e,n):r;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)s=Reflect.decorate(t,e,n,r);else for(var a=t.length-1;a>=0;a--)(o=t[a])&&(s=(i<3?o(s):i>3?o(e,n,s):o(e,n))||s);return i>3&&s&&Object.defineProperty(e,n,s),s},xn=window&&window.__rest||function(t,e){var n={};for(var r in t)Object.prototype.hasOwnProperty.call(t,r)&&e.indexOf(r)<0&&(n[r]=t[r]);if(null!=t&&"function"==typeof Object.getOwnPropertySymbols)for(var o=0,r=Object.getOwnPropertySymbols(t);o<r.length;o++)e.indexOf(r[o])<0&&(n[r[o]]=t[r[o]]);return n},Sn=p,Nn=f;On.onExtend=function(t){Ee.onExtend.call(this,t);var e=this,n=function(t){function n(){return null!==t&&t.apply(this,arguments)||this}return An(n,t),n.model=e,n=En([y],n)}(t.Collection);this.DefaultCollection=n,e.Collection===t.Collection&&(this.Collection=n),at(this,ln)},On.onDefine=function(t,e){var n=e.prototype,r=dn(this.attributes=lt(t),n._attributes),o=r.properties,i=r._localEvents,s=xn(r,["properties","_localEvents"]);Sn(this.prototype,s),t.properties=Nn(t.properties||{},o),t._localEvents=i,Ee.onDefine.call(this,t,e),this.DefaultCollection.define(t.collection||{}),this.Collection=t.Collection,this.Collection.prototype.model=this},On._attribute=ze,at(On,ln);var Dn=k,Rn=J,Tn=N,kn=R,Jn=xe.commit,In=xe.aquire,Mn=xe.free,Vn=function(){function t(t,e,n,r,o,i){this.object=t,this.isRoot=e,this.added=n,this.removed=r,this.nested=o,this.sorted=i}return t.prototype.commit=function(t){for(var e=this,n=e.nested,r=e.object,o=r._isDirty,i=0,s=n;i<s.length;i++)(c=s[i]).commit(r);r._aggregationError&&wt(r);for(var a=0,u=n;a<u.length;a++){var c=u[a];Dn(r,"change",c.object,o)}for(var p=this,f=p.added,l=p.removed,h=0,d=f;h<d.length;h++){g=d[h];Rn(g,"add",g,r,o),Rn(r,"add",g,r,o)}for(var v=0,y=l;v<y.length;v++){var g=y[v];Rn(g,"remove",g,r,o),Rn(r,"remove",g,r,o)}this.sorted&&Dn(r,"sort",r,o),(f.length||l.length)&&Dn(r,"update",r,o),this.isRoot&&Jn(r,t)},t}(),Hn=xe.begin,Fn=xe.commit,Un=xe.markAsDirty,zn=xe.begin,qn=xe.commit,Bn=xe.markAsDirty,Wn={silent:!0},Kn=k,Ln=J,Zn=xe.markAsDirty,Gn=xe.begin,$n=xe.commit,Qn=window&&window.__extends||function(){var t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])};return function(e,n){function r(){this.constructor=e}t(e,n),e.prototype=null===n?Object.create(n):(r.prototype=n.prototype,new r)}}(),Xn=window&&window.__assign||Object.assign||function(t){for(var e,n=1,r=arguments.length;n<r;n++){e=arguments[n];for(var o in e)Object.prototype.hasOwnProperty.call(e,o)&&(t[o]=e[o])}return t},Yn=window&&window.__decorate||function(t,e,n,r){var o,i=arguments.length,s=i<3?e:null===r?r=Object.getOwnPropertyDescriptor(e,n):r;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)s=Reflect.decorate(t,e,n,r);else for(var a=t.length-1;a>=0;a--)(o=t[a])&&(s=(i<3?o(s):i>3?o(e,n,s):o(e,n))||s);return i>3&&s&&Object.defineProperty(e,n,s),s},tr=k,er=xe.begin,nr=xe.commit,rr=xe.markAsDirty,or=p,ir=f,sr=0,ar=Array.prototype.slice,ur=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return Qn(e,t),e.defaultValue=[],e}(ln),cr=function(t){function e(e,n,r){void 0===n&&(n={});var o=t.call(this,sr++)||this;return o.models=[],o._byId={},o.comparator=o.comparator,void 0!==n.comparator&&(o.comparator=n.comparator,n.comparator=void 0),o.model=o.model,n.model&&(o.model=n.model,n.model=void 0),o.idAttribute=o.model.prototype.idAttribute,o._shared=r||0,e&&At(o,Jt(o,e,n),n,!0),o.initialize.apply(o,arguments),o._localEvents&&o._localEvents.subscribe(o,o),o}return Qn(e,t),e,e.prototype.createSubset=function(t,e){var n=new(0,this.constructor.subsetOf(this).options.type)(t,e);return n.resolve(this),n},e.onExtend=function(t){function e(t,e,r){n.call(this,t,e,be.share|(r?be.listen:0))}var n=this;this._SubsetOf=null,Qt.mixins.populate(e),e.prototype=this.prototype,e._attribute=ur,this.Refs=this.Subset=e,Ee.onExtend.call(this,t),at(this,ln)},e.onDefine=function(t,e){if(t.itemEvents){var n=new ne(e.prototype._itemEvents);n.addEventsMap(t.itemEvents),this.prototype._itemEvents=n}t.comparator&&(this.prototype.comparator=t.comparator),Ee.onDefine.call(this,t)},Object.defineProperty(e.prototype,"__inner_state__",{get:function(){return this.models},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"comparator",{get:function(){return this._comparator},set:function(t){var e=this;switch(typeof t){case"string":this._comparator=function(e,n){var r=e[t],o=n[t];return r===o?0:r<o?-1:1};break;case"function":1===t.length?this._comparator=function(n,r){var o=t.call(e,n),i=t.call(e,r);return o===i?0:o<i?-1:1}:this._comparator=function(n,r){return t.call(e,n,r)};break;default:this._comparator=null}},enumerable:!0,configurable:!0}),e.prototype.getStore=function(){return this._store||(this._store=this._owner?this._owner.getStore():this._defaultStore)},e.prototype._onChildrenChange=function(t,e,n){if(void 0===e&&(e={}),n!==this){var r=this.idAttribute;t.hasChanged(r)&&mt(this._byId,t);var o=er(this);rr(this,e)&&tr(this,"change",t,e),o&&nr(this)}},e.prototype.get=function(t){if(null!=t){if("object"==typeof t){var e=t[this.idAttribute];return void 0!==e&&this._byId[e]||this._byId[t.cid]}return this._byId[t]}},e.prototype.each=function(t,e){for(var n=It(t,e),r=this.models,o=0;o<r.length;o++)n(r[o],o)},e.prototype.every=function(t,e){for(var n=Mt(t,e),r=this.models,o=0;o<r.length;o++)if(!n(r[o],o))return!1;return!0},e.prototype.filter=function(t,e){var n=Mt(t,e);return this.map(function(t,e){return n(t,e)?t:void 0})},e.prototype.find=function(t,e){for(var n=Mt(t,e),r=this.models,o=0;o<r.length;o++)if(n(r[o],o))return r[o];return null},e.prototype.some=function(t,e){return Boolean(this.find(t,e))},e.prototype.map=function(t,e){for(var n=It(t,e),r=this.models,o=Array(r.length),i=0,s=0;s<r.length;s++){var a=n(r[s],s);void 0===a||(o[i++]=a)}return o.length=i,o},e.prototype._validateNested=function(t){if(this._shared)return 0;var e=0;return this.each(function(n){var r=n.validationError;r&&(t[n.cid]=r,e++)}),e},e.prototype.initialize=function(){},Object.defineProperty(e.prototype,"length",{get:function(){return this.models.length},enumerable:!0,configurable:!0}),e.prototype.first=function(){return this.models[0]},e.prototype.last=function(){return this.models[this.models.length-1]},e.prototype.at=function(t){var e=t<0?t+this.models.length:t;return this.models[e]},e.prototype.clone=function(t){void 0===t&&(t={});var e=this._shared&be.share?this.models:this.map(function(t){return t.clone()}),n=new this.constructor(e,{model:this.model,comparator:this.comparator},this._shared);return t.pinStore&&(n._defaultStore=this.getStore()),n},e.prototype.toJSON=function(){return this.models.map(function(t){return t.toJSON()})},e.prototype.set=function(t,e){if(void 0===t&&(t=[]),void 0===e&&(e={}),void 0!==e.add&&this._log("warn","Collection.set doesn't support 'add' option, behaving as if options.add === true.",e),e.reset)this.reset(t,e);else{var n=this._createTransaction(t,e);n&&n.commit()}return this},e.prototype.dispose=function(){if(!this._disposed){for(var e=!this._shared,n=0,r=this.models;n<r.length;n++){var o=r[n];vt(this,o),e&&o.dispose()}t.prototype.dispose.call(this)}},e.prototype.reset=function(t,e){void 0===e&&(e={});var n=er(this),r=ht(this);return t&&At(this,Jt(this,t,e),e,!0),rr(this,e),e.silent||tr(this,"reset",this,ir({previousModels:r},e)),n&&nr(this),this.models},e.prototype.add=function(t,e){void 0===e&&(e={});var n=Jt(this,t,e),r=this.models.length?Ot(this,n,e):At(this,n,e);if(r)return r.commit(),r.added},e.prototype.remove=function(t,e){return void 0===e&&(e={}),t?Array.isArray(t)?Rt(this,t,e):Dt(this,t,e):[]},e.prototype._createTransaction=function(t,e){void 0===e&&(e={});var n=Jt(this,t,e);return this.models.length?!1===e.remove?Ot(this,n,e,!0):Et(this,n,e):At(this,n,e)},e.prototype.pluck=function(t){return this.models.map(function(e){return e[t]})},e.prototype.sort=function(t){if(void 0===t&&(t={}),gt(this,t)){var e=er(this);rr(this,t)&&tr(this,"sort",this,t),e&&nr(this)}return this},e.prototype.push=function(t,e){return this.add(t,or({at:this.length},e))},e.prototype.pop=function(t){var e=this.at(this.length-1);return this.remove(e,t),e},e.prototype.unset=function(t,e){var n=this.get(t);return this.remove(t,Xn({unset:!0},e)),n},e.prototype.unshift=function(t,e){return this.add(t,or({at:0},e))},e.prototype.shift=function(t){var e=this.at(0);return this.remove(e,t),e},e.prototype.slice=function(){return ar.apply(this.models,arguments)},e.prototype.indexOf=function(t){var e=this.get(t);return this.models.indexOf(e)},e.prototype.modelId=function(t){return t[this.model.prototype.idAttribute]},e.prototype.toggle=function(t,e){var n=Boolean(this.get(t)),r=void 0===e?!n:Boolean(e);return n!==r&&(n?this.remove(t):this.add(t)),r},e.prototype._log=function(t,e,n){Bt(t,"[Collection Update] "+this.model.prototype.getClassName()+"."+this.getClassName()+": "+e,{Argument:n,"Attributes spec":this.model.prototype._attributes})},e.prototype.getClassName=function(){return t.prototype.getClassName.call(this)||"Collection"},e._attribute=ze,e=Yn([g({cidPrefix:"c",model:On,_changeEventName:"changes",_aggregationError:null}),_({comparator:ee.value,model:ee.protoValue,itemEvents:ee.merge})],e)}(Ee);at(cr,ln),On.Collection=cr;var pr=window&&window.__extends||function(){var t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])};return function(e,n){function r(){this.constructor=e}t(e,n),e.prototype=null===n?Object.create(n):(r.prototype=n.prototype,new r)}}(),fr=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return pr(e,t),e.prototype.toJSON=function(t){return t&&"object"==typeof t?t.id:t},e.prototype.clone=function(t){return t&&"object"==typeof t?t.id:t},e.prototype.isChanged=function(t,e){return(t&&(null==t.id?t:t.id))!==(e&&(null==e.id?e:e.id))},e.prototype.validate=function(t,e,n){},e}(Ve);On.from=function(t){var e=Vt(t);return new Be({value:null,_attribute:fr}).get(function(t,n){if("object"==typeof t)return t;var r=e(this),o=null;return r&&r.length&&(o=r.get(t)||null,this.attributes[n]=o,o&&this._attributes[n].handleChange(o,null,this,{})),o})};var lr=window&&window.__extends||function(){var t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])};return function(e,n){function r(){this.constructor=e}t(e,n),e.prototype=null===n?Object.create(n):(r.prototype=n.prototype,new r)}}(),hr=window&&window.__decorate||function(t,e,n,r){var o,i=arguments.length,s=i<3?e:null===r?r=Object.getOwnPropertyDescriptor(e,n):r;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)s=Reflect.decorate(t,e,n,r);else for(var a=t.length-1;a>=0;a--)(o=t[a])&&(s=(i<3?o(s):i>3?o(e,n,s):o(e,n))||s);return i>3&&s&&Object.defineProperty(e,n,s),s};cr.subsetOf=function(t){var e=this._SubsetOf||(this._SubsetOf=Ht(this)),n=Vt(t);return new Be({type:e}).get(function(t){return!t||t.resolvedWith||t.resolve(n(this)),t})};var dr=be.share|be.persistent,vr=window&&window.__extends||function(){var t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])};return function(e,n){function r(){this.constructor=e}t(e,n),e.prototype=null===n?Object.create(n):(r.prototype=n.prototype,new r)}}(),yr=null,gr=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return vr(e,t),e.prototype.getStore=function(){return this},e.prototype.get=function(t){var e=this[t];return e||this===this._defaultStore?e:this._owner?this._owner.get(t):this._defaultStore.get(t)},Object.defineProperty(e,"global",{get:function(){return yr},set:function(t){yr&&yr.dispose(),Ee.prototype._defaultStore=yr=t},enumerable:!0,configurable:!0}),e}(On);gr.global=new gr;var _r,br=window&&window.__extends||function(){var t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])};return function(e,n){function r(){this.constructor=e}t(e,n),e.prototype=null===n?Object.create(n):(r.prototype=n.prototype,new r)}}(),mr=window&&window.__decorate||function(t,e,n,r){var o,i=arguments.length,s=i<3?e:null===r?r=Object.getOwnPropertyDescriptor(e,n):r;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)s=Reflect.decorate(t,e,n,r);else for(var a=t.length-1;a>=0;a--)(o=t[a])&&(s=(i<3?o(s):i>3?o(e,n,s):o(e,n))||s);return i>3&&s&&Object.defineProperty(e,n,s),s},wr=(_r=_e).on,Or=_r.off,jr=_r.trigger,Cr=_r.once,Pr=_r.listenTo,Ar=_r.stopListening,Er=_r.listenToOnce;t.on=wr,t.off=Or,t.trigger=jr,t.once=Cr,t.listenTo=Pr,t.stopListening=Ar,t.listenToOnce=Er,t.Model=On,t.Class=Qt,t.attributes=function(t){return function(e){function n(){return null!==e&&e.apply(this,arguments)||this}return br(n,e),n.attributes=t,n=mr([g],n)}(On)},t.value=function(t){return new Be({value:t})},t.transaction=function(t){return function(){for(var e=this,n=[],r=0;r<arguments.length;r++)n[r]=arguments[r];var o;return this.transaction(function(){o=t.apply(e,n)}),o}},t.tools=Zt,t.eventsApi=ae,t.Mixable=Qt,t.predefine=y,t.define=g,t.definitions=_,t.definitionDecorator=b,t.MixinsState=Xt,t.mixins=te,t.mixinRules=ee,t.EventMap=ne,t.Messenger=ge,t.Events=_e,t.Collection=cr,t.Store=gr,t.Record=On,t.ChainableAttributeSpec=Be,t.attr=function(t,e){if(!e)return t.asProp;"undefined"!=typeof Reflect&&Reflect.getMetadata?Reflect.getMetadata("design:type",t,e).asProp(t,e):t._log("error",'Add import "reflect-metadata"; as the first line of your app.')},t.prop=function(t){return t.asProp},t.createAttribute=ot,t.createSharedTypeSpec=at,t.AnyType=Ve,t.AggregatedType=ze,t.DateType=Ke,t.MSDateType=Ze,t.TimestampType=Ge,t.PrimitiveType=tn,t.NumericType=en,t.ArrayType=nn,t.ObjectType=rn,t.doNothing=nt,t.FunctionType=on,t.SharedType=ln,t.setAttribute=U,t.UpdateRecordMixin=Te,t.constructorsMixin=B,t.shouldBeAnObject=W,t.RecordTransaction=ke,t.toAttributeOptions=Q,Object.defineProperty(t,"__esModule",{value:!0})});
//# sourceMappingURL=index.js.map
